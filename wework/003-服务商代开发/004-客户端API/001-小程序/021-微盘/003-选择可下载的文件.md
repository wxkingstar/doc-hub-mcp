---
title: "选择可下载的文件"
doc_id: 48978
category_id: 99193
source_url: https://developer.work.weixin.qq.com/document/path/48978
---
**接口说明**：调用该接口，可唤起微盘选择器窗口，选择一个或多个**具有下载权限**的文件（只能是微盘文件，**不支持文档**）。选中后返回文件的临时ticket，以操作用户的名义下载该文件。

**调用前提：**
> 必须先调用过wx.qy.login，且session_key未过期，开发者可调用checkSession 检查当前登录态。
>当前成员必须在应用的可见范围之中，否则调用时会报“no permission”错误。
>应用需具有微盘使用权限，否则调用时会报“no permission”错误。

### wx.qy.wedriveSelectFileForDownload(Object object)
#### 参数

##### Object object

| 参数名 | 类型 | 必填 | 说明 | 
| -------- | -------- | ---- | -------------------------------- | 
| selectedFileNum | 是 | number | 选择文件的数量。1表示单选，大于1表示多选，上限为50 |
|success|否|Function|接口调用成功的回调函数|
|fail|否|Function|接口调用失败的回调函数|
|complete|否|Function|接口调用结束的回调函数（调用成功、失败都会执行）|

#### 返回结果

##### Object res
| 参数名 | 类型 | 说明 | 
| -------- | -------- | -------------------------------- | 
|res|Obj|返回信息|
|res.errMsg|string|执行结果。"wedriveSelectFileForDownload:ok" 表示执行成功，否则表示报错信息|
|res.result|Obj|返回的数据|
|res.result.selectedTickets|Array<string>|选择的文件所生成的临时ticket列表|
> selectedTickets 说明：
> 1. 有效期30分钟，不限制使用次数
> 2. 可调用[文件下载](#26913/下载文件)接口
> 3. 每个文件对应一个ticket

#### 示例代码

```js
wx.qy.wedriveSelectFileForDownload({
  selectedFileNum: 1,
  success: function(res) {
    var selectedTickets = res.result.selectedTickets;
  },
  fail: function(res) {
    console.log(res)
  },
});
```

**错误列表说明**
|res.errMsg|说明|
|:-----------|:------------|
| qy.wedriveSelectFileForDownload:ok |执行成功|
| qy.wedriveSelectFileForDownload:cancel| 取消选择 |
| qy.wedriveSelectFileForDownload:fail no session or expired |没有调用 wx.qy.login，或者 session_key 已过期 |
| qy.wedriveSelectFileForDownload:fail no permission | 无权限 |  
| qy.wedriveSelectFileForDownload:fail param error | 参数错误 |
| qy.wedriveSelectFileForDownload:fail context error | 选择器异常 |
| qy.wedriveSelectFileForDownload:fail not supported system version | 低系统版本不支持 |

**平台版本说明**

|平台|企业微信版本要求|系统版本要求|
|--|--|--|
|ios|≥4.0.12||
|android|≥4.0.12||
|win|≥4.0.12||
|mac|≥4.0.12|>10.12|

**应用权限说明**

|应用类型|可调用的应用|
|--|--|
|自建应用|**不支持**|
|第三方应用|需具有“微盘”权限|
|代开发应用|需具有“微盘”权限|
