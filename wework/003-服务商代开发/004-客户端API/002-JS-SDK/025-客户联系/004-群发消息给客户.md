---
title: "群发消息给客户"
doc_id: 26772
category_id: 96921
source_url: https://developer.work.weixin.qq.com/document/path/96921
---
最后更新：2025/04/21

[[toc]]
<!-- import shareToExternalContact from @wecom/jssdk -->

## 旧版jweixin调用
### 示例代码
```javascript
wx.invoke("shareToExternalContact", {
 externalUserIds: ["wmEAlECwAAHrbAAAOK5u3Bf13xlYDAAA","wmEAlECwAAHiBBBDOK5u3Af13xlYDBBB"],//客户列表，从4.1.10版本开始支持（mac端不支持）
 text: {
 content:"", // 文本内容
 },
 attachments: [
   {
    msgtype: "image", // 消息类型，必填
         image: {
            mediaid: "", // 图片的素材id
            imgUrl: "", // 图片的imgUrl,跟图片mediaid填其中一个即可
         },
      },
      {
         msgtype: "link", // 消息类型，必填
         link: {
            title: "", // H5消息标题
           imgUrl: "", // H5消息封面图片URL
           desc: "", // H5消息摘要
           url: "", // H5消息页面url 必填
         },
      },
      {
         msgtype: "miniprogram", // 消息类型，必填
         miniprogram: {
           appid: "", // 小程序的appid
           title: "", // 小程序消息的title
           imgUrl : "", //小程序消息的封面图。必须带http或者https协议头
           page: "", //小程序消息打开后的路径，注意要以.html作为后缀，否则在微信端打开会提示找不到页面
         },
      },
      {
         msgtype: "video", // 消息类型，必填
         video:{
            mediaid:"", // 视频的素材id
         },
      },
      {
         msgtype: "file", // 消息类型，必填，从3.1.12版本开始支持
         file:{
            mediaid:"", // 文件的素材id，必填
         },
      },
 ]},function(res) {
 if (res.err_msg == "shareToExternalContact:ok") {
 }
  }
);
```
