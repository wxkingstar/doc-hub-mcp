---
title: "企业互联/上下游选人接口"
doc_id: 28678
category_id: 96928
source_url: https://developer.work.weixin.qq.com/document/path/28678
---
[[toc]]

<!-- import selectCorpGroupContact from @wecom/jssdk -->

## 旧版jweixin调用
### 代码示例
```javascript
wx.invoke("selectCorpGroupContact", {
 fromDepartmentId: -1,// 必填，表示打开的通讯录从指定的部门开始展示，-1表示打开的通讯录从自己所在部门开始展示, 0表示从最上层开始。移动端，当需要展开的部门不在应用可见范围内，则从应用的可见范围开始展开。
 mode: "single",// 必填，选择模式，single表示单选，multi表示多选
 type: ["department", "user"],// 必填，选择限制类型，指定department、user中的一个或者多个
 selectedDepartmentIds: ["2","3"],// 非必填，已选部门ID列表。用于多次选人时可重入
 selectedUserIds: ["lisi","lisi2"],// 非必填，仅自建应用使用，第三方应用会忽略该字段，已选用户ID列表。用于多次选人时可重入
   selectedOpenUserIds: ["wabc3","wbcde"],// 非必填，仅第三方应用使用，自建应用会忽略该字段，已选用户ID列表。用于多次选人时可重入
 selectedChainDepartmentIds: [    // 非必填，已选上下游部门ID列表。用于多次选人时可重入
 {
 corpId:"ww3333",         // 企业CORPID
 departmentId:"2"         // 部门ID
 },
     {
 corpId:"ww4444",        // 企业CORPID
 departmentId:"3"        // 部门ID
 }
 ],
 selectedChainUserIds: [ // 非必填，已选上下游用户ID列表。用于多次选人时可重入
 {
 corpId:"ww3333",         // 企业CORPID
       userId:"userid123",         // 成员ID，仅自建应用返回
       openUserId:"wx1111"         // 成员OPEN_USERID，仅第三方应用返回
 },
     {
 corpId:"ww4444",        // 企业CORPID
       userId:"userid123",         // 成员ID，仅自建应用返回
       openUserId:"wx1111"         // 成员OPEN_USERID，仅第三方应用返回
 }
 ],
 selectedCorpGroupDepartmentIds: [    // 非必填，已选企业互联部门ID列表。用于多次选人时可重入
 {
 corpId:"ww3333",         // 企业CORPID
    departmentId:"2"         // 部门ID
 },
     {
 corpId:"ww4444",        // 企业CORPID
    departmentId:"3"        // 部门ID
 }
 ],
 selectedCorpGroupUserIds: [ // 非必填，已选企业互联用户ID列表。用于多次选人时可重入
 {
 corpId:"ww3333",         // 企业CORPID
       userId:"userid123",         // 成员ID，仅自建应用返回
       openUserId:"wx1111"         // 成员OPEN_USERID，仅第三方应用返回
 },
     {
 corpId:"ww4444",        // 企业CORPID
       userId:"userid123",         // 成员ID，仅自建应用返回
       openUserId:"wx1111"         // 成员OPEN_USERID，仅第三方应用返回
 }
 ]
 },function(res){
 if (res.err_msg == "selectCorpGroupContact:ok")
 {
 if(typeof res.result == 'string')
 {
 res.result = JSON.parse(res.result) //由于目前各个终端尚未完全兼容，需要开发者额外判断result类型以保证在各个终端的兼容性
 }
 
 var selectedDepartmentList = res.result.departmentList;// 已选的部门列表
 for (var i = 0; i < selectedDepartmentList.length; i++)
 {
 var department = selectedDepartmentList[i];
 var departmentId = department.id;// 已选的单个部门ID
 }
 var selectedUserList = res.result.userList; // 已选的成员列表
 for (var i = 0; i < selectedUserList.length; i++)
 {
            var user = selectedUserList[i];
 var userid = user.id; // 已选的单个成员ID，仅自建应用返回
            var openUserId = user.openUserId; // 已选的单个成员ID，仅第三方应用返回
 }
 var selectedCorpGroupDepartmentList = res.result.corpGroupDepartmentList;// 已选的部门列表
 for (var i = 0; i < selectedCorpGroupDepartmentList.length; i++)
 {
 var corpGroupDepartment = selectedCorpGroupDepartmentList[i];
   var corpId = corpGroupDepartment.corpId; // 企业CORPID
 var departmentId = corpGroupDepartment.id;// 已选的单个部门ID
 }
     var selectedCorpGroupUserList = res.result.corpGroupUserList; // 已选的已选企业互联成员列表
 for (var i = 0; i < selectedGroupUserList.length; i++)
 {
 var corpGroupUser = selectedCorpGroupUserList[i];
   var corpId = corpGroupUser.corpId; // 企业CORPID
 var userId = corpGroupUser.id; // 已选的单个成员ID，仅自建应用返回
            var openUserId = corpGroupUser.openUserId; // 已选的单个成员ID，仅第三方应用返回
 }
       var selectedChainDepartmentList = res.result.chainDepartmentList;// 已选的部门列表
 for (var i = 0; i < selectedChainDepartmentList.length; i++)
 {
 var chainDepartment = selectedChainDepartmentList[i];
   var corpId = chainDepartment.corpId; // 企业CORPID
 var departmentId = chainDepartment.id;// 已选的单个部门ID
 }
       var selectedChainUserList = res.result.chainUserList; // 已选的已选企业互联成员列表
 for (var i = 0; i < selectedCorpGroupUserList.length; i++)
 {
 var chainUser = selectedCorpGroupUserList[i];
   var corpId = chainUser.corpId; // 企业CORPID
 var userId = chainUser.id; // 已选的单个成员ID，仅自建应用返回
            var openUserId = chainUser.openUserId; // 已选的单个成员ID，仅第三方应用返回
 }
 }
    }
);

```
