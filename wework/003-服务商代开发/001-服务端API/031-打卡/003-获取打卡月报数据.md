---
title: "获取打卡月报数据"
doc_id: 25798
category_id: 96499
source_url: https://developer.work.weixin.qq.com/document/path/96499
---
最后更新：2025/03/24

企业可通过具有调用权限的应用，获取应用可见范围内指定员工指定日期内的打卡月报统计数据。

**请求方式**: POST(**HTTPS**)

**请求地址:** https://qyapi.weixin.qq.com/cgi-bin/checkin/getcheckin_monthdata?access_token=ACCESS_TOKEN

**请求示例**

```json
{
 "starttime": 1599062400,
 "endtime": 1599408000,
 "useridlist": [
 "ZhangSan"
 ]
}
```

**参数说明**:

|参数|必须|类型|说明|
|:-----------|:---|:-------|:------------|
| access_token | 是 | string | 调用接口凭证，使用自建应用的Secret获取access_token，获取方式参考：[文档-获取access_token](https://work.weixin.qq.com/api/doc#90000/90135/91039 "文档") |
|starttime|是|uint32|获取月报的开始时间。0点Unix时间戳|
|endtime|是|uint32|获取月报的结束时间。0点Unix时间戳|
|useridlist|是|string[]|-</br>不少于1字节</br>不多于64字节</br>可填充个数：1 ~ 100|

**权限说明**:
调用的应用需要满足如下的权限：

| 应用类型 | 权限要求 |
| -------- | ---- | 
|自建应用|配置到「!!#ff0000 打卡 - 可调用接口的应用!!」中 |
|代开发应用|具有「!!#ff0000 打卡!!」权限| 
|第三方应用|具有「!!#ff0000 打卡!!」权限|
 *注：* 从2023年12月1日0点起，不再支持通过系统应用secret调用接口，存量企业暂不受影响 [查看详情](https://developer.work.weixin.qq.com/document/51165)

**调用频率**:
接口调用频率限制为60次/分钟。

**返回结果**:

```json
{
 "errcode": 0,
 "errmsg": "ok",
 "datas": [
 {
 "base_info": {
 "record_type": 1,
 "name": "张三",
 "name_ex": "Three Zhang",
 "departs_name": "有家企业/realempty;有家企业;有家企业/部门A4",
 "rule_info": {
 "groupid": 10,
 "groupname": "规则测试"
 },
 "acctid": "ZhangSan"
 },
 "summary_info":{
 "except_days":3,
 "regular_work_sec":31,
 "standard_work_sec":29040,
 "work_days":3,
 "rest_days":0
 },
 "exception_infos":[
 {
 "count":2,
 "duration":28920,
 "exception":4
 },
 {
 "count":1,
 "duration":60,
 "exception":1
 },
 {
 "count":1,
 "duration":60,
 "exception":2
 }
 ],
 "sp_items":[
 {
 "count":0,
 "duration":0,
 "time_type":0,
 "type":100,
 "vacation_id":0,
          "name": "外勤次数"
 },
 {
 "count":1,
 "duration":0,
 "time_type":0,
 "type":1,
 "vacation_id":2,
          "name": "年假"
 }
 ],
 "overwork_info": {
        "workday_over_sec": 54000,
        "restdays_over_sec": 205560,
        "workdays_over_as_vacation": 0,
        "workdays_over_as_money": 54000,
        "restdays_over_as_vacation": 0,
        "restdays_over_as_money": 172800,
        "holidays_over_as_vacation": 0,
        "holidays_over_as_money": 0
      }
 }
 ]
}
```

**参数说明**:

|参数|类型|说明|
|:-----------|:-------------|:----------|
|errcode|int32|返回码|
|errmsg|string|错误码描述|
|datas|obj[]|月报数据列表|
|datas.base_info|obj|基础信息|
|datas.base_info.record_type|uint32|记录类型：1-固定上下班；2-外出（此报表中不会出现外出打卡数据）；3-按班次上下班；4-自由签到；5-加班；7-无规则|
|datas.base_info.name|string|打卡人员姓名|
|datas.base_info.name_ex|string|打卡人员别名|
|datas.base_info.departs_name|string|打卡人员所在部门，会显示所有所在部门|
|datas.base_info.acctid|string|打卡人员账号，即userid|
|datas.base_info.rule_info|obj|打卡人员所属规则信息|
|datas.base_info.rule_info.groupid|int32|所属规则的id|
|datas.base_info.rule_info.groupname|string|打卡规则名|
|datas.summary_info|obj|汇总信息|
|datas.summary_info.work_days|int32|应出勤天数|
|datas.summary_info.regular_days|int32|正常天数|
|datas.summary_info.rest_days|int32 |休息天数|
|datas.summary_info.except_days|int32|异常天数|
|datas.summary_info.regular_work_sec|int32|实际工作时长，为统计周期每日实际工作时长之和, 单位: 秒|
|datas.summary_info.standard_work_sec|int32|标准工作时长，为统计周期每日标准工作时长之和, 单位: 秒|
|datas.exception_infos|obj[]|异常状态统计信息|
|datas.exception_infos.exception|uint32|异常类型：1-迟到；2-早退；3-缺卡；4-旷工；5-地点异常；6-设备异常|
|datas.exception_infos.count|int32|异常次数，为统计周期内每日此异常次数之和|
|datas.exception_infos.duration|int32|异常时长（迟到/早退/旷工才有值），为统计周期内每日此异常时长之和|
|datas.sp_items|obj[]|假勤统计信息|
|datas.sp_items.type|uint32|假勤类型：1-请假；2-补卡；3-出差；4-外出；15-审批打卡；100-外勤|
|datas.sp_items.vacation_id|uint32|具体请假类型，当type为1请假时，具体的请假类型id，可通过审批相关接口获取假期详情|
|datas.sp_items.count|uint32|假勤次数，为统计周期内每日此假勤发生次数之和|
|datas.sp_items.duration|uint32|假勤时长，为统计周期内每日此假勤发生时长之和，时长单位为天直接除以86400即为天数，单位为小时直接除以3600即为小时数|
|datas.sp_items.time_type|uint32|时长单位：0-按天 1-按小时|
|datas.sp_items.name|string|统计项名称|
|datas.overwork_info|obj|加班情况|
|datas.overwork_info.workday_over_sec|int32|工作日加班时长|
|datas.overwork_info.holidays_over_sec|int32|节假日加班时长|
|datas.overwork_info.restdays_over_sec|int32|休息日加班时长|
| datas.overwork_info.workdays_over_as_vacation | int32 | 工作日加班记为调休，单位秒 |
| datas.overwork_info.workdays_over_as_money | int32 | 工作日加班记为加班费，单位秒 |
| datas.overwork_info.restdays_over_as_vacation | int32 | 休息日加班记为调休，单位秒 |
| datas.overwork_info.restdays_over_as_money | int32 | 休息日加班记为加班费，单位秒 |
| datas.overwork_info.holidays_over_as_vacation | int32 | 节假日加班记为调休，单位秒 |
| datas.overwork_info.holidays_over_as_money | int32 | 节假日加班记为加班费，单位秒 |
