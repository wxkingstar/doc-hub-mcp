---
title: "获取对外收款记录"
doc_id: 24937
category_id: 96701
source_url: https://developer.work.weixin.qq.com/document/path/96701
---
最后更新：2024/03/27

企业和服务商可通过此接口获取企业的**对外收款记录**。

**请求方式：**POST(**HTTPS**)
**请求地址：**https://qyapi.weixin.qq.com/cgi-bin/externalpay/get_bill_list?access_token=ACCESS_TOKEN

**请求示例：**
```
{
 "begin_time":1605171726,
 "end_time":1605172726,
 "payee_userid":"zhangshan",
 "cursor":"CURSOR",
 "limit":10
}
```

**参数说明：**

| 参数 | 必须 | 说明 |
| :----------- | :--- | :----------------- |
| begin_time   | 是 | 收款记录开始时间戳，单位为秒 |
| end_time | 是 | 收款记录结束时间戳，单位为秒 |
|payee_userid|否|企业收款成员userid，不填则为全部成员|
|cursor|否|用于分页查询的游标，字符串类型，由上一次调用返回，首次调用可不填|
|limit|否|返回的最大记录数，整型，最大值1000|

**补充说明:**
>收款记录的起止时间间隔不能超过1个月。
>会过滤收款人不在可见范围中的收款记录，因此返回的记录数可能会小于limit设置的最大记录数。
>如果没有获取到next_cursor，说明已经拉取完所有的数据。

**权限说明：**
- 只会返回当前在应用可见范围内用户的收款记录
- 4.1.0及以上版本中新增的部分商户号收款记录，不会返回给第三方应用和代开发应用
- 调用的应用需要满足如下的权限
| 应用类型 | 权限要求 |
| -------- | ---- | 
|自建应用|配置到「[对外收款- 可调用接口的应用](#24952/配置可调用接口的应用)」中 |
|代开发应用|具有「!!#ff0000 对外收款!!」权限|
|第三方应用|具有「!!#ff0000 对外收款!!」权限|
 *注：* 从2023年12月1日0点起，不再支持通过系统应用secret调用接口，存量企业暂不受影响 [查看详情](https://developer.work.weixin.qq.com/document/51165)

**返回结果：**
```
{
  "errcode":0,
  "errmsg":"ok",
  "next_cursor":"CURSOR",
  "bill_list":[
    {
      "transaction_id":"xxxxx",
      "bill_type":1,
      "trade_state":1,
      "pay_time":12345,
      "out_trade_no":"xxxx",
      "out_refund_no":"xxxxx",
      "external_userid":"xxxx",
      "total_fee":100,
      "payee_userid":"zhangshan",
      "payment_type":1,
      "mch_id":"123454",
      "remark":"xxxx",
      "commodity_list":[
        {
          "description":"手机",
          "amount":1
        }
      ],
      "total_refund_fee":100,
      "refund_list":[
        {
          "out_refund_no":"xx",
          "refund_userid":"xxx",
          "refund_comment":"xxx",
          "refund_reqtime":1605171790,
          "refund_status":1,
          "refund_fee":100
        }
      ],
      "contact_info":{
        "name":"xxx",
        "phone":"xxx",
        "address":"xxx"
      },
      "miniprogram_info":{
        "appid":"xxx",
        "name":"xxx"
      }
    }
  ]
}
```

**参数说明：**

| 参数 | 说明 |
| :----------- | :----------------- |
| errcode | 返回码 |
| errmsg | 对返回码的文本描述内容 |
| next_cursor | 分页游标，在下次请求时填写以获取之后分页的记录，如果已经没有更多的数据则不返回该字段|
|bill_list|交易单详情列表|
| transaction_id |交易单号|
|bill_type|交易类型：<br>0：收款记录<br>1：退款记录|
|trade_state|交易状态（退款记录不返回该字段）：<br>1：已完成 <br>3：已完成有退款|
|pay_time|交易时间|
|out_trade_no|商户单号。如果是退款记录，返回对应收款记录的商户单号|
|out_refund_no|退款单号，退款记录返回该字段|
|external_userid|付款人的userid|
|total_fee|收款总金额，单位为分|
|payee_userid|企业内账号userid。退款记录的该字段为退款成员userid，收款记录的该字段为收款成员userid|
|payment_type|收款方式：<br>0：在聊天中收款<br>1：收款码收款 <br>2：在直播间收款 <br>3：用产品图册收款 <br>14：转账<br>15：小程序（仅部分灰度企业可在小程序中接入对外收款账户进行收款）|
|mch_id|收款商户号id|
|remark|备注。退款记录的该字段为退款备注，收款记录的该字段为收款备注|
|commodity_list|商品信息详情列表,商品信息结构参考commodity。退款记录不返回该字段|
|total_refund_fee|退款总金额|
|refund_list|退款单据详情列表，退款单据详情参考refund。退款记录不返回该字段|
|contact_info|联系人信息，详情参考contact，如创建收款项目时设置为不需要联系地址，则该字段为空，**第三方不可获取**。退款记录不返回该字段|
|miniprogram_info|小程序信息，详情参考miniprogram。收款方式为小程序时返回该字段|

**商品信息详情(commodity):**

| 参数 | 说明 |
| :----------- | :----------------- |
|description|商品描述|
|amount|商品数量|

**退款单据详情(refund):**

| 参数 | 说明 |
| :----------- | :----------------- |
|out_refund_no|退款单号|
|refund_userid|退款发起人ID|
|refund_comment|退款备注|
|refund_reqtime|退款发起时间|
|refund_status|退款状态：<br>0：已申请退款<br>1：退款处理中<br>2：退款成功<br>3：退款关闭<br>4：退款异常<br>5：审批中<br>6：审批失败<br>7：审批取消|
|refund_fee|退款金额|

**联系人信息(contact)（第三方不可获取）:**

| 参数 | 说明 |
| :----------- | :----------------- |
|name|联系人姓名|
|phone|联系人手机号|
|address|联系地址|

**小程序信息(miniprogram):**

| 参数 | 说明 |
| :----------- | :----------------- |
|appid|小程序appid|
|name|小程序名称|
