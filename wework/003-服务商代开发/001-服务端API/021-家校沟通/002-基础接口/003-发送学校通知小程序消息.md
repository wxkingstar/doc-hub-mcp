---
title: "发送「学校通知」小程序消息"
doc_id: 20450
category_id: 96723
source_url: https://developer.work.weixin.qq.com/document/path/20450
---
[TOC]

## 概述
学校可以通过此接口来发送 **小程序消息** 类型的学校通知。
更多的接口描述和消息类型在[发送「学校通知」](#90001/90143/92291)查看。

## 接口定义
 
**请求方式：**POST（**HTTPS**）
**请求地址：** https://qyapi.weixin.qq.com/cgi-bin/externalcontact/message/send?access_token=ACCESS_TOKEN

**参数说明：**
 
 | 参数 | 是否必须 | 说明 |
 |----|---- | ----- |
 | access_token | 是 | 调用接口凭证 |
 > 支持id转译，将userid/部门id转成对应的企业通讯录内部的用户名/部门名，目前仅**文本/图文/图文（mpnews）/小程序消息**这四种消息类型的**部分字段**支持。具体支持的范围和语法，请查看附录[id转译说明](#10167/id转译说明)。
 
**权限说明：**
 - 第三方应用需拥有「家校沟通」使用权限。

 **返回示例：**
 ```]
 {
 "errcode" : 0,
 "errmsg" : "ok",
 "invalid_external_user" : ["external_userid1"],
 "invalid_parent_userid" : ["parent_userid1"],
 "invalid_student_userid" : ["student_userid1"],
 "invalid_party" : ["party1"]
 }
 ```

## 消息类型

###小程序消息

**请求示例：**

```
{
 "to_external_user" : ["external_userid1", "external_userid2"],
 "to_parent_userid": ["parent_userid1", "parent_userid2"],
 "to_student_userid": ["student_userid1", "student_userid2"],
 "to_party": ["partyid1", "partyid2"],
 "toall" : 0,
 "agentid" : 1,
 "msgtype" : "miniprogram",
 "miniprogram" : {
 "appid": "APPID",
 "title": "欢迎报名夏令营",
 "thumb_media_id": "MEDIA_ID",
 "pagepath": "PAGE_PATH"
 },
 "enable_id_trans": 0
}

```

**参数说明：**

 | 参数 | 是否必须 | 说明 |
 |----|---- | ----- |
 | to_external_user | 否 | [已关注「学校通知」的家长列表](#17388)，即将废弃（最多支持1000个）|
 | to_parent_userid | 否 | [家校通讯录家长列表](#18819)（最多支持1000个）|
 | to_student_userid | 否 | [家校通讯录学生列表](#18819)（最多支持1000个）|
 | to_party | 否 | [家校通讯录部门列表](#18840)（最多支持100个）|
 | toall | 否 | 1表示发送给学校的所有家长，默认为0
 | msgtype | 是 | 消息类型，此时固定为：miniprogram |
 | agentid | 是 | 企业应用的id，整型。可在应用的设置页面查看 |
 | appid | 是 | 小程序appid，必须是与当前应用关联的小程序 |
 | title | 否 | 小程序消息标题，最多64个字节，超过会自动截断**（支持id转译）** |
 | thumb_media_id | 是 | 小程序消息封面的mediaid，封面图建议尺寸为520*416|
 | pagepath | 是 | 点击消息卡片后进入的小程序页面路径 |
 | enable_id_trans | 否 | 表示是否开启id转译，0表示否，1表示是，默认0 |

**小程序消息展现：**
- ![](http://p.qpic.cn/pic_wework/136371189/2e282b3f44a28d5f78db4cb197649fc4c30b7a5513f7dfa0/0)
