---
title: "获客助手事件通知"
doc_id: 47918
category_id: 98958
source_url: https://developer.work.weixin.qq.com/document/path/98958
---
最后更新：2024/09/14

[TOC]

应用接收回调权限说明：
| 应用类型 | 权限要求 | 接收事件开关|
| -------- | ---- | 
|自建应用|配置到「[客户联系- 可调用接口的应用](#13473/配置可调用接口的应用)」中 |[外部联系人变更回调](#12977/开启接收消息)|
|代开发应用|具有「!!#ff0000 企业客户权限->客户基础信息”!!」权限| 无|
|第三方应用|具有「!!#ff0000 企业客户权限->客户基础信息”!!」权限|无|

## 企业使用量即将耗尽事件
当获客助手的使用量低于20次时，将回调此事件。

事件示例：

```
<xml>
  <ToUserName><
- ![CDATA[toUser]]></ToUserName>
  <FromUserName><
- ![CDATA[sys]]></FromUserName> 
  <CreateTime>1403610513</CreateTime>
  <MsgType><
- ![CDATA[event]]></MsgType>
  <Event><
- ![CDATA[customer_acquisition]]></Event>
  <ChangeType><
- ![CDATA[balance_low]]></ChangeType>
</xml>
```

参数说明：

 | 参数 | 说明 |
 |----|---- |
 |ToUserName|企业微信CorpID |
 |FromUserName|此事件该值固定为sys，表示该消息由系统生成 |
 |CreateTime|消息创建时间 （整型） |
 |MsgType|消息的类型，此时固定为event |
 |Event|事件的类型，此时固定为customer_acquisition |
 |ChangeType|此时固定为balance_low|
 
 
## 使用量已经耗尽事件
当获客助手的使用量已经消耗完时，回调此事件。

事件示例：

```
<xml>
  <ToUserName><
- ![CDATA[toUser]]></ToUserName>
  <FromUserName><
- ![CDATA[sys]]></FromUserName> 
  <CreateTime>1403610513</CreateTime>
  <MsgType><
- ![CDATA[event]]></MsgType>
  <Event><
- ![CDATA[customer_acquisition]]></Event>
  <ChangeType><
- ![CDATA[balance_exhausted]]></ChangeType>
</xml>
```

参数说明：

 | 参数 | 说明 |
 |----|---- |
 |ToUserName|企业微信CorpID |
 |FromUserName|此事件该值固定为sys，表示该消息由系统生成 |
 |CreateTime|消息创建时间 （整型） |
 |MsgType|消息的类型，此时固定为event |
 |Event|事件的类型，此时固定为customer_acquisition |
 |ChangeType|此时固定为balance_exhausted |
 
## 使用量增加事件事件
当获客助手的使用量从0变到非0时，回调此事件。

事件示例：

```
<xml>
  <ToUserName><
- ![CDATA[toUser]]></ToUserName>
  <FromUserName><
- ![CDATA[sys]]></FromUserName> 
  <CreateTime>1403610513</CreateTime>
  <MsgType><
- ![CDATA[event]]></MsgType>
  <Event><
- ![CDATA[customer_acquisition]]></Event>
  <ChangeType><
- ![CDATA[balance_increased]]></ChangeType>
</xml>
```

参数说明：

 | 参数 | 说明 |
 |----|---- |
 |ToUserName|企业微信CorpID |
 |FromUserName|此事件该值固定为sys，表示该消息由系统生成 |
 |CreateTime|消息创建时间 （整型） |
 |MsgType|消息的类型，此时固定为event |
 |Event|事件的类型，此时固定为customer_acquisition |
 |ChangeType|此时固定为balance_increased |
 
 ## 获客链接异常事件
若链接中的成员暂时无法添加客户时，会在分配时自动跳过该成员。当链接中配置的全部成员账号异常，暂时无法继续添加客户时，回调此事件到创建相应链接的应用，可及时调整链接配置或流量曝光策略，避免流量浪费。

事件示例：

```
<xml>
  <ToUserName><
- ![CDATA[toUser]]></ToUserName>
  <FromUserName><
- ![CDATA[sys]]></FromUserName> 
  <CreateTime>1403610513</CreateTime>
  <MsgType><
- ![CDATA[event]]></MsgType>
  <Event><
- ![CDATA[customer_acquisition]]></Event>
  <ChangeType><
- ![CDATA[link_unavailable]]></ChangeType>
  <LinkId><
- ![CDATA[cawcdea7783d7330b4]]></LinkId>
</xml>
```

参数说明：

 | 参数 | 说明 |
 |----|---- |
 |ToUserName|企业微信CorpID |
 |FromUserName|此事件该值固定为sys，表示该消息由系统生成 |
 |CreateTime|消息创建时间 （整型） |
 |MsgType|消息的类型，此时固定为event |
 |Event|事件的类型，此时固定为customer_acquisition |
 |ChangeType|此时固定为link_unavailable|
 |LinkId|失效的获客链接ID|

 ## 删除获客链接事件
当API创建的获客链接在管理端或终端被删除时，回调此事件。

事件示例：

```
<xml>
  <ToUserName><
- ![CDATA[toUser]]></ToUserName>
  <FromUserName><
- ![CDATA[sys]]></FromUserName> 
  <CreateTime>1403610513</CreateTime>
  <MsgType><
- ![CDATA[event]]></MsgType>
  <Event><
- ![CDATA[customer_acquisition]]></Event>
  <ChangeType><
- ![CDATA[delete_link]]></ChangeType>
  <LinkId><
- ![CDATA[cawcdea7783d7330b4]]></LinkId>
</xml>
```

参数说明：

 | 参数 | 说明 |
 |----|---- |
 |ToUserName|企业微信CorpID |
 |FromUserName|此事件该值固定为sys，表示该消息由系统生成 |
 |CreateTime|消息创建时间 （整型） |
 |MsgType|消息的类型，此时固定为event |
 |Event|事件的类型，此时固定为customer_acquisition |
 |ChangeType|此时固定为delete_link|
 |LinkId|被删除的获客链接ID|
>注意，通过API接口删除获客链接不会触发此回调事件

 ## 微信客户打开获客链接事件
当微信客户通过获客链接进入成员的profile页时，回调此事件。仅部分经营类目企业支持，当前企业是否支持可在「高级功能-获客助手」中查看该类目对应的功能是否包含「链接打开回调」。

事件示例：

```
<xml>
  <ToUserName><
- ![CDATA[toUser]]></ToUserName>
  <FromUserName><
- ![CDATA[sys]]></FromUserName> 
  <CreateTime>1689171577</CreateTime>
  <MsgType><
- ![CDATA[event]]></MsgType>
  <Event><
- ![CDATA[customer_acquisition]]></Event>
  <ChangeType><
- ![CDATA[open_profile]]></ChangeType>
  <LinkId><
- ![CDATA[cawcdea7783d7330c6]]></LinkId>
  <State><
- ![CDATA[STATE]]></State>
</xml>
```

参数说明：

 | 参数 | 说明 |
 |----|---- |
 |ToUserName|企业微信CorpID |
 |FromUserName|此事件该值固定为sys，表示该消息由系统生成 |
 |CreateTime|消息创建时间 （整型） |
 |MsgType|消息的类型，此时固定为event |
 |Event|事件的类型，此时固定为customer_acquisition |
 |ChangeType|此时固定为open_profile|
  |LinkId|点击的获客链接ID|
 |State|点击的获客链接配置的customer_channel值|

 ## 通过获客链接发起好友请求事件
当微信用户通过获客链接点击添加到通讯录，成功发起好友请求，回调此事件。

事件示例：

```
<xml>
  <ToUserName><
- ![CDATA[toUser]]></ToUserName>
  <FromUserName><
- ![CDATA[sys]]></FromUserName> 
  <CreateTime>1689171577</CreateTime>
  <MsgType><
- ![CDATA[event]]></MsgType>
  <Event><
- ![CDATA[customer_acquisition]]></Event>
  <ChangeType><
- ![CDATA[friend_request]]></ChangeType>
  <LinkId><
- ![CDATA[cawcdea7783d7330c6]]></LinkId>
  <State><
- ![CDATA[STATE]]></State>
</xml>
```

参数说明：

 | 参数 | 说明 |
 |----|---- |
 |ToUserName|企业微信CorpID |
 |FromUserName|此事件该值固定为sys，表示该消息由系统生成 |
 |CreateTime|消息创建时间 （整型） |
 |MsgType|消息的类型，此时固定为event |
 |Event|事件的类型，此时固定为customer_acquisition |
 |ChangeType|此时固定为friend_request|
  |LinkId|点击的获客链接ID|
 |State|点击的获客链接配置的customer_channel值|
 
## 成员首次收消息事件
授权企业中[配置了客户联系功能](#13473/开始开发)的成员**通过获客链接添加微信客户**后，当成员首次收到客户消息时，回调此事件。

请求示例：
```
<xml>
<ToUserName><
- ![CDATA[toUser]]></ToUserName>
<FromUserName><
- ![CDATA[sys]]></FromUserName> 
<CreateTime>1403610513</CreateTime>
<MsgType><
- ![CDATA[event]]></MsgType>
<Event><
- ![CDATA[customer_acquisition]]></Event>
<ChangeType><
- ![CDATA[customer_start_chat]]></ChangeType>
<UserID><
- ![CDATA[zhangsan]]></UserID>
<ExternalUserID><
- ![CDATA[woAJ2GCAAAXtWyujaWJHDDGi0mAAAA]]></ExternalUserID>
<LinkId><
- ![CDATA[cawcdea7783d7330c6]]></LinkId>
</xml>
```

参数说明：

 | 参数 | 说明 |
 |----|---- |
 |ToUserName|企业微信CorpID|
 |FromUserName|此事件该值固定为sys，表示该消息由系统生成 |
 |CreateTime|消息创建时间 （整型）|
 |MsgType|消息的类型，此时固定为event|
 |Event|固定为customer_acquisition|
 |ChangeType|此时固定为customer_start_chat |
 |UserID|企业服务人员的UserID |
 |ExternalUserID|外部联系人的userid，注意不是企业成员的账号 |
 |LinkId|获客链接ID|
 

> 第三方应用可以根据ExternalUserID调用“[获取客户详情](#90000/90135/90224)”读取详情。
>目前仅对微信客户支持此事件

## 成员多次收消息事件
授权企业中[配置了客户联系功能](#13473/开始开发)的成员**通过获客链接添加微信客户**后，当成员第3、5、10次收到客户消息时，回调此事件。该事件仅在获客助手内测期限时免费提供。

注：3次、5次、10次为近期新增统计，仅能针对上线后才第1次收到消息的客户生效。

请求示例：
```
<xml>
<ToUserName><
- ![CDATA[toUser]]></ToUserName>
<FromUserName><
- ![CDATA[sys]]></FromUserName> 
<CreateTime>1403610513</CreateTime>
<MsgType><
- ![CDATA[event]]></MsgType>
<Event><
- ![CDATA[customer_acquisition]]></Event>
<ChangeType><
- ![CDATA[message_from_customer]]></ChangeType>
<UserID><
- ![CDATA[zhangsan]]></UserID>
<ExternalUserID><
- ![CDATA[woAJ2GCAAAXtWyujaWJHDDGi0mAAAA]]></ExternalUserID>
<LinkId><
- ![CDATA[cawcdea7783d7330c6]]></LinkId>
<ChatSeq>3</ChatSeq>
<ChatKey><
- ![CDATA[CHAT_KEY]]></ChatKey>
</xml>
```

参数说明：

 | 参数 | 说明 |
 |----|---- |
 |ToUserName|企业微信CorpID|
 |FromUserName|此事件该值固定为sys，表示该消息由系统生成 |
 |CreateTime|消息创建时间 （整型）|
 |MsgType|消息的类型，此时固定为event|
 |Event|固定为customer_acquisition|
 |ChangeType|此时固定为message_from_customer|
 |UserID|企业服务人员的UserID<font color=red>(2024年12月19号0点开始将不再回调该字段，请根据ChatKey参数查询收消息数据)</font> |
 |ExternalUserID|外部联系人的userid，注意不是企业成员的账号<font color=red>(2024年12月19号0点开始将不再回调该字段，请根据ChatKey参数查询收消息数据)</font> |
 |LinkId|获客链接ID|
 |ChatSeq|成员收到消息的次数<font color=red>(2024年12月19号0点开始将不再回调该字段，请根据ChatKey参数查询收消息数据)</font>|
 |ChatKey|成员收消息的会话信息凭据，可通过调用[获取获客链接使用成员接受消息数据](#55183)接口获取详细的收消息信息，回调后20分钟内有效|

> 应用可以根据ExternalUserID调用“[获取客户详情](#90000/90135/90224)”读取详情。
>目前仅对微信客户支持此事件

 ## 获客使用量即将过期事件
当企业购买的获客助手使用量即将过期时，将在过期前的14天、7天、3天、2天及1天回调此事件。

事件示例：

```
<xml>
  <ToUserName><
- ![CDATA[toUser]]></ToUserName>
  <FromUserName><
- ![CDATA[sys]]></FromUserName> 
  <CreateTime>1689171577</CreateTime>
  <MsgType><
- ![CDATA[event]]></MsgType>
  <Event><
- ![CDATA[customer_acquisition]]></Event>
  <ChangeType><
- ![CDATA[quota_expire_soon]]></ChangeType>
  <ExpireTime>1690819200</ExpireTime>
  <ExpireQuotaNum>100</ExpireQuotaNum>
</xml>
```

参数说明：

 | 参数 | 说明 |
 |----|---- |
 |ToUserName|企业微信CorpID |
 |FromUserName|此事件该值固定为sys，表示该消息由系统生成 |
 |CreateTime|消息创建时间 （整型） |
 |MsgType|消息的类型，此时固定为event |
 |Event|事件的类型，此时固定为customer_acquisition |
 |ChangeType|此时固定为quota_expire_soon|
 |ExpireTime|额度过期时间戳|
 |ExpireQuotaNum|即将过期的获客额度数|
