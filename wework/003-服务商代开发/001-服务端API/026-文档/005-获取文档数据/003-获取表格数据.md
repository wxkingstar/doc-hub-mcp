---
title: "获取表格数据"
doc_id: 44380
category_id: 98037
source_url: https://developer.work.weixin.qq.com/document/path/44380
---
[TOC]
## 获取表格数据
本接口用于获取指定范围内的在线表格信息，单次查询的范围大小需满足以下限制：

1. 查询范围行数 `<=1000` 
2. 查询范围列数 `<=200` 
3. 范围内的总单元格数量 `<=10000`

**请求方式**：POST（**HTTPS**）
**请求地址**: https://qyapi.weixin.qq.com/cgi-bin/wedoc/spreadsheet/get_sheet_range_data?access_token=ACCESS_TOKEN 

**请求包体**

```json
{
  "docid": "DOCID",
  "sheet_id": "AABBCC",
  "range": "A1:B2"
}
```

**参数说明**

| 参数 | 类型 | 是否必须 | 说明 |
|------------|--------|------|----------------------------|
|docid |string |是 |在线表格唯一标识 |
|sheet_id |string |是 |工作表ID，工作表的唯一标识 |
|range |string |是 |查询的范围，格式遵循 [A1表示法](#A1表示法) |

**权限说明**
- 自建应用需配置到“[可调用应用](#43883)”列表中的应用secret所获取的accesstoken来调用（[accesstoken如何获取？](#10013/第三步：获取access_token)）
- 第三方应用需具有“文档”权限
- 代开发自建应用需具有“文档”权限

**返回示例**

```json
{
  "errcode": 0,
  "errmsg": "ok",
  "data": {
    "result": {
      
    }
  }
}
```

**参数说明**

| 参数 |类型| 说明 |
|---------|-------|-------|
| errcode |int32| 错误码 |
| errmsg |string| 错误码说明 |
|data.result| object([GridData](#GridData))| 表格数据|

## 参数详细说明
由于返回结果比较复杂，在本节分Object分别说明

### GridData 
GridData定义了表格的具体数据内容

**示例**
```
{
  "start_row": 1,
  "start_column": 1,
  "rows": [
    {}, {}
  ]
}
```

|字段名 |类型 |描述 |
|:--|
|start_row |uint32 |起始行编号 （从0开始计算） |
|start_column |uint32 |起始列编号 （从0开始计算） |
|rows |object\[\]([RowData](#RowData)) |各行的数据 |
<!--
|row_metadata |object\[\]([DimensionProperties](#DimensionProperties)) |各行的元数据 |
|column_metadata |object\[\]([DimensionProperties](#DimensionProperties)) |各列的元数据 |
-->

### RowData
行数据的资源描述

**示例**
```
{
  "values": [
    {}, {}
  ]
}
```
|字段名 |数据类型 |描述 |
|:--|
|values |object\[\]([CellData](#CellData)) | 各个单元格的数据内容 |

<!--### DimensionProperties
行或列的元数据

**示例**
```
{
  "size_in_pixel": 10,
  "dimension": "COLUMN",
  "column_data_type": "DATA_TYPE_UNSPECIFIED"
}
```

|字段名 |数据类型 |描述 |
|:--|
|size_in_pixel |uint32 |行高（或者列宽），单位：像素 |
|dimension |string |声明维度属性为行或列。参考 [Dimension](#Dimension) |
|column_data_type |string |列的数据类型，仅在 `dimension` 为 `COLUMN` 时生效，枚举值参考：[DataType](#DataType) |
-->

### CellData
单元格的信息

**示例**
```
{
  "cell_value": {},
  "cell_format": {}
}
```

|字段名 |数据类型 |描述 |
|:--|
|cell_value |object([CellValue](#CellValue)) |单元格的数据内容 |
|cell_format |object([CellFormat](#CellFormat)) |单元格的样式信息 |
<!--
|data_type |string |单元格的数据类型，枚举值参考：[DataType](#DataType) |
-->

### CellValue
单元格的数据内容，暂时只支持文本、链接，一个CellValue中只能选填一个字段

**示例**
```
{
    "text": "hello world"
}
```
```
{
  "link": {
    "text": "hello world",
    "url": "http://xxxx.com"
  }
}
```
<!--
```
{
    "number": 123.321
}
```
```
{
    "time": {
      
    }
}
```
-->

|字段名 |数据类型 |描述 |
|:--|
|text |string |文本内容 |
|link |object([Link](#Link)) |超链接内容 |
<!--
|number |double |数值数据 |
|link |string |超链接内容，该字段为展示文本，可以不是链接的url |
|time |object([Time](#Time)) |时间 |
|location |object([Location](#Location)) |位置信息 |
|select |object([Select](#Select)) |单选\多选 |
-->

<!--### Time

**示例**
```
{
    "year": 2022,
    "month": 1,
    "day": 1,
    "hour": 0,
    "hour": 0,
    "second": 0
}
```
|字段名 |数据类型 |描述 |
|:--|
|year |uint32 |年份 |
|month |uint32 |月份 |
|day |uint32 |日期 |
|hour |uint32 |小时 |
|minute |uint32 |分钟 |
|second |uint32 |秒 |
-->

### CellFormat
单元格的样式信息

**示例**
<!--
```
{
  "borders": {},
  "padding": {},
  "horizontal_alignment": "HORIZONTAL_CENTER",
  "vertical_alignment": "TOP",
  "text_format": {}
}
```
-->
```
{
  "text_format": {}
}
```

|字段名 |数据类型 |描述 |
|:--|
|text_format |object([TextFormat](#TextFormat)) |文字样式 |
<!--
|borders |object([Borders](#Borders)) |边框样式 |
|padding |object([Padding](#Padding)) |内边距 |
|horizontal_alignment |string |水平对齐规则。枚举值参考[HorizontalAlignment](#HorizontalAlignment) |
|vertical_alignment |string |垂直对齐规则。枚举值参考[VerticalAlignment](#VerticalAlignment) |
-->

<!--### Borders
单元格的各边边框样式

**示例**
```
{
  "top": {},
  "bottom": {},
  "right": {},
  "left": {}
}
```

|字段名 |数据类型 |描述 |
|:--|
|top |object([Border](#Border)) |上边框样式，默认为无边框样式 |
|bottom |object([Border](#Border)) |下边框样式，默认为无边框样式 |
|right |object([Border](#Border)) |右边框样式，默认为无边框样式 |
|left |object([Border](#Border)) |左边框样式，默认为无边框样式 |
-->

<!--### Border
单元格边框样式

**示例**
```
{
  "style": 2,
  "width": 2,
  "color": {}
}
```

|字段名 |数据类型 |描述 |
|:--|
|style |uint32 |线条样式：<br> `0` : 默认无边线;<br> `1` : 无边线;<br> `2` : 点划线;<br> `3` : 虚线；<br> `4` : 实线。 |
|width |uint32 |线条粗细 |
|color |object([Color](#Color)) |颜色信息 |
-->

<!--### Padding
单元格内边距

**示例**
```
{
  "top": 2,
  "right": 2,
  "bottom": 2,
  "left": 2
}
```

|字段名 |数据类型 |描述 |
|:--|
|top |uint32 |上边距 |
|right |uint32 |右边距 |
|bottom |uint32 |下边距 |
|left |uint32 |左边距 |
-->

### TextFormat
文本样式信息

**示例**
```
{
  "font": "Courier New",
  "font_size": 14,
  "bold": false, 
  "italic": false,
  "strikethrough": false,
  "underline": false,
  "color": {}
}
```

|字段名 |数据类型 |描述 |
|:--|
|font |string |字体名称，表格支持的字体类型: [字体列表](#字体列表) |
|font_size |uint32 |字体大小，最大72 |
|bold |bool |字体加粗 |
|italic |bool |斜体 |
|strikethrough |bool|字体删除线 |
|underline |bool |下划线 |
|color |object([Color](#Color)) |字体颜色|

### Color
颜色信息，采用 `RGBA` 表示法

**示例**
```
{
  "red": 0,
  "green": 0,
  "blue": 255,
  "alpha": 255
}
```

|字段名 |数据类型 |描述 |
|:--|
|red |uint32 |红色，取值范围：[0,255] |
|green |uint32 |绿色，取值范围：[0,255] |
|blue |uint32 |蓝色，取值范围：[0,255] |
|alpha |uint32 |alpha通道，取值范围：[0,255]，默认值为255完全不透明 |

### Link
超链接的相关信息

**示例**
```
{
  "url": "https://xxxx",
  "text": "Website"
}
```

|字段名 |数据类型 |描述 |
|:--|
|url |string |链接url |
|text |string |链接标题 |

### Dimension 
声明维度属性为行或者列的字符串枚举值
|枚举值 |含义 |
|:--|
|ROW |行 |
|COLUMN |列 |

<!--### DataType
在线表格支持的数据类型的枚举值
|枚举值 |含义 |
|:--|
|DATA_TYPE_UNSPECIFIED |单元格未设置数据验证，没有指定类型 |
|SELECT |单选\多选 |
|EMAIL |电子邮箱 |
|PHONE |手机号 |
|TIME |时间日期 |
|IMAGE |图片 |
|TEXT |文本 |
|NUMBER |数字 |
|LINK |超链接 |
|LOCATION |地理位置 |
|STAR |评星 |
-->

<!--### Location
位置信息，包含经纬度和位置名

**示例**
```
{
 "name": "深圳市宝安人民医院",
 "latitude": "113.914503",
 "longitude": "22.561882",
 "source": "tencentmap",
 "uid": "6977409163354664674"
}
```

|字段名 |数据类型 |描述 |
|:--|
|longitude |string |经度 （正数：东经，负数：西经） |
|latitude |string |纬度 （正数：北纬，负数：南纬） |
|name |string |地理位置名 |
|uid |string |地理位置的uid标识 |
|source |string |地图软件供应商 |
-->

<!--### Select
单选或多选的单元格数据类型

**示例**
```
{
  "multiple": true,
  "value": [
    "ID1", 
    "ID2"
  ],
  "options": [
    {},
    {}
  ]
}
```

|字段名 |数据类型 |描述 |
|:--|
|multiple |bool |是否为多选类型 |
|value |string[] |单元格选择的选项的ID |
|options |object\[\]([Option](#Option)) |单元格选项 |
-->

<!--### Option
单元格选项

**示例**
```
{
  "id": "ID1",
  "text": "选项A",
  "color": {}
}
```
|字段名 |数据类型 |描述 |
|:--|
|id |string |选项的ID |
|text |string |选项的文本内容 |
|color |object([Color](#Color)) |选项的颜色 |
-->

<!--### HorizontalAlignment
水平对齐规则
| |
|:--|
|HORIZONTAL_ALIGNMENT_UNSPECIFIED |未设置，默认左对齐 |
|LEFT |左对齐 |
|HORIZONTAL_CENTER |居中对齐 |
|RIGHT |右对齐 |
-->

<!--### VerticalAlignment
垂直对齐规则

|枚举值 |含义 |
|:--|
|VERTICAL_ALIGNMENT_UNSPECIFIED |未设置，默认居中对齐 |
|TOP |顶部对齐 |
|VERTICAL_CENTER |居中对齐 |
|BOTTOM |底部对齐 |
-->

## 其他
### A1表示法
`A1 表示法` 是比较常见的范围表格数据引用的表示方法，可以表示一个左上角坐标到右下角坐标之间的连续区域。示例：

|表达式 |含义 |
|:--|
|`A1:A1` |表示一个单元格 `A1` |
|`A1:B5` |从单元格 `A1` 到单元格 `B5` 的区域 |
|`A1:D1` |第一行的4个单元格，分别为 `A1` 、 `B1` 、 `C1` 、 `D1` |
|`A1:A3` |第一列的3个单元格，分别为 `A1` 、 `A2` 、 `A3` |
|`B5:A1` |不合法的表示，因为 `B5` 在 `A1` 的右下方。 |

### 字体列表
在线表格api支持开发者设置单元格内的字体，以下是可供选择的字体列表：

- Microsoft YaHei
- SimSun
- SimHei
- FangSong
- KaiTi
- DFKai-SB
- STFangsong
- STKaiti
- STSong
- NSimSun
- Microsoft JhengHei
- PMingLiU
- Arial
- Times New Roman
- Calibri
- Comic Sans MS
- Courier New
- Georgia
- Microsoft Uighur
- Impact
- Trebuchet MS
- Verdana
- Aharoni
- Andalus
- AngsanaUPC
- Angsana New
- Aparajita
- Arabic Typesetting
- Arial Black
- Arial Narrow
- Batang
- BatangChe
- Bookman Old Style
- Book Antiqua
- Bradley Hand ITC
- BrowalliaUPC
- Browallia New
- Cambria
- Cambria Math
- Candara
- Century
- Century Gothic
- Consolas
- Constantia
- Corbel
- CordiaUPC
- Cordia New
- DaunPenh
- David
- DilleniaUPC
- DokChampa
- Dotum
- DotumChe
- Ebrima
- Estrangelo Edessa
- EucrosiaUPC
- Euphemia
- Franklin Gothic
- Franklin Gothic Medium
- FrankRuehl
- FreesiaUPC
- Freestyle Script
- French Script MT
- Gabriola
- Gadugi
- Garamond
- Gisha
- Gulim
- GulimChe
- Gungsuh
- GungsuhChe
- Haettenschweiler
- IrisUPC
- Iskoola Pota
- JasmineUPC
- Juice ITC
- Kalinga
- Kartika
- Khmer UI
- KodchiangUPC
- Kokila
- Kristen ITC
- Lao UI
- Latha
- Leelawadee
- Levenim MT
- LilyUPC
- Lucida Console
- Lucida Handwriting
- Lucida Sans Unicode
- Malgun Gothic
- Mangal
- Marlett
- Meiryo
- Meiryo UI
- Microsoft Himalaya
- Microsoft JhengHei UI
- Microsoft JhengHei UI Light
- Microsoft New Tai Lue
- Microsoft PhagsPa
- Microsoft Sans Serif
- Microsoft Tai Le
- Microsoft YaHei UI
- Microsoft YaHei UI Light
- Microsoft Yi Baiti
- MingLiU-ExtB
- MingLiU_HKSCS-ExtB
- MingLiU_HKSCS
- Miriam
- Miriam Fixed
- Mistral
- Mongolian Baiti
- Monotype.com
- Monotype Corsiva
- MoolBoran
- MS Gothic
- MS Mincho
- MS Outlook
- MS PGothic
- MS PMincho
- MS UI Gothic
- MT Extra
- MV Boli
- Narkisim
- Nirmala UI
- Nyala
- Palatino Linotype
- Papyrus
- Plantagenet Cherokee
- PMingLiU-ExtB
- Pristina
- Raavi
- Rod
- Sakkal Majalla
- Segoe Print
- Segoe Script
- Segoe UI Symbol
- Shonar Bangla
- Shruti
- Simplified Arabic Fixed
- Sylfaen
- Symbol
- Tahoma
- Tempus Sans ITC
- Traditional Arabic
- Tunga
- Utsaah
- Vani
- Vijaya
- Vrinda
- Webdings
- Wingdings
