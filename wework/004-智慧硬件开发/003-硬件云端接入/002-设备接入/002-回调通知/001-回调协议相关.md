---
title: "回调协议相关"
doc_id: 40739
category_id: 96062
source_url: https://developer.work.weixin.qq.com/document/path/96062
---
最后更新：2023/06/09

云对接硬件设备回调采用json格式进行回调。
# 一、服务商通用地址回调
## 1.1接收消息请求格式
对于服务商通用地址的回调，最外层数据包格式为：
```
{
 "tousername":"corpid",
 "encrypt":"xxxxx"
}
```
**参数说明：**
 
| 参数名 | 类型 | 描述 |
| ------ | ------ | ---------------- |
| tousername | string | 用于表示本消息对应的接受者，内容为设备的厂商corpid |
| encrypt | string | 回调消息加密体，厂商可用官方提供的json回调加解密库进行解密得到明文消息 |

> 注意：使用加解密库，sReceiveId 为 服务商的corpid
> WXBizJsonMsgCrypt wxcpt(sToken,sEncodingAESKey,sReceiveId);

## 1.2被动响应包数据格式
服务商接受回调后，若要返回数据包，其加密json格式如下：

```
{
  "encrypt": "msg_encrypt",
  "msgsignature": "msg_signature",
  "timestamp": "timestamp",
  "nonce": "nonce"
}
```
**参数说明**

|参数 |是否必须|类型 |说明 |
|:--|
|encrypt |是 |string|经过加密的消息结构体 |
|msgsignature |是|string |消息签名 |
|timestamp |是 |string |时间戳 |
|nonce |是 |string|随机数，由企业自行生成 |

> 注意：使用加解密库，sReceiveId 为 服务商的corpid
> WXBizJsonMsgCrypt wxcpt(sToken,sEncodingAESKey,sReceiveId);

# 二、设备型号地址回调
对于硬件型号地址的回调，最外层数据包格式为：

```
{
 "tousername":"model_id",
 "encrypt":"xxxxx"
}
```

**参数说明：**
 
| 参数名 | 类型 | 描述 |
| ------ | ------ | ---------------- |
| tousername | string | 用于表示本消息对应的接受者，内容为设备型号的model_id |
| encrypt | string | 回调消息加密体，厂商可用官方提供的json回调加解密库进行解密得到明文消息 |

> 注意：使用加解密库，sReceiveId 为 硬件型号的 model_id
> WXBizJsonMsgCrypt wxcpt(sToken,sEncodingAESKey,sReceiveId);
