---
title: "全量拉取通讯录流程"
doc_id: 15398
category_id: 94003
source_url: https://developer.work.weixin.qq.com/document/path/15398
---
- ![](https://wework.qpic.cn/wwpic/101644_90ltUFs9RoOZR9Y_1590721272/0)

分页拉取通讯录的过程中，云端会在每次请求结果中带上当前版本号perm_version，考勤机需要判断perm_version是否发生了变化。
如果发生了变化则表示通讯录分页情况可能发生了变化，必须放弃全部数据，重置offset后重新拉取数据。
当拉取完所有数据后，考勤机可以记录下perm_version，下次机器重启时可以避免全量重拉数据。

针对全量、增量两个协议，请求包添加是否请求数据列表字段
"is_req_fp_info":1, //0:fp只返回ver, 1:才会完整返回fp数据列表
"is_req_fa_info":1 //0:fa只返回ver, 1:才会完整返回fa数据列表
回包添加 
"fp_ver":1, //指纹版本号
"fa_ver":1, //人脸版本号
为了解决一次全拉导致回包太大的问题，第一次通过全量接口is_req_xx_info填0先把列表拉下去，比对本版号看哪些用户有更新，然后通过增量接口只拉取有更新的用户数据。
