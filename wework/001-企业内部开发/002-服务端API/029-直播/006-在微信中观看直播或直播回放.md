---
title: "在微信中观看直播或直播回放"
doc_id: 26465
category_id: 93641
source_url: https://developer.work.weixin.qq.com/document/path/26465
---
[TOC]

通过微信观看直播的凭证，可在微信中H5或小程序页面唤起企业微信直播小程序，并进入对应直播或直播回放。

##获取微信观看直播凭证
**请求方式：** POST（**HTTPS**）
**请求地址：** https://qyapi.weixin.qq.com/cgi-bin/living/get_living_code?access_token=ACCESS_TOKEN

**请求包体：**

```json
{
 "livingid": "XXXXXXXXX",
 "openid": "abcopenid"
}
```

**参数说明：**

| 参数 | 必须 | 说明 |
| ------------ | ---- | ---------------------------------------------------------------------------------------------------- |
| access_token | 是 | 调用接口凭证。获取方法查看“[获取access_token](https://work.weixin.qq.com/api/doc/90001/90143/90605)” |
| livingid | 是 | 直播id|
| openid | 是 | 微信用户的openid|

**权限说明：**
| 应用类型 | 权限要求 |
| -------- | ---- | 
|自建应用|配置到「!!#ff0000 上课直播/直播 - 可调用接口的应用!!」中 |
|代开发应用|具有「直播」权限| 
|第三方应用|具有「直播」权限|
- 仅允许获取当前应用创建的微信观看直播凭证。

*注：* 从2023年12月1日0点起，不再支持通过系统应用secret调用接口，存量企业暂不受影响 [查看详情](https://developer.work.weixin.qq.com/document/51165)

**返回结果：**

```
{
 "errcode": 0,
 "errmsg": "ok",
 "living_code": "abcdef"
}
```

**参数说明：**

| 参数 | 说明 |
| ---------- | ---------------------- |
| errcode | 返回码 |
| errmsg | 对返回码的文本描述内容 |
| living_code | 微信观看直播凭证，5分钟内可以重复使用，且仅能在微信上使用。开发者获取到该凭证后可以在微信H5页面或小程序进入直播或直播回放页 |

##微信H5页面进入直播间
获取到直播living_code之后，在微信H5页面里可使用微信开放标签<wx-open-launch-weapp>（<a href="https://developers.weixin.qq.com/doc/offiaccount/OA_Web_Apps/Wechat_Open_Tag.html" target=_blank>点击查看更详细的调用方法</a>），唤起直播小程序，进入直播或直播回放页。

**开放标签参数**

| 参数 | 必须 | 说明 |
| ------------ | ---- | ---------------------------------------------------------------------------------------------------- |
| username | 是 | 固定填企业微信直播小程序原始id: gh_25e071b83ee0 |
| path | 是 | 跳转到直播小程序的路径，支持两种路径如下： <br/> (1) 跳到直播间，固定为：pages/watch/index?living_code=LIVING_CODE，<br/> (2) 跳到回放页，固定为：pages/watch/index?living_code=LIVING_CODE&replay=1, <br/>其中LIVING_CODE为上文中“获取微信观看直播凭证”接口所获取|

**调用示例**
```
<wx-open-launch-weapp
 id="launch-btn"
 username="gh_25e071b83ee0"
 path="pages/watch/index?living_code=LIVING_CODE">
 <template>
 
 <button class="btn">进入直播间</button>
 </template>
</wx-open-launch-weapp>
<script>
 var btn = document.getElementById('launch-btn');
 btn.addEventListener('launch', function (e) {
 console.log('success');
 });
 btn.addEventListener('error', function (e) {
 console.log('fail', e.detail);
 });
</script>
```

##微信小程序进入直播间
获取到直播living_code之后，在微信小程序里可调用小程序接口wx.navigateToMiniProgram（<a href="https://developers.weixin.qq.com/miniprogram/dev/api/navigate/wx.navigateToMiniProgram.html" target=_blank>点击查看更详细的调用方法</a>），唤起直播小程序，进入直播或直播回放页。

**请求参数**

| 参数 | 必须 | 说明 |
| ------------ | ---- | ---------------------------------------------------------------------------------------------------- |
| appId | 是 | 固定填企业微信直播小程序appid: wx7424030d69bde86e |
| path | 是 | 跳转到直播小程序的路径，支持两种路径如下： <br/> (1) 跳到直播间，固定为：pages/watch/index?living_code=LIVING_CODE，<br/> (2) 跳到回放页，固定为：pages/watch/index?living_code=LIVING_CODE&replay=1, <br/>其中LIVING_CODE为上文中“获取微信观看直播凭证”接口所获取|

**调用示例**
```
wx.navigateToMiniProgram({
 appId: 'wx7424030d69bde86e',
 path: 'pages/watch/index?living_code=LIVING_CODE',
 success(res) {
 // 打开成功
 }
})
```
