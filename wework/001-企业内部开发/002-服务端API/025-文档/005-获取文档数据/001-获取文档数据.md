---
title: "获取文档数据"
doc_id: 44378
category_id: 97659
source_url: https://developer.work.weixin.qq.com/document/path/44378
---
[TOC]
## 获取文档数据
该接口用于获取文档数据

**请求方式**：POST（**HTTPS**）
**请求地址**: https://qyapi.weixin.qq.com/cgi-bin/wedoc/document/get?access_token=ACCESS_TOKEN 

**请求包体**

```json
{
  "docid": "DOCID"
}
```

**参数说明**

| 参数 | 类型 | 是否必须 | 说明 |
|------------|--------|------|----------------------------|
| docid | string | 是 | 文档的docid|

**权限说明**
- 自建应用需配置到“[可调用应用](#43883)”列表中的应用secret所获取的accesstoken来调用（[accesstoken如何获取？](#10013/第三步：获取access_token)）
- 第三方应用需具有“文档”权限
- 代开发自建应用需具有“文档”权限

**返回示例**

```json
{
  "errcode": 0,
  "errmsg": "ok",
  "version": 10,
  "document": {
    ...
  }
}
```

**参数说明**

| 参数 |类型| 说明 |
|---------|-------|-------|
| errcode |int32| 错误码 |
| errmsg |string| 错误码说明 |
|version| uint32| 文档版本|
|document| object([Node](#node))| 文档内容根节点，详见[Node](#node)|

## 参数详细说明
由于返回结果比较复杂，在本节分Object分别说明

### Node
构成文档内容的节点

**示例**
```
{
  "begin": 0,
  "end": 20,
  "property": {
    ...
  },
  "type": "Document",
  "children": [
    ...
  ],
  "text": "text content"
}
```
**字段说明**
|字段|类型|说明|
|-|-|-|
|begin|uint32|起始位置|
|end|uint32|结束位置|
|property| object([Property](#property))|该节点的属性|
|type|string|节点类型，详见[Type](#type)|
|children| object([Node](#node))| 子节点|
|text| string| 文本内容，当节点类型为 Text 时有效|

### Type
Node类型的枚举值描述

**示例**
```
{
  "type": "Document"
}
```

**字段说明**
|枚举值 |描述 |
|-|-|
|Document |Doc 文档 |
|MainStory |文档主节点，文档主体内容 |
|Section |节 |
|Paragraph |段落 |
|Table |表格 |
|TableRow |表格行 |
|TableCell |表格单元格 |
|Text |一个具有相同属性集合的文本容器 |
|Drawing |图形化对象 , 例如图表、图片等 |

### Property
节点属性

**示例**
```
{
  "section_property": {...},
  "paragraph_property": {...},
  "run_property": {...},
  "table_property": {...},
  "table_row_property": {...},
  "table_cell_property": {...},
  "drawing_property": {...}
}
```
**字段说明**
|字段|类型|说明|
|-|-|-|
|section_property |object([SectionProperty](#sectionproperty)) |section 属性 |
|paragraph_property | object([ParagraphProperty](#paragraphproperty) |段落属性 |
|run_property |object([RunProperty](#runproperty)) |文本属性 |
|table_property |object([TableProperty](#tableproperty)) |表格属性 |
|table_row_property |object([TableRowProperty](#tablerowproperty))|表格行属性 |
|table_cell_property |object([TableCellProperty](#tablecellproperty)) |表格单元属性 
|drawing_property |object([DrawingProperty](#drawingproperty)) |drawing 属性 |

### SectionProperty 

**示例**
```
{
 "page_size": {...},
 "page_margins": {...}
}
```
**字段说明**
|字段|类型|说明|
|-|-|-|
|page_size |object([PageSize](#pagesize)) |页面尺寸 |
|page_margins |object([PageMargins](#pagemargins)) |页边距 |

### PageSize
用于描述页面的大小

**示例**
```
{
 "width": 10,
 "height": 10,
 "orientation": {...}
}
```

**字段说明**
|字段|类型|说明|
|-|-|-|
|width |double |页面宽度 |
|height |double |页面高度 |
|orientation | object([PageOrientation](#pageorientation)) |页面方向 |

### PageOrientation
**示例**
```
{
 "width": 10,
 "height": 10,
 "orientation": {...}
}
```

**字段说明**
|字段|类型|说明|
|-|-|-|
|width |double |页面宽度 |
|height |double |页面高度 |
|orientation | string |页面方向，详见[PageOrientation](#pageorientation)|

### PageOrientation
页面方向

**示例**
```
{
  "orientation": "PAGE_ORIENTATION_PORTRAIT"
}
```

**字段说明**
|枚举值 |描述 |
|-|-|
|PAGE_ORIENTATION_UNSPECIFIED |未知 |
|PAGE_ORIENTATION_PORTRAIT |纵向 |
|PAGE_ORIENTATION_LANDSCAPE |横向 |

### PageMargins
页边距，指定了一个 Section 中所有页面的页边距属性

**示例**
```
{
 "top": 10,
 "right": 10,
 "bottom": 10,
 "left": 10
}
```

**字段说明**
|字段|类型|说明|
|-|-|-|
|top |double |上边距 |
|right |double |右边距 |
|bottom |double |下边距 |
|left |double |左边距 |

### ParagraphProperty 
段落属性

**示例**
```
{
 "number_property": {...},
 "spacing": {...},
 "indent": {...},
 "alignment_type": "ALIGNMENT_TYPE_CENTER",
 "text_direction": "TEXT_DIRECTION_RIGHT_TO_LEFT"
}
```

**字段说明**
|字段|类型|说明|
|-|-|-|
|number_property |object([NumberProperty](#numberproperty)) |段落的编号属性 | 
|spacing |object([Spacing](#spacing)) |段落间距 | 
|indent |object([Indent](#indent)) |段落缩进 | 
|alignment_type |string |文字水平方向的对齐类型, 详见[AlignmentType](#44153/alignmenttype)| 
|text_direction |string |文字方向，详见[TextDirection](#textdirection)|

### NumberProperty
段落的编号属性，描述该段落的项目符号、数字编号

**示例**
```
{
 "nesting_level": 1,
 "number_id": "2"
}
```
**字段说明**
|字段|类型|说明|
|-|-|-|
|nesting_level |uint32 |编号缩进层级 |
|number_id |string |编号 ID，一个列表中的每个段落编号 ID 相同 |

### Spacing
段落间距

**示例**
```
{
 "before": 10,
 "after":10,
 "line": 10,
 "line_rule": "LINE_SPACING_RULE_AUTO"
}
```

**字段说明**
|字段|类型|说明|
|-|-|-|
|before |double |段后间距，单位是像素（px） |
|after |double |段前间距，单位是像素（px） |
|line |double |行间距数值，单位是像素（px） |
|line_rule |[LineSpacingRule](#linespacingrule) |行间距格式 |

### LineSpacingRule
行间距规则

**示例**
```
{
  "line_rule": "LINE_SPACING_RULE_AUTO"
}
```

**字段说明**
|枚举值 |描述 |
|-|-|
|PAGE_ORIENTATION_UNSPECIFIED |未知 |
|LINE_SPACING_RULE_AUTO |自动 |
|LINE_SPACING_RULE_EXACT |精确值 |
|LINE_SPACING_RULE_AT_LEAST |最小行间距 |

### Indent 
段落缩进

**示例**
```
{
 "left": 10,
 "left_chars": 10,
 "right": 10,
 "right_chars": 10,
 "hanging": 10,
 "hanging_chars":10,
 "first_line": 10,
 "first_line_chars": 10,
}
```

**字段说明**
|字段|类型|说明|
|-|-|-|
|left |double |缩进左侧，单位是像素（px） |
|left_chars |uint32 |缩进左侧字符数，单位 1/20 字符宽度 |
|right |double |缩进右侧，单位是像素（px） |
|right_chars |uint32 |缩进右侧字符数，单位 1/20 字符宽度 |
|hanging |double |垂直悬挂，单位是像素（px） |
|hanging_chars |uint32 |垂直悬挂字符数，单位 1/20 字符宽度 |
|first_line |double |首行缩进，单位是像素（px） |
|first_line_chars |uint32 |首行缩进字符数，单位 1/20 字符宽度 |

### AlignmentType
水平方向对齐类型

**示例**
```
{
  "alignment_type": "ALIGNMENT_TYPE_CENTER"
}
```

**字段说明**
|枚举值 |描述 |
|-|-|
|ALIGNMENT_TYPE_UNSPECIFIED |未知 |
|ALIGNMENT_TYPE_CENTER |指定文本应以文档中两个文本边距之间的中线为中心 |
|ALIGNMENT_TYPE_BOTH |指定文本应在文档的两个文本边距之间对齐 |
|ALIGNMENT_TYPE_DISTRIBUTE |指定文本应在文档的两个文本边距之间对齐，这种对齐方式会增加一行中每个字符中间的距离 |
|ALIGNMENT_TYPE_LEFT |指定文本对齐文档的左边距 |
|ALIGNMENT_TYPE_RIGHT |指定文本对齐文档的右边距 |

### TextDirection
文字方向类型枚举
**示例**
```
{
  "text_direction": "TEXT_DIRECTION_RIGHT_TO_LEFT"
}
```

**字段说明**
|枚举值 |描述 |
|-|-|
|TEXT_DIRECTION_UNSPECIFIED |未知 |
|TEXT_DIRECTION_RIGHT_TO_LEFT |从右至左 |
|TEXT_DIRECTION_LEFT_TO_RIGHT |从左至右 |

### RunProperty
text 的属性

**示例**
```
{
 "font": "",
 "bold": false,
 "italics": false, 
 "underline": false,
 "strike": false,
 "color": "0000FF",
 "spacing": 10, 
 "size": 10,
 "shading": {...},
 "vertical_align": "RUN_VERTICAL_ALIGN_BASELINE",
 "is_placeholder": false
}
```

**字段说明**
|字段|类型|说明|
|-|-|-|
|font |string |字体 |
|bold |bool |文字是否加粗 |
|italics |bool |文字是否斜体表示 |
|underline |bool |文字是否下划线 |
|strike |bool |文字是否被删除线贯穿 |
|color |string |文字的颜色，颜色使用十六进制，RRGGBB格式 |
|spacing |double |字符的间距 |
|size |double |文字的大小，单位是半个点（half-points），即 1/144 英寸 |
|shading |object([Shading](#shading)) |文字阴影 |
|vertical_align |string |垂直对齐类型，指出当前字符串是否是上标、下标，详见[TextVerticalAlign](#textverticalalign) |
|is_placeholder |bool |本节点是否占位符 |

### Shading
阴影

**示例**
```
{
 "foreground_color": "FFFFFF",
 "background_color": "000000"
}
```

**字段说明**
|字段|类型|说明|
|-|-|-|
|foreground_color |string |前景色，颜色使用十六进制RRGGBB 格式 |
|background_color |string |背景色，颜色使用十六进制 RRGGBB格式 |

### TextVerticalAlign
竖直对齐类型枚举
**示例**
```
{
  "vertical_align": "RUN_VERTICAL_ALIGN_BASELINE"
}
```

**字段说明**
|枚举值 |描述 |
|-|-|
|RUN_VERTICAL_ALIGN_UNSPECIFIED |0 |未知 |
|RUN_VERTICAL_ALIGN_BASELINE |1 |对齐基线 |
|RUN_VERTICAL_ALIGN_SUPER_SCRIPT |2 |上标 |
|RUN_VERTICAL_ALIGN_SUB_SCRIPT |3 |下标 |

### TableProperty
表格属性，指定了一组表格宽度的属性。这个属性对所有的表格行和表格单元都会生效，但是可以被表格行和表格单元的属性覆盖。

**示例**
```
{
 "table_width": {...},
 "horizontal_alignment_type": "TABLE_HORIZONTAL_ALIGNMENT_TYPE_CENTER",
 "table_layout": "TABLE_LAYOUT_TYPE_FIXED"
}
```

**字段说明**
|字段|类型|说明|
|-|-|-|
|table_width |object([TableWidth](#tablewidth)) |表格宽度，指定该表的首选宽度，单位是像素（px） |
|horizontal_alignment_type |string |表格的水平对齐的方式，详见[TableHorizontalAlignmentType](#tablehorizontalalignmenttype) |
|table_layout |string|表格布局，详见[TableLayoutType](#tablelayouttype) |

### TableWidth
表格宽度，指定该表的首选宽度。

**示例**
```
{
 "width": 20,
 "type": "TABLE_LAYOUT_TYPE_FIXED"
}
```

**字段说明**
|字段|类型|说明|
|-|-|-|
|width |double |表格宽度，单位是像素（px） |
|type | string|表格宽度类型，详见[TableWidthType](#tablewidthtype)|

### TableHorizontalAlignmentType
表格的水平对齐的方式

**示例**
```
{
  "horizontal_alignment_type": "TABLE_HORIZONTAL_ALIGNMENT_TYPE_CENTER"
}
```

**字段说明**
|枚举值 |描述 |
|-|-|
|TABLE_HORIZONTAL_ALIGNMENT_TYPE_UNSPECIFIED |未知 |
|TABLE_HORIZONTAL_ALIGNMENT_TYPE_CENTER |指定当前表格位于一行的中间位置 |
|TABLE_HORIZONTAL_ALIGNMENT_TYPE_LEFT |与文字边缘的左侧对齐 |
|TABLE_HORIZONTAL_ALIGNMENT_TYPE_START |与文字边缘的右侧对齐 |

### TableLayoutType
表格布局类型枚举

**示例**
```
{
  "table_layout": "TABLE_LAYOUT_TYPE_FIXED"
}
```

**字段说明**
|枚举值 |描述 |
|-|-|
|TABLE_LAYOUT_TYPE_UNSPECIFIED |未知 |
|TABLE_LAYOUT_TYPE_FIXED |固定宽度 |
|TABLE_LAYOUT_TYPE_AUTO_FIT |自适应布局 |

### TableWidthType
表格宽度类型

**示例**
```
{
  "type": "TABLE_LAYOUT_TYPE_FIXED"
}
```

**字段说明**
|枚举值 |描述 |
|-|-|
|TABLE_LAYOUT_TYPE_UNSPECIFIED |0 |未知 |
|TABLE_LAYOUT_TYPE_FIXED |1 |固定宽度 |
|TABLE_LAYOUT_TYPE_AUTO_FIT |2 |自适应布局 |

### TableRowProperty
表格行属性

**示例**
```
{
 "is_header": false
}
```

**字段说明**
|字段|类型|说明|
|-|-|-|
|is_header |bool |本行是否是表头 |

### TableCellProperty
表格单元属性

**示例**
```
{
 "table_cell_borders": {...},
 "vertical_alignment": "VERTICAL_ALIGNMENT_TOP"
}
```

**字段说明**
|字段|类型|说明|
|-|-|-|
|table_cell_borders | object([Borders](#borders)) |边界属性 |
|vertical_alignment |string |垂直方向对齐属性，详见[VerticalAlignment](#44153/verticalalignment)|

### Borders
表格单元的边界属性

**示例**
```
{
 "top": {...},
 "left": {...},
 "bottom": {...},
 "right": {...}
}
```

**字段说明**
|字段|类型|说明|
|-|-|-|
|top |object([BorderProperty](#borderproperty)) |上边界 |
|left |object([BorderProperty](#borderproperty)) |左边界 |
|bottom |object([BorderProperty](#borderproperty)) |底部边界 |
|right |object([BorderProperty](#borderproperty)) |右边界 |

### BorderProperty 
边界属性

**示例**
```
{
 "color" : "000000",
 "width" : 3
}
```

**字段说明**
|字段|类型|说明|
|-|-|-|
|color |string |边界颜色，颜色使用十六进制RRGGBB格式 |
|width |uint32 |边界的宽度，单位是像素（px） |

### VerticalAlignment
垂直方向对齐属性

**示例**
```
{
 "vertical_alignment": "VERTICAL_ALIGNMENT_TOP"
}
```

**字段说明**
|枚举值 |描述 |
|-|-|
|VERTICAL_ALIGNMENT__UNSPECIFIED |未知 |
|VERTICAL_ALIGNMENT_TOP |对齐顶部 |
|VERTICAL_ALIGNMENT_CENTER |居中对齐 |
|VERTICAL_ALIGNMENT_BOTH |自适应对齐 |
|VERTICAL_ALIGNMENT_BOTTOM |对齐底部 |

### DrawingProperty

**示例**
```
{
 "inline_keyword": {...},
 "anchor": {...},
 "is_placeholder": false
}
```
**字段说明**
|字段|类型|说明|
|-|-|-|
|inline_keyword |object([Inline](#inline)) |Drawing 类型中的实体，如一张图片 |
|anchor |object([Anchor](#anchor)) |Drawing 类型中的悬浮实体，如一张图片 |
|is_placeholder |bool |此处是否为占位符 |

### Inline
Drawing 类型中的实体，如一张图片

**示例**
```
{
 "picture": {...},
 "addon": {...}
}
```
**字段说明**
|字段|类型|说明|
|-|-|-|
|picture |object([InlinePicture](#inlinepicture)) |图片内容 |
|addon |object([InlineAddon](#inlineaddon)) |插件信息 |

### InlinePicture

**示例**
```
{
 "uri": "https://xxxxxxx",
 "relative_rect": {...},
 "shape": {...}
}
```
**字段说明**
|字段|类型|说明|
|-|-|-|
|relative_rect |object([RelativeRect](#relativerect)) |裁剪范围 |
|shape |object([ShapeProperties](#shapeproperties)) |形状属性 |

### RelativeRect

**示例**
```
{
 "left": 75000,
 "top": 75000,
 "right": 75000,
 "bottom": 75000
}
```

**字段说明**
|字段|类型|说明|
|-|-|-|
|left |uint32 |距左侧的距离，单位系数是 0.1%（例如：75000 代表 75%） |
|top |uint32 |距顶部的距离，单位系数是 0.1%（例如：75000 代表 75%） |
|right |uint32 |距右侧的距离，单位系数是 0.1%（例如：75000 代表 75%） |
|bottom |uint32 |距底部的距离，单位系数是 0.1%（例如：75000 代表 75% |

### ShapeProperties

**示例**
```
{
 "transform": {...}
}
```

**字段说明**
|字段|类型|说明|
|-|-|-|
|transform |object([Transform2D](#transform2d)) |图片变换，图片在文本中的裁剪和旋转信息 |

### Transform2D

**示例**
```
{
 "extent":{
 "cx": 100,
 "cy": 100
 },
 "rotation": 600000
}
```

**字段说明**
|字段|类型|说明|
|-|-|-|
|extent |object([PositiveSize2D](#positivesize2d)) |边框，单位是像素（px） |
|rotation |int32 |旋转角度，单位 1/60000 度。正数代表顺时针旋转，负数代表逆时针旋转 |

### PositiveSize2D

**示例**
```
{
 "cx": 100,
 "cy": 100
}
```

**字段说明**
|字段|类型|说明|
|-|-|-|
|cx |integer |图片宽，单位是像素（px） |
|cy |integer |图片高，单位是像素（px） |

### InlineAddon

**示例**
```
{
 "addon_id": "ADDON_ID",
 "addon_source": "ADDON_SOURCE_TYPE_NONE"
}
```

**字段说明**
|字段|类型|说明|
|-|-|-|
|addon_id |string |插件 ID |
|addon_source | string|插件来源，详见[AddonSourceType](#addonsourcetype) |

### AddonSourceType

**示例**
```
{
 "addon_source": "ADDON_SOURCE_TYPE_NONE"
}
```
**字段说明**
|枚举值 |描述 |
|-|-|
|ADDON_SOURCE_TYPE_UNSPECIFIED |0 |未知 |
|ADDON_SOURCE_TYPE_NONE |1 |无 |
|ADDON_SOURCE_TYPE_LATEX |2 |公式 |
|ADDON_SOURCE_TYPE_SIGN |3 |签名 |
|ADDON_SOURCE_TYPE_SIGN_BAR |4 |签名占位图 |

### Anchor
Drawing 类型中浮动的实体，如一张图片

**示例**
```
{
 "picture": {...},
}
```
**字段说明**
|字段|类型|说明|
|-|-|-|
|picture |object([AnchorPicture](#anchorpicture)) |图片内容 |

### AnchorPicture

**示例**
```
{
 "uri": "https://xxxxx",
 "relative_rect": {...},
 "shape": {...},
 "position_horizontal": {...},
 "position_vertical": {...},
 "wrap_none": false,
 "wrap_square": false,
 "wrap_top_and_bottom": false,
 "behind_doc": false, 
 "allow_overlap": false
}
```
**字段说明**
|字段|类型|说明|
|-|-|-|
|relative_rect |object([RelativeRect](#relativerect)) |裁剪范围 |
|shape |object([ShapeProperties](#shapeproperties)) |形状属性 |
|position_horizontal |object([PositionHorizontal](#positionhorizontal)) |水平位置 |
|position_vertical |object([PositionVertical](#positionvertical)) |竖直位置 |
|wrap_none |bool |非文字包围 |
|wrap_square |object([WrapSquare](#wrapsquare)) |四周型环绕 |
|wrap_top_and_bottom |bool |上下型环绕 |
|behind_doc |bool |衬于文字下方 |
|allow_overlap |bool |允许重叠 |

### PositionHorizontal

**示例**
```
{
 "pos_offset": 10,
 "relative_from": "RELATIVE_FROM_HORIZONTAL_MARGIN"
}
```
**字段说明**
|字段|类型|说明|
|-|-|-|
|pos_offset |int32 |位置偏移 |
|relative_from |string|相对位置类型，详见[RelativeFromHorizontal](#relativefromhorizontal) |

### RelativeFromHorizontal
**示例**
```
{
 "relative_from": "RELATIVE_FROM_HORIZONTAL_MARGIN"
}
```
**字段说明**
|枚举值 |描述 |
|-|-|
|RELATIVE_FROM_HORIZONTAL_UNSPECIFIED |未知 |
|RELATIVE_FROM_HORIZONTAL_MARGIN |边缘 |
|RELATIVE_FROM_HORIZONTAL_PAGE |页 |
|RELATIVE_FROM_HORIZONTAL_COLUMN |列 |
|RELATIVE_FROM_HORIZONTAL_CHARACTER |字符 |
|RELATIVE_FROM_HORIZONTAL_LEFT_MARGIN |左边缘 |
|RELATIVE_FROM_HORIZONTAL_RIGHT_MARGIN |右边缘 |
|RELATIVE_FROM_HORIZONTAL_INSIDE_MARGIN |内部边缘 |
|RELATIVE_FROM_HORIZONTAL_OUTSIDE_MARGIN |外部边缘 |

### PositionVertical

**示例**
```
{
 "pos_offset": 10,
 "relative_from": "RELATIVE_FROM_VERTICAL_MARGIN"
}
```
**字段说明**
|字段|类型|说明|
|-|-|-|
|pos_offset |int32 |位置偏移 |
|relative_from |string|相对位置类型，详见[RelativeFromVertical](#relativefromvertical) |

### RelativeFromVertical

**示例**
```
{
 "relative_from": "RELATIVE_FROM_VERTICAL_MARGIN"
}
```

**字段说明**
|枚举值 |描述 |
|-|-|
|RELATIVE_FROM_VERTICAL_UNSPECIFIED |未知 |
|RELATIVE_FROM_VERTICAL_MARGIN |边缘 |
|RELATIVE_FROM_VERTICAL_PAGE |页 |
|RELATIVE_FROM_VERTICAL_PARAGRAPH |段 |
|RELATIVE_FROM_VERTICAL_LINE |线 |
|RELATIVE_FROM_VERTICAL_TOP_MARGIN |顶端边缘 |
|RELATIVE_FROM_VERTICAL_BOTTOM_MARGIN |底部边缘 |
|RELATIVE_FROM_VERTICAL_INSIDE_MARGIN |内部边缘 |
|RELATIVE_FROM_VERTICAL_OUTSIDE_MARGIN |外部边缘 |

### WrapSquare

**示例**
```
{
 "wrap_text": "WRAP_TEXT_BOTH_SIDES"
}
```
| |
|:--|
|wrap_text |string |四周环绕文字类型，详见[WrapText](#wraptext) |

### WrapText

**示例**
```
{
 "wrap_text": "WRAP_TEXT_BOTH_SIDES"
}
```
**字段说明**
|枚举值 |描述 |
|-|-|
|WRAP_TEXT_BOTH_UNSPECIFIED |未知 |
|WRAP_TEXT_BOTH_SIDES |两边 |
|WRAP_TEXT_LEFT |左边 |
|WRAP_TEXT_RIGHT |右边 |
|WRAP_TEXT_LARGEST |最大 |
