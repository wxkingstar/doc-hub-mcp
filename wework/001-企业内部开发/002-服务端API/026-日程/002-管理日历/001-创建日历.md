---
title: "创建日历"
doc_id: 26902
category_id: 93647
source_url: https://developer.work.weixin.qq.com/document/path/26902
---
该接口用于通过应用在企业内创建一个日历。

**请求方式：** POST（**HTTPS**）
**请求地址：** https://qyapi.weixin.qq.com/cgi-bin/oa/calendar/add?access_token=ACCESS_TOKEN

**请求包体：**

```
{
  "calendar": {
    "admins":[
        "admin1",
        "admin2"
    ],
    "set_as_default": 1,
    "summary": "test_summary",
    "color": "#FF3030",
    "description": "test_describe",
    "shares": [{
        "userid": "userid2",
        "permission": 1
      },
      {
        "userid": "userid3",
        "permission": 3
      }
    ],
    "is_public": 1,
    "public_range": {
      "userids": ["abel", "jack"],
      "partyids": [1232, 34353]
    },
    "is_corp_calendar": 1
  },
  "agentid": 1000014
}
```

**参数说明：** 

| 参数 | 是否必须 | 说明 |
| ---------- | -------- | -------------------------------- |
|calendar| 是 | 日历信息 
|admins|否|日历的管理员userid列表，管理员必须在通知范围成员的列表中。最多指定3人|
|set_as_default| 否 | 是否将该日历设置为access_token所对应应用的默认日历。</br>0-否；1-是。默认为0，即不设为默认日历</br>**第三方应用不支持使用该参数** |
|summary| 是 | 日历标题。1 ~ 128 字符|
|color| 是 | 日历在终端上显示的颜色，RGB颜色编码16进制表示，例如："#0000FF" 表示纯蓝色|
|description| 否 | 日历描述。0 ~ 512 字符|
|is_public| 否 | 是否公共日历。0-否；1-是。注意：每个人最多可创建或订阅100个公共日历。该属性不可更新|
|public_range| 否| 公开范围。仅当是公共日历时有效 |
|public_range.userids| 否| 公开的成员列表范围 。最多指定1000个成员|
|public_range.partyids| 否| 公开的部门列表范围 。最多指定100个部门|
|is_corp_calendar| 否 | 是否全员日历。0-否；1-是。注意：</br>1. 每个企业最多可创建20个全员日历</br>2. 全员日历也是公共日历的一种，需要指定```public_range```</br>3. 全员日历不支持指定颜色、默认日历、只读权限</br>4. 该属性不可更新|
|shares| 否 | 日历通知范围成员列表。最多2000人|
|shares.userid| 是 | 日历通知范围成员的id|
|shares.permission| 否 | 日历通知范围成员权限（不填则默认为「可查看」）。<br>1：可查看 <br>3：仅查看闲忙状态|
|agentid|否|授权方安装的应用agentid。**仅旧的第三方多应用套件需要填此参数**|

**返回结果：** 

```
{ 
  "errcode": 0,
  "errmsg" : "ok",
  "cal_id":"wcjgewCwAAqeJcPI1d8Pwbjt7nttzAAA",
  "fail_result": {
    "shares":[{
      "errcode": 40001,
      "errmsg": "not found",
      "userid": "userid3"
    }]
  }
}
```

**参数说明：**

| 参数 | 说明 |
| ------------ | ----------------------------------------- |
| errcode | 错误码|
| errmsg | 错误码说明|
| cal_id | 日历ID|
|fail_result| 无效的输入内容|
|fail_result.shares| 无效的日历通知范围成员**列表**|
|shares.errcode| 错误码|
|shares.errmsg| 错误码说明|
|shares.userid| 日历通知范围成员的id|
