---
title: "自建应用与第三方应用的对接"
doc_id: 39558
category_id: 95884
source_url: https://developer.work.weixin.qq.com/document/path/95884
---
最后更新：2024/07/18

[TOC]

为更好地保护企业与用户的数据，企业微信不允许第三方应用获取企业的明文userid与external_userid。而企业的自建应用在一些场景下需要与第三方服务商的应用对接，为此，企业微信提供了自建应用的转换接口，支持将第三方应用获取的userid、external_userid转换为企业主体对应的ID。

<!--
corpid转换
将代开发应用或第三方应用获取到的open_corpid转换为明文corpid。
**请求方式：** POST（HTTPS）
**请求地址：** https://qyapi.weixin.qq.com/cgi-bin/corp/opencorpid_to_corpid?access_token=ACCESS_TOKEN
**请求参数：**
```
{
  "open_corpid":"aaaa",
  "source_agentid":100001
}
```
**参数说明：**
| 参数 | 必须 | 说明 |
| :----------- | :--- | :----------------- |
| access_token | 是 | 企业自建应用的调用接口凭证。获取方法查看“[获取access_token](#15074)” |
| open_corpid | 是 | 密文corpid，必须是source_agentid对应的应用所获取 |
|source_agentid|是|企业授权的代开发自建应用或第三方应用的agentid|

**权限说明：**
>需要使用自建应用的access_token

**返回结果：**
```
{
  "errcode":0,
  "errmsg":"ok",
  "corpid":"xxxx"
}
```
**参数说明：**
| 参数 | 说明 |
| :----------- | :----------------- |
| errcode | 返回码 |
| errmsg | 对返回码的文本描述内容 |
| corpid |明文corpid|
-->

## userid转换
将代开发应用或第三方应用获取的密文open_userid转换为明文userid。
**请求方式：**POST（**HTTPS**）
**请求地址**：https://qyapi.weixin.qq.com/cgi-bin/batch/openuserid_to_userid?access_token=ACCESS_TOKEN

**请求参数：**
```
{
 "open_userid_list":["xxx", "yyy"],
 "source_agentid":100001
}
```

**参数说明：**

| 参数 | 必须 | 说明 |
| :----------- | :--- | :----------------- |
| access_token | 是 | 企业自建应用的调用接口凭证。获取方法查看“[获取access_token](#15074)” |
| open_userid_list | 是 | open_userid列表，最多不超过1000个。必须是source_agentid对应的应用所获取 |
|source_agentid|是|企业授权的代开发自建应用或第三方应用的agentid|

**权限说明：**
>需要使用自建应用的access_token
>成员需要同时在access_token和source_agentid所对应应用的可见范围内

**返回结果：**

```
{
 "errcode": 0,
 "errmsg": "ok",
 "userid_list": [
 {
 "open_userid": "xxx",
 "userid": "aaa"
 }
 ],
 "invalid_open_userid_list":["yyy"]
}
```
**参数说明：**

| 参数 | 说明 |
| :----------- | :----------------- |
| errcode | 返回码 |
| errmsg | 对返回码的文本描述内容 |
| userid_list |明文userid|
|userid_list.open_userid |转换成功的open_userid|
|userid_list.userid |转换成功的open_userid对应的userid|
|invalid_open_userid_list|不合法的open_userid列表|

## external_userid转换
将代开发应用或第三方应用获取的externaluserid转换成自建应用的externaluserid。

**请求方式：**POST（**HTTPS**）
**请求地址**：https://qyapi.weixin.qq.com/cgi-bin/externalcontact/from_service_external_userid?access_token=ACCESS_TOKEN

**请求参数：**
```
{
 "external_userid":"aaa",
 "source_agentid":100001
}
```

**参数说明：**

| 参数 | 必须 | 说明 |
| :----------- | :--- | :----------------- |
| access_token | 是 | 企业自建应用的调用接口凭证。获取方法查看“[获取access_token](#15074)” |
| external_userid | 是 | 服务商主体的external_userid，必须是source_agentid对应的应用所获取 |
|source_agentid|是|企业授权的代开发自建应用或第三方应用的agentid|

**权限说明：**
>需要使用自建应用的access_token
>客户的跟进人，或者用户所在客户群的群主，需要同时在access_token和source_agentid所对应应用的可见范围内

**返回结果：**

```
{
 "errcode":0,
 "errmsg":"ok",
 "external_userid":"xxx"
}
```
**参数说明：**

| 参数 | 说明 |
| :----------- | :----------------- |
| errcode | 返回码 |
| errmsg | 对返回码的文本描述内容 |
| external_userid |企业主体的external_userid|
