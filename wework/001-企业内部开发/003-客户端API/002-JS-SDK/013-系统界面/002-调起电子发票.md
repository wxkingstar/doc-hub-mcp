---
title: "调起电子发票"
doc_id: 14914
category_id: 90493
source_url: https://developer.work.weixin.qq.com/document/path/90493
---
最后更新：2025/03/27

[[toc]]
<!-- import chooseInvoice from @wecom/jssdk -->

## 发票签名方法
### 获取电子发票ticket
**请求方式：**GET（**HTTPS**）
**请求地址：**https://qyapi.weixin.qq.com/cgi-bin/ticket/get?access_token=ACCESS_TOKEN&type=wx_card

**参数说明：**

|参数|必须|说明|
|----|----|----|
|access_token|是|调用接口凭证|
**返回数据：**

```
{
 "errcode":0,
 "errmsg":"ok",
 "ticket":"pIKi3wRPNWCGF-pyP-YU5KWjDDD",
 "expires_in":7200
}

```
**参数说明：**

|参数|说明|
|----|----|
|errcode|错误码|
|errmsg|错误描述|
|ticket|发票签名临时票据|
|expires_in|有效期，以秒为单位。在有效期内重复请求，ticket不会被刷新|

### 签名算法
**参数说明** 
| 参数 | 说明 |
| ------------ | ------------------- |
| cardType | 填入INVOICE |
| timestamp | 拉起发票列表时使用的时间戳 |
| appid | 调用该接口的appid |
| nonceStr | 随机字符串 |
| api_ticket | 通过acess_token换取的临时票据，详情请见获取电子发票ticket |
签名方法
 将 api_ticket、appid、timestamp、nonceStr、cardType的value值进行字符串的字典序排序。再将所有参数字符串拼接成一个字符串进行sha1加密，得到cardSign。
 例如：api_ticket=aaa、appid=bbb、timestamp=ddd、nonceStr=ccc、cardType=eee，那么先拼成字符串aaabbbcccdddeee，再将此字符串进行sha1加密，得到cardSign。
 签名算法工具，参考 [电子发票签名签名生成工具](http://open.work.weixin.qq.com/api/jsapisign?t=cardsign)
 
## 旧版jweixin调用
### 示例代码
```javascript
wx.invoke('chooseInvoice', {
 'timestamp': '', // 卡券签名时间戳 
 'nonceStr': '', // 卡券签名随机串 
 'signType': '', // 签名方式，默认'SHA1' 
 'cardSign': '', // 卡券签名 
 }, function(res) {
 // 这里是回调函数 
 alert(JSON.stringify(res)); // 返回的结果 
 });

```
