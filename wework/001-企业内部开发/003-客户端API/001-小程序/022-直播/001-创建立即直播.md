---
title: "创建立即直播"
doc_id: 25123
category_id: 93816
source_url: https://developer.work.weixin.qq.com/document/path/93816
---
最后更新：2021/01/13

此接口将创建临时直播并调起直播预览页

## 权限说明
- 此接口仅在企业微信3.1.0及以后版本支持
- 必须先调用过wx.qy.login，且session_key未过期，开发者可调用checkSession 检查当前登录态
- 当前成员必须在应用的可见范围
- 应用需具有直播使用权限，见[配置可使用直播的应用](#25967/配置可使用直播的应用)

## 参数说明

**接口参数 Object object**

|参数|必须|类型|说明|
|:-----------|:---|:-------|:------------|
|liveType|是|uint32|直播类型，0-通用直播；1-企业培训；2-大班课；3-小班课。</br>Mac端只支持通用直播|
|theme|否|string|直播主题。最多20个UTF-8字符|
|departmentIds|否|uint32[]|班级Id列表（直播类型必须为大班课或小班课，否则忽略该参数），最大100个班级，并且班级必须在老师可查看的班级范围内。|
|success|否|Function|接口调用成功的回调函数|
|fail|否|Function|接口调用失败的回调函数|
|complete|否|Function|接口调用结束的回调函数（调用成功、失败都会执行）|

**回调函数参数 Object res**

|参数|类型|说明|
|:-----------|:-------|:------------|
|res.errMsg|string|错误信息，如果调用成功返回 ${apiName}:ok|
|res.livingId|string|直播ID|

## 示例代码
```javascript
wx.qy.startLiving({
  "liveType": 1,
  "theme": "新同学培训",
  "departmentIds": [13,34,58],
  fail: function(res) {
    console.log(res)
  },
});
```

## 错误列表

|res.errMsg|说明|
|:-----------|:------------|
|qy.startLiving:ok |执行成功|
|qy.startLiving:fail no session or expired |没有调用 wx.qy.login，或者 session_key 已过期|
|qy.startLiving:fail no permission |应用需具有直播权限|
|qy.startLiving:fail user not in allow list |当前成员不在应用可见范围|
|qy.startLiving:fail invalid living id |不合法的直播ID|
|qy.startLiving:fail not allow to cross corp |不可跨企业使用直播ID|
|qy.startLiving:fail not allow to cross app |不可跨应用使用直播ID|
|qy.startLiving:fail invalid parameter |参数不合法|
|qy.startLiving:fail unsupported liveType |不支持的直播类型。部分类型仅对特殊行业放开|
|qy.startLiving:fail api freq out of limit |创建直播超过频率限制。单应用每天不可创建超过1w个直播|
|qy.startLiving:fail invalid department id |不合法的班级ID|
|qy.startLiving:fail exceed department id list size |超过最大的班级个数|
