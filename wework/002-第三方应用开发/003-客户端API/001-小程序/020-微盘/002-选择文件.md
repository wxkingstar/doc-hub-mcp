---
title: "选择文件"
doc_id: 48976
category_id: 99189
source_url: https://developer.work.weixin.qq.com/document/path/48976
---
**接口说明**：调用该接口，可唤起微盘选择器窗口，选择一个或多个微盘文件或文档。选中后返回对应文件的url。

**调用前提：**
> 必须先调用过wx.qy.login，且session_key未过期，开发者可调用checkSession 检查当前登录态。
>当前成员必须在应用的可见范围之中，否则调用时会报“no permission”错误。
>应用需具有**微盘和文档**使用权限，否则调用时会报“no permission”错误。
>若用户对某文件不具备「分享」权限（微盘自定义权限取消勾选“分享”权限），则无法选择该文件。

### wx.qy.wedriveSelectFile(Object object)
#### 参数

##### Object object

| 参数名 | 类型 | 必填 | 说明 | 
| -------- | -------- | ---- | -------------------------------- | 
| selectedFileNum | 是 | number | 选择文件的数量。1表示单选，大于1表示多选，上限为50 |
|success|否|Function|接口调用成功的回调函数|
|fail|否|Function|接口调用失败的回调函数|
|complete|否|Function|接口调用结束的回调函数（调用成功、失败都会执行）|

#### 返回结果

##### Object res
| 参数名 | 类型 | 说明 | 
| -------- | -------- | -------------------------------- | 
|res|Obj|返回信息|
|res.errMsg|string|执行结果。"wedriveSelectFile:ok" 表示执行成功，否则表示报错信息|
|res.result|Obj|返回的数据|
|res.result.selectedFileUrls|Array<string>|选择的文件的 url 列表。!!#ff0000 后续废弃，请使用selectedFileInfos !!|
|res.result.selectedFileInfos|Array<object>|选择的文件信息列表。!!#ff0000 企业微信版本 ≥4.1.8 才返回!!|
|res.result.selectedFileInfos[].url|string|选择的文件url|
|res.result.selectedFileInfos[].type|uint32|选择的文件类型。0: 其他，2: 文件，3: 文档，4: 表格，5: 收集表，6: 幻灯片，7: 思维导图，8: 流程图，10: 智能表格|

#### 示例代码

```javascript
wx.qy.wedriveSelectFile({
  selectedFileNum: 1,
  success: function(res) {
    var selectedFileUrls = res.result.selectedFileUrls; // 后续废弃
   var selectedFileInfos = res.result.selectedFileInfos;
  },
  fail: function(res) {
    console.log(res)
  },
});
```

**错误列表说明**
|res.errMsg|说明|
|:-----------|:------------|
| qy.wedriveSelectFile:ok |执行成功|
| qy.wedriveSelectFile:cancel| 取消选择 |
| qy.wedriveSelectFile:fail no session or expired |没有调用 wx.qy.login，或者 session_key 已过期 |
| qy.wedriveSelectFile:fail no permission | 无权限 |  
| qy.wedriveSelectFile:fail param error | 参数错误 |
| qy.wedriveSelectFile:fail context error | 选择器异常 |
| qy.wedriveSelectFile:fail not supported system version | 低系统版本不支持 |

**平台版本说明**

|平台|企业微信版本要求|系统版本要求|
|--|--|--|
|ios|≥4.0.12||
|android|≥4.0.12||
|win|≥4.0.12||
|mac|≥4.0.12|>10.12|

**应用权限说明**

|应用类型|可调用的应用|
|--|--|
|自建应用|需具有“微盘”和“文档”权限|
|第三方应用|需具有“微盘”和“文档”权限|
|代开发应用|需具有“微盘”和“文档”权限|
