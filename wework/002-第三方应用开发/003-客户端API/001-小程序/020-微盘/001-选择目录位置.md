---
title: "选择目录位置"
doc_id: 40356
category_id: 96014
source_url: https://developer.work.weixin.qq.com/document/path/96014
---
最后更新：2023/05/18

**接口说明**：调用该接口，可唤起微盘选择器窗口，选择目标目录位置。选中后返回用于上传的临时ticket。可用临时ticket调用文件上传接口，以操作用户的名义上传文件至该目录。

**调用前提：**
> 必须先调用过wx.qy.login，且session_key未过期，开发者可调用checkSession 检查当前登录态。
>当前成员必须在应用的可见范围之中，否则调用时会报“no permission”错误。
>应用需具有微盘使用权限，否则调用时会报“no permission”错误。
>若用户在某一目录位置不具备「上传」权限（微盘权限值为“可下载”/“仅预览”或自定义权限取消勾选“上传”权限），则无法选择该目录。

### wx.qy.wedriveSelectDir(Object object)
#### 参数

##### Object object

| 参数名 | 类型 | 必填 | 说明 | 
| -------- | -------- | ---- | -------------------------------- | 
| success | Function | 否 | 接口调用成功的回调函数 | 
| fail | Function | 否 | 接口调用失败的回调函数 | 
| complete | Function | 否 | 接口调用结束的回调函数（调用成功、失败都会执行） | 

#### 返回结果

##### Object res
| 参数名 | 类型 | 说明 | 
| -------- | -------- | -------------------------------- | 
|res.errMsg|string|执行结果。"wedriveSelectDir:ok" 表示执行成功，否则表示报错信息|
|res.result|Obj|返回的数据|
|res.result.selectedTicket|string|选择的目录位置所生成的临时ticket|
> selectedTicket 说明：
> 1. 有效期30分钟，且最多可以使用500次
> 2. 可调用[文件上传](#26913/上传文件)和[文件分块上传](#40102)接口

#### 示例代码

```js
wx.qy.wedriveSelectDir({
  success: function(res) {
    var selectedTicket = res.result.selectedTicket;
  },
  fail: function(res) {
    console.log(res)
  },
});
```

**错误列表说明**
|res.errMsg|说明|
|:-----------|:------------|
| qy.wedriveSelectDir:ok |执行成功|
| qy.wedriveSelectDir:cancel| 取消选择 |
| qy.wedriveSelectDir:fail no session or expired |没有调用 wx.qy.login，或者 session_key 已过期 |
| qy.wedriveSelectDir:fail no permission | 无权限 |  
| qy.wedriveSelectDir:fail param error | 参数错误 |
| qy.wedriveSelectDir:fail context error | 选择器异常 |
| qy.wedriveSelectDir:fail not supported system version | 低系统版本不支持 |

**平台版本说明**

|平台|企业微信版本要求|系统版本要求|
|--|--|--|
|ios|≥4.0.12||
|android|≥4.0.12||
|win|≥4.0.12||
|mac|≥4.0.12|>10.12|

**应用权限说明**

|应用类型|可调用的应用|
|--|--|
|自建应用|需具有“微盘”权限|
|第三方应用|需具有“微盘”权限|
|代开发应用|需具有“微盘”权限|
