---
title: "wx.qy.shareToExternalMoments"
doc_id: 30868
category_id: 94955
source_url: https://developer.work.weixin.qq.com/document/path/94955
---
最后更新：2021/08/25

具有客户联系权限的企业成员，可通过该接口将文本内容和附件传递到客户朋友圈。当前暂仅支持在企业微信内调用。

```javascript
wx.qy.shareToExternalMoments( {
 text: {
 content:"", // 文本内容
 },
 attachments: [
   {
    msgtype: "image", // 消息类型，必填
         image: {
            mediaid: "", // 图片的素材id
            imgUrl: "", // 图片的imgUrl,跟图片mediaid填其中一个即可
         },
      },
      {
         msgtype: "link", // 消息类型，必填
         link: {
            title: "", // H5消息标题
           imgUrl: "", // H5消息封面图片URL
           url: "", // H5消息页面url 必填
         },
      },
      {
         msgtype: "video", // 消息类型，必填
         video:{
            mediaid:"", // 视频的素材id
         },
      },
 ]},function(res) {
 if (res.err_msg == "shareToExternalMoments:ok") {
 }
  }
);
```

#### 参数

##### Object object

| 参数名 | 类型 | 必填 | 说明 |
| ---------- | -------- | ---- | ---------------------------------------- |
|text|Object |否|文本消息|
|text::content|string|否|消息文本内容，最多支持传入2000个字符，若超出长度报错'invalid text size'|
| attachments|Array |否|附件，最多支持9个图片类型，或者1个视频，或者1个链接。类型只能三选一，若传了不同类型，报错'invalid attachments msgtype'|
|msgtype |string|是|附件类型，可选image、link或者video|
|image|Object |否|图片消息附件。普通图片：建议不超过 1440 x 1080，长图片：长边建议不超过 10800px。图片建议不要超过10M。最多支持传入9个；超过9个报错'invalid attachments size'|
|image::mediaid|string|否|图片的素材id，若mediaid不为空，但是mediaid拉取资源出错，客户端会忽略该素材。可通过[素材管理](#10112)接口获得|
|image::imgUrl|string|否|图片的链接，若拉取图片失败，客户端会忽略该素材。**仅可使用[上传图片](#13219)接口得到的链接**，跟图片mediaid填其中一个即可|
|link|Object|否|图文消息附件。只支持1个；若超过1个报错'invalid attachments size'|
|link::title|string|否|图文消息标题，最多64个**字节**|
|link::url|string|是|图文消息链接|
|link::imgUrl|string|否|图文消息封面图片URL|
|video|Object|否|视频消息附件，建议不超过 1280 x 720，帧率 30 FPS，视频码率 1.67 Mbps，最长不超过30S，最大建议不超过10MB。只支持1个；若超过1个报错'invalid attachments size'|
|video::mediaid|string|是|视频的素材id，未填写报错"invalid msg",若mediaid不为空，但是mediaid拉取资源出错，客户端会忽略该素材。可通过[素材管理](#10112)接口获得|

> * 企业微信3.1.12及以上版本支持,仅支持ios跟安卓。微信客户端不支持（微信开发者工具也不支持）。
> * 必须先调用过wx.qy.login，且session_key未过期，开发者可调用checkSession 检查当前登录态
> * 应用需有[配置客户联系功能权限](#13473/配置可使用客户联系接口的应用)
> * 当前成员必须[配置了客户联系功能](#13473/配置可使用客户联系功能的成员)
> * 当前成员必须在客户朋友圈使用范围
> * 当前成员必须具备外部沟通管理成员使用权限
> * text和attachments不能同时为空（注：若text和attachments同时为空，报错'missing arguments'。）
* attachments中每个附件信息必须与msgtype一致，例如，msgtype指定为image，则需要填写image::imgUrl或者image::mediaid，否则会报错"invalid msg"。mediaid和imgUrl只需填写一个，两者同时填写时使用media_id且imgUrl失效，二者不可同时为空。若附件中的mediaid失效，客户端将丢弃该条附件
