---
title: "发起打印"
doc_id: 42886
category_id: 97285
source_url: https://developer.work.weixin.qq.com/document/path/42886
---
**接口说明** 
应用通过调用该接口，可以发起文件打印。

**调用前提**
> 必须先调用过wx.qy.login，并且调用时传入suiteId参数

**调用权限**
> 应用需要已获取 设备信息-打印扫描设备-发起文件打印权限授权。
> 当前触发调用人员身份需要在应用的可见范围内。
> 当前企业有安装企业微信打印设备

**示例代码**
```
wx.qy.printFile({ 
        "fileId": "xxxxxxxxxxxx",// 必填，表示文件id，可以是media_id，文件下载url或者本地文件路径
        "fileIdType":1, //必填， 1: mediaid, 2: url 3:文件路径，tempfilePath 
        "fileName":"xxx.jpg", //文件名，仅在fileType 1, 2时需要传入
     success: function(res){
 
     }
);
```

**传入参数**
| 参数名 | 类型 | 是否必须 | 说明 |
| --- | --- | --- | --- |
| fileId| string| 是 | 表示文件id，可以是media_id，文件下载url或者本地文件路径 |
| fileIdType| Int32| 是 | 1: mediaid<br>2: url<br> 3: 文件路径，即tempfilePath<br> |
|fileName|string| 否|文件名，仅当fileIdType为1, 2时需要传入|

> 注：tempfilePath可通过以下方式获得：
>1.[从会话选择文件](#34299)
>2. [wx.downloadFile](https://developers.weixin.qq.com/miniprogram/dev/api/wx.downloadFile.html)，[wx.chooseImage](https://developers.weixin.qq.com/miniprogram/dev/api/wx.chooseImage.html), [wx.chooseMedia](https://developers.weixin.qq.com/miniprogram/dev/api/wx.chooseMedia.html)等基础接口。 详情可以参考[微信小程序API支持情况](#16045)

> 注2: mac端暂不支持tempfilePath

**返回参数**
| 参数名 | 类型 | 是否必须 | 说明 |
| --- | --- | --- | --- |
| err_msg | String | 是 | 调用成功时返回selectPrivilegedContact:ok |
| result | Object | 否 | 当调用成功时返回 |
> err_msg出错的场景包括，
> 1. 无权限调用。比如未经过login。
> 2. 参数不合法。

**平台版本说明**

|平台|企业微信版本要求|
|--|--|
|ios|≥ 4.0.20|
|android|≥ 4.0.20|
|win|≥ 4.0.20|
|mac|≥ 4.0.20|

**应用权限说明**

|应用类型|是否支持|
|--|--|
|自建应用|不支持|
|第三方应用|支持|
|代开发自建应用|不支持|
