---
title: "从会话选择文件"
doc_id: 34299
category_id: 95099
source_url: https://developer.work.weixin.qq.com/document/path/95099
---
最后更新：2021/09/29

### wx.qy.chooseMessageFile(Object object)

>**调用前提：**
> 必须先调用过wx.qy.login，且session_key未过期，开发者可调用checkSession 检查当前登录态
> 当前成员必须在应用的可见范围

从企业微信客户端会话选择文件

#### 参数

##### Object object

| 参数名 | 类型 | 必填 | 说明 |
| -------- | -------- | ---- | -------------------------------- |
| count | Number | 是 | 最多可以选择的文件个数，可以 1～100，超出该范围时报错parameter error: invalid parameter.count |
| type | String | 否 | 所选的文件的类型，默认值是'video_and_image'，合法的类型值参见object.type说明，不合法时报错parameter error: invalid parameter.type |
| success | Function | 否 | 接口调用成功的回调函数 |
| fail | Function | 否 | 接口调用失败的回调函数 |
| complete | Function | 否 | 接口调用结束的回调函数（调用成功、失败都会执行） |

##### object.type说明

|值|说明|
|---|---|
|video|只能选择视频文件|
|image|只能选择图片文件|
|file|可以选择除了图片和视频之外的其它的文件|
|video_and_image|可以同时选择视频与图片|

#### 参数
##### Object res
| 参数名 | 类型 | 说明 |
| -------- | -------- | ---- | -------------------------------- |
| tempFiles | Array[Object] | 返回选择的文件的本地临时文件对象数组 |

##### res.tempFiles 的结构
| 参数名 | 类型 | 说明 |
| -------- | -------- | ---- | -------------------------------- |
|path|String|本地临时文件路径 (本地路径)|
|size|Number|本地临时文件大小，单位 B|
|name|String|选择的文件名称|
|type|String|选择的文件类型|
|time|Number|选择的文件的会话发送时间，Unix时间戳|

##### res.type说明

|值|说明|
|---|---|
|video|视频文件|
|image|图片文件|
|file|除图片和视频的文件|

#### 示例代码：

```js
wx.qy.chooseMessageFile({
 count: 10,
 type: 'image',
 success (res) {
 // tempFilePath可以作为img标签的src属性显示图片
 const tempFilePaths = res.tempFiles
 }
})

```

**平台版本说明**

|平台|企业微信版本要求|
|--|--|
|ios|≥3.1.18|
|android|≥3.1.18|
|win|不支持|
|mac|不支持|
