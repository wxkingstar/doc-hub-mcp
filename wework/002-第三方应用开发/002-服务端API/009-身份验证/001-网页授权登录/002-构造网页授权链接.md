---
title: "构造网页授权链接"
doc_id: 15121
category_id: 91120
source_url: https://developer.work.weixin.qq.com/document/path/15121
---
[TOC]

### 构造第三方应用oauth2链接
如果第三方应用需要在打开的网页里面携带用户的身份信息，第一步需要构造如下的链接来获取code：
```
https://open.weixin.qq.com/connect/oauth2/authorize?appid=APPID&redirect_uri=REDIRECT_URI&response_type=code&scope=SCOPE&state=STATE#wechat_redirect
```

**参数说明：**

| 参数 |必须|说明 |
|---- |-----|------ |
| appid |是|第三方应用id（即ww或wx开头的suite_id）。注意与企业的网页授权登录不同 |
| redirect_uri |是|授权后重定向的回调链接地址，请使用urlencode对链接进行处理 ，注意域名需要设置为第三方应用的**可信域名**|
| response_type |是|返回类型，此时固定为：code |
| scope |是|应用授权作用域。<br />snsapi_base：[静默授权](#15019/静默授权与手动授权)，可获取成员的基础信息（UserId与DeviceId）；<br /><br />snsapi_privateinfo：[手动授权](#15019/静默授权与手动授权)，可获取成员的详细信息，包含头像、二维码等敏感信息。|
| state |否|重定向后会带上state参数，企业可以填写a-zA-Z0-9的参数值，长度不可超过128个字节 |
| #wechat_redirect |是|固定内容|

企业员工点击后，页面将跳转至 redirect_uri?code=CODE&state=STATE，第三方应用可[根据code参数获得企业员工的corpid与userid](#15122)。code长度最大为512字节。

**权限说明：**
使用snsapi_privateinfo的scope时，第三方应用必须有“成员敏感信息授权”的权限。

### 构造企业oauth2链接
对于旧的套件应用，只能为每个授权企业构造不同的oauth2链接，以获取code参数：
```
https://open.weixin.qq.com/connect/oauth2/authorize?appid=CORPID&redirect_uri=REDIRECT_URI&response_type=code&scope=SCOPE&agentid=AGENTID&state=STATE#wechat_redirect
```

**参数说明：**

| 参数 | 必须 | 说明 |
| ------------- | ---- | --------------------------------- |
| appid | 是 | 企业的CorpID |
| redirect_uri | 是 | 授权后重定向的回调链接地址，<br>**请使用urlencode对链接进行处理。<br>redirect_uri的域名必须与该应用的可信域名一致**。|
| response_type | 是 | 返回类型，此时固定为：code |
| scope |是|应用授权作用域。<br />snsapi_base：[静默授权](#15019/静默授权与手动授权)，可获取成员的的基础信息（UserId与DeviceId）；<br />snsapi_privateinfo：[手动授权](#15019/静默授权与手动授权)，可获取成员的详细信息，包含头像、二维码等敏感信息 |
| agentid |是|[企业应用的id](#14953/agentid)。**建议填上该参数**（对于第三方应用和代开发自建应用，在填写该参数的情况下或者在工作台、聊天工具栏、应用会话内发起oauth2请求的场景中，会触发接口许可的自动激活） |
| state |否|重定向后会带上state参数，企业可以填写a-zA-Z0-9的参数值，长度不可超过128个字节 |
| #wechat_redirect |是|终端使用此参数判断是否需要带上身份信息 |

员工点击后，页面将跳转至 redirect_uri?code=CODE&state=STATE，企业可[根据code参数获得员工的userid](#15122)。code长度最大为512字节。

### scope的特殊情况
- 第三方服务商配置scope为snsapi_privateinfo时，agentid所对应的应用必须有“成员敏感信息授权”的权限。“成员敏感信息授权”的开启方法为：登录服务商管理后台->标准应用服务->本地应用->进入应用->点击基本信息栏“编辑”按钮->勾选"成员敏感信息"
