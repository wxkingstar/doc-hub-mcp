---
title: "异步通讯录id转译"
doc_id: 17813
category_id: 91846
source_url: https://developer.work.weixin.qq.com/document/path/17813
---
##通讯录id替换
**请求方式：**POST（**HTTPS**）
**请求地址：**https://qyapi.weixin.qq.com/cgi-bin/service/contact/id_translate?provider_access_token=ACCESS_TOKEN

**请求包体：**

```
{
 "auth_corpid": "wwxxxx",
  "media_id_list": ["1G6nrLmr5EC3MMb_-zK1dDdzmd0p7cNliYu9V5w7o8K0"],
  "output_file_name": "学习手册",
  "output_file_format": "pdf"
}
```
**参数说明：**

| 参数 | 必须 | 说明 |
| ------------ | ------------ | ------------ |
| provider_access_token | 是 | 服务商provider_access_token，获取方法参见[服务商的凭证](#11791/服务商的token) |
| auth_corpid | 是 | 授权企业corpid|
| media_id_list | 是 |需要转译的文件的media_id列表，只支持后缀名为xls/xlsx、doc/docx、csv、txt的文件。csv/txt 必须为 UTF-8 编码，不超过20个文件，获取方式参考 [服务商上传临时素材](#18022) |
| output_file_name | 否 | 转译完打包的文件名，不需带后缀。企业微信后台会打包成zip压缩文件，并自动拼接上.zip后缀。若media_id_list中文件个数大于1，则该字段必填。若media_id_list中文件个数等于1，且未填该字段，则转译完不打包成压缩文件。支持id转译，参见[模版语法](#18231/通讯录ID转译模版语法)|
| output_file_format | 否 | 若不指定，则输出格式跟输入格式相同。若要转换输出格式，当前仅支持输出文件为pdf格式。若media\_ id\_ list中文件存在相同前缀名的文件，则输出文件命名规则为：文件前缀名\_ 文件格式后缀.pdf，例如：20200901\_ xlsx.pdf|

> 注：若生成的文件不需要压缩，则 media_id_list列表只能指定一项，同时 output_file_name 不需要传值

**权限说明：**

只替换服务商通讯录权限范围内的用户userid跟部门id。

**返回结果：**

```
{
  "errcode": 0,
  "errmsg": "ok",
  "jobid": "xxxxx"
}

```
**参数说明：**

| 参数 | 说明 |
| ------------ | ------------ |
| errcode | 返回码 |
| errmsg | 对返回码的文本描述内容 |
| jobid   | 异步任务id，最大长度为64字节。jobid用于接口 [获取异步任务结果](#90001/90143/91882) 传递 |

**常见问题：**

1. 使用 NodeJs 第三方库 exceljs 生成的 excel 文件，文件内容看上去正常，但是转义不成功

  原因：exceljs 在不开启 sharedString 的情况下，会默认使用 formula string 进行文件内容写入，这种行为不合规范，导致转义失败

  解决方法：查看 exceljs 文档，强制开启 useSharedStrings 选项
