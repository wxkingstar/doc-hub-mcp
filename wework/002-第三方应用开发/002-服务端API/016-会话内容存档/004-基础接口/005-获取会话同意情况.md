---
title: "获取会话同意情况"
doc_id: 50859
category_id: 99530
source_url: https://developer.work.weixin.qq.com/document/path/50859
---
[TOC]

## 获取单聊会话同意情况
可通过下述接口，批量获取单聊会话中外部成员的同意情况

**权限说明**
>传入参数的内部成员open_userid应在企业授权会话存档接口权限的员工范围中

| 应用类型 | 权限要求 |
| -------- | ---- | 
|自建应用|暂不支持 |
|代开发应用|暂不支持|
|第三方应用|暂不支持|
|会话存档接口授权|需具备「!!#ff0000 会话存档接口权限!!」|

**单聊请求地址：**https://qyapi.weixin.qq.com/cgi-bin/chatdata/getagreestatus/single?access_token=ACCESS_TOKEN

**请求方式：**POST（**HTTPS**）

**请求示例：**

```
{
"item":[
{"open_userid":"XuJinSheng","external_userid":"wmeDKaCQAAGd9oGiQWxVsAKwV2HxNAAA"},{"open_userid":"XuJinSheng","external_userid":"wmeDKaCQAAIQ_p7ACn_jpLVBJSGocAAA"},
{"open_userid":"XuJinSheng","external_userid":"wmeDKaCQAAPE_p7ABnxkpLBBJSGocAAA"}
]
}

```

**参数说明：**

| 参数 | 必须 | 说明 |
| :----------- | :--- | :----------------- |
| access_token | 是 | 调用接口凭证 |
| info | 是 | 待查询的会话信息，数组 |
| open_userid | 是 | 内部成员的open_userid |
| external_userid | 是 | 外部成员的external_userid |

**备注说明：**
目前一次请求只支持最多100个查询条目，超过此限制的请求会被拦截，请调用方减少单次请求的查询个数。

**返回结果：**

```
{
 "errcode": 0,
 "errmsg": "ok",
 "agreeinfo" : [
 {
 "status_change_time" : 1562766651,
 "open_userid" : "XuJinSheng",
 "external_userid" : "wmeDKaCPAAGdvxciQWxVsAKwV2HxNAAA",
   "agree_status":"Agree",
 },
  {
 "status_change_time" : 1562766651,
 "open_userid" : "XuJinSheng",
 "external_userid" : "wmeDKaCQAAIQ_p7ACnxksfeBJSGocAAA",
   "agree_status":"Disagree",
 },
  {
 "status_change_time" : 1562766651,
 "open_userid" : "XuJinSheng",
 "external_userid" : "wmeDKaCwAAIQ_p7ACnxckLBBJSGocAAA",
   "agree_status":"Agree",
 },
 ],
}

```
**返回字段说明：**

| 字段名 | 说明 |
| ------------ | ------------ |
| errcode | 返回码 |
| errmsg | 对返回码的文本描述内容 |
| agreeinfo| 同意情况|
| agree_status| 同意:"Agree"，不同意:"Disagree"|
| status_change_time| 同意状态改变的具体时间，utc时间|

## 获取群聊会话同意情况
可通过下述接口，获取群聊会话中所有外企业的外部联系人的同意情况

**权限说明**
>群聊中至少需要有一个内部成员在会话存档接口权限的授权范围内

| 应用类型 | 权限要求 |
| -------- | ---- | 
|自建应用|暂不支持 |
|代开发应用|暂不支持|
|第三方应用|暂不支持|
|会话存档接口授权|需具备「!!#ff0000 会话存档接口权限!!」|

**请求地址：**https://qyapi.weixin.qq.com/cgi-bin/chatdata/getagreestatus/room?access_token=ACCESS_TOKEN

**请求方式：**POST（**HTTPS**）

**请求示例：**

```
{
  "chatid":"wrjc7bDwAASxc8tZvBErFE02BtPWyAAA",
}

```

**参数说明：**

| 参数 | 必须 | 说明 |
| :----------- | :--- | :----------------- |
| access_token | 是 | 调用接口凭证 |
| chatid | 是 | 待查询的chatid |

**返回结果：**

```
{
 "errcode": 0,
 "errmsg": "ok",
 "agreeinfo" : [
 {
 "status_change_time" : 1562766651,
 "external_userid" : "wmeDKaCQAAGdtHdiQWxVadfwV2HxNAAA",
   "agree_status":"Agree",
 },
  {
 "status_change_time" : 1562766651,
 "external_userid" : "wmeDKaCQAAIQ_p9ACyiopLBBJSGocAAA",
   "agree_status":"Disagree",
 },
  {
 "status_change_time" : 1562766651,
 "external_userid" : "wmeDKaCQAAIQ_p9ACnxacyBBJSGocAAA",
   "agree_status":"Agree",
 },
 ],
}

```
**返回字段说明：**

| 字段名 | 说明 |
| ------------ | ------------ |
| errcode | 返回码 |
| errmsg | 对返回码的文本描述内容 |
| agreeinfo| 同意情况|
| agree_status| 同意:"Agree"，不同意:"Disagree"|
| status_change_time| 同意状态改变的具体时间，utc时间|
| external_userid| 群内外部联系人的external_userid|
