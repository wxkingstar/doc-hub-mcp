---
title: "获取门禁通行原始数据"
doc_id: 40491
category_id: 96029
source_url: https://developer.work.weixin.qq.com/document/path/40491
---
第三方应用获取企业已授权的门禁设备通行记录。

>注意：
1.第三方应用须具有“设备接口信息权限-门禁通行原始数据”授权；
2.企业须同时安装硬件设备和第三方应用；
3.企业须向第三方应用**二次授权** 具体硬件设备的原始数据；
4.仅返回**应用可见范围**内的成员门禁通行数据；
5.接口返回数据按照门禁通行记录上传时间排序；
6.请求时间跨度应在一个月内，并且跨月请求易返回重复数据，请尽量避免；
7.部分场景下，接口可能返回重复的测温数据，调用端应进行排重。

**请求方式：**POST（**HTTPS**）
**请求地址：** https://qyapi.weixin.qq.com/cgi-bin/devicedata/get_accesscontrol_data?access_token=ACCESS_TOKEN
**请求包体：**

```
{
 "user_type":0,
 "begin_time":12345,
 "end_time":67890,
 "data_filter_type":1,
 "device_sn_list":[
 "SN1",
 "SN2"
 ],
 "open_userid_list":[

 ],
 "cursor":"CURSOR",
 "limit":"LIMIT",
 "agentid":10000
}
```

**参数说明：**
 
| 参数名 | 是否必须 | 类型 | 描述 |
| ------ | ---- | ------ | ---------------- |
| access_token | 是 | string | 应用调用接口权限 |
| user_type | 是 | uint32 | 成员类型，0-企业成员，2-学生 |
| begin_time | 是 | uint32 | 表示设备上传记录的开始时间戳 |
| end_time | 是 | uint32 | 表示设备上传记录的结束时间戳，**时间跨度不超过一个月** |
| data_filter_type | 是 | uint32 | 门禁通行数据筛选条件，1-按设备sn进行筛选，该条件下device_sn_list必填；2-按成员openuserid进行筛选，该条件下open_userid_list必填 |
| device_sn_list | 否 | string | 门禁设备SN列表，最多传入100个 |
| open_userid_list | 否 | string | 成员openuserid列表，最多传入100个，须在应用可见范围，否则忽略 |
| cursor | 否 | string | 分页查询游标，上一次调用时返回的next_cursor，初次调用可以不填。调用方需保证cursor的正确性 |
| limit | 否 | uint32 | 分页查询限制，**最多可返回limit条数据**，不填默认200，最多500 |
| agentid | 否 | uint32 | 应用agentid，第三方套件应用必填，第三方单应用可不填 |
**返回结果：** 

```
{
 "errcode":0,
 "errmsg":"ok",
 "accesscontrol_data":{
 "items":[
 {
 "open_userid":"userid1",
 "user_type":0,
 "timestamp":1662697304,
 "pass_type":1,
 "pass_method":0,
 "device_sn":"C00123122"
 },
 {
 "open_userid":"userid2",
 "user_type":0,
 "timestamp":1662697304,
 "pass_type":1,
 "pass_method":0,
 "device_sn":"C00123122"
 }
 ]
 },
 "next_cursor":"FVXbiWcnRUTZ8ZBzI905eQ=="
}
```

**参数说明：** 

| 参数名 | 描述 |
| ------------ | ----------- |
| errcode | 错误码 |
| errmsg | 错误码描述 |
| accesscontrol_data | 门禁通行数据 |
| accesscontrol_data.items.open_userid | 通过门禁人员的open_userid |
| accesscontrol_data.items.user_type | 人员类型：0-企业成员；1-访客；2-学生 |
| accesscontrol_data.items.timestamp | 通过门禁的时间戳 |
| accesscontrol_data.items.pass_type | 通行类型：1-进门；2-出门；3-无法识别方向 |
| accesscontrol_data.items.pass_method | 通行方法：1-人脸；2-二维码；3-远程开门；4-指纹 | 
| accesscontrol_data.items.device_sn | 测温设备SN |
| next_cursor | 分页游标，用于实现分页拉取，拉取下一页数据时需将前一页next_cursor填入请求cursor。若有返回该字段且为非空，表示可能还有满足的门禁数据，需继续调用接口；返回空字符串代表已经是最后一页。 <br>由于权限检查等筛选，极端情况下可能accesscontrol_data.items返回为空，但后续依旧有满足条件的数据。 |
