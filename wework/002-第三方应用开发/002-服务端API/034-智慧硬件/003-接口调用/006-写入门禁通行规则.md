---
title: "写入门禁通行规则"
doc_id: 40493
category_id: 96031
source_url: https://developer.work.weixin.qq.com/document/path/96031
---
最后更新：2022/10/10

第三方应用向企业微信写入企业的门禁规则。

>注意：
1.第三方应用须具有“设备接口信息权限-创建门禁规则”授权；
2.企业须同时安装硬件设备和第三方应用；
3.仅能对**第三方应用可见范围**内成员与**授权设备设备可见范围**内成员的交集成员创建门禁规则数据；
4.仅能对授权给第三方应用的设备列表范围内的设备进行门禁规则创建

**请求方式：**POST（**HTTPS**）
**请求地址：** https://qyapi.weixin.qq.com/cgi-bin/devicedata/add_accesscontrol_rule?access_token=ACCESS_TOKEN
**请求包体：**

```
{
 "device_sn_list":["SN"],
 "rule_name":"access_rule_name_xxx",
 "pass_rule":{
 "rule_list":[
 "9:00-10:00 * * 1-5 *",
 "9:00-10:00,15:30-17:45 * * 0,6 *"
 ],
 "effect_open_userid_list":[
 {
 "open_userid":"user1",
 "user_type":0
 },
 {
 "open_userid":"user2",
 "user_type":2
 }
 ]
 },
 "remote_pass_rule":{
 "rule_list":[
 "9:00-10:00 * * 1-5 *",
 "9:00-10:00,15:30-17:45 * * 0,6 *"
 ],
 "effect_open_userid_list":[
 {
 "open_userid":"user1",
 "user_type":0
 },
 {
 "open_userid":"user2",
 "user_type":2
 }
 ]
 }
}
```

**参数说明：**
 
| 参数名 | 是否必须 | 类型 | 描述 |
| ------ | ---- | ------ | ---------------- |
| access_token | 是 | string | 应用调用接口权限 |
| device_sn_list | 是 | string | 设备SN列表|
| rule_name | 是 | string | 门禁规则名称|
| pass_rule | 否 | object | 门禁规则 |
| pass_rule.rule_list | 是 | string | rule为具体规则，其解析语法请参考附录[门禁放行规则语法说明](#15400) | 
| pass_rule.effect_open_userid_list | 是 | string |生效成员的openuserid列表 | 
| open_userid | 是 | string | 生效成员的openuserid | 
| user_type | 否 | uint32 | 成员类型：0：企业员工 2：学生 不填则默认值为0 | 
| remote_pass_rule | 否 | object | 远程开门规则，远程开门规则列表，object内各字段含义与 pass_rule_list相同 | 
> 调用此接口，至少增加一条门禁规则或远程开门规则，否则会报错。
> pass_rule目前仅仅 时分字段 和 星期字段配置，即第一和第四个字段（共5个字段）
> 9:00-10:00 * * 1-5 *, 会被解析成 每周一到周五上午9点整至10点整，其余星号被替换成其他内容暂不生效
>9:00-10:00,15:30-17:45 * * 0,6 *, 会被解析成 每周六周日上午 9点整至10点整以及下午15:30至17:45，其余星号被替换成其他内容暂不生效
>pass_rule暂不支持 / 操作符

**返回结果：** 

```
{
  "errcode": 0,
  "errmsg": "ok"
  "rule_id":"xxx",
  "invalid_list": []
}
```

**参数说明：** 

| 参数名 | 描述 |
| ------------ | ----------- |
| errcode | 错误码 |
| errmsg | 错误码描述 |
| rule_id     | 写入门禁规则成功后返回本条规则的rule_id |
| invalid_list | 非法的open_userid列表，errcode不为0时此字段有效|
