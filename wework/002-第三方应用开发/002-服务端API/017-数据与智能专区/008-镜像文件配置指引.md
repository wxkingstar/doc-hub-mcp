---
title: "镜像文件配置指引"
doc_id: 53065
category_id: 99872
source_url: https://developer.work.weixin.qq.com/document/path/53065
---
[TOC]

## 概述
企业微信提供「数据分析专区」能力，服务商可将代码镜像部署在数据分析专区，使用企业会话内容进行分析。

## 准备镜像
使用 [docker-export](https://docs.docker.com/engine/reference/commandline/export/#docker-export) 将运行环境导出`tar`包，用于数据与智能专区的镜像导入。!!#ff0000 请特别注意不能用 docker-save命令生成`tar`包，否则可能无法执行启动命令。!!
docker 的相关使用请参考[官方文档](https://docs.docker.com/reference/)。

## 配置镜像
从「桌面端服务商助手 - 工具 - 数据与智能专区」入口进入专区。
- ![enter image description here](https://wework.qpic.cn/wwpic3az/810608_KMdZW264Rc-aVl1_1717506568/0)

点击「添加服务商模型/程序」，选择要添加自有模型/程序，进入到创建页面。支持最多添加1个自有模型以及2个自有程序。
- ![enter image description here](https://wework.qpic.cn/wwpic3az/365528_AU72VqcKTFSDkbk_1717506626/0)

下面以「添加自有模型」为例进行说明。
点击「配置」模型镜像文件，上传镜像文件，以及配置相应的启动命令和参数。
- ![enter image description here](https://wework.qpic.cn/wwpic3az/290429_FYIgwnt9TjWF8Ax_1717496291/0)

::: danger 特别注意
Oracle JDK需要付费获得Oracle授权方可使用，严禁部署包含未授权的Oracle JDK的镜像到专区，否则产生的风险和后果由上传者承担！开发者可以使用[OpenJDK](https://openjdk.org/)或Kona JDK([Kona 8](https://github.com/Tencent/TencentKona-8/releases/)、[Kona 11](https://github.com/Tencent/TencentKona-11/releases/)、[Kona 17](https://github.com/Tencent/TencentKona-17/releases/)或更新的Kona版本)。
:::
- 镜像文件：将 [docker-export](https://docs.docker.com/engine/reference/commandline/export/#docker-export) 导出`tar`包，上传至此。
- 启动命令/参数：指定镜像启动命令/参数，即[docker exec](https://docs.docker.com/engine/reference/commandline/exec/)的`COMMAND`。

> 镜像部署到数据专区后，`PATH`和`ENV`配置信息可能会丢失，导致部署失败。
解决方案参考：
> 1. 启动命令和参数指定绝对路径，例如 /usr/local/openjdk-8/bin/java。
> 2. 启动命令封装一层脚本，在脚本里先设置相关配置信息，然后再执行真正的启动命令，例如 /usr/local/wwspecdemo/start.sh
```
# ...
source /etc/profile
python3 -u demoloadsdk.py
```
