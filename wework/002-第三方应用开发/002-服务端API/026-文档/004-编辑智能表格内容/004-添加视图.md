---
title: "添加视图"
doc_id: 53110
category_id: 100199
source_url: https://developer.work.weixin.qq.com/document/path/100199
---
最后更新：2025/05/26

[TOC]
## 添加视图
本接口用于在 Smartsheet 中的某个子表里添加一个新视图。单表最多允许有200个视图。

**请求方式**：POST(HTTPS)
**请求地址**：https://qyapi.weixin.qq.com/cgi-bin/wedoc/smartsheet/add_view?access_token=ACCESS_TOKEN

**请求包体**：
```json
{
  "docid": "DOCID",
  "sheet_id": "123Abc",
  "view_title": "XXX",
  "view_type": "VIEW_TYPE_GRID"
}
```

**参数说明**
|参数 |类型 |是否必须 |说明 |
|:--|
|docid |string |是 |文档的docid |
|sheet_id |string |是 |Smartsheet 子表ID|
|view_title|string|是|视图标题|
|view_type|string|是|视图类型。见[ViewType](#viewtype) |
|property_gantt|obect([GanttViewProperty](#ganttviewproperty))|否|甘特视图属性,添加甘特图时必填 |
|property_calendar|object([CalendarViewProperty](#calendarviewproperty))|否|日历视图属性，添加日历视图时必填 |

**权限说明**
- 自建应用需配置到“[可调用应用](#43883)”列表中的应用secret所获取的accesstoken来调用（[accesstoken如何获取？](#10013/第三步：获取access_token)）
- 第三方应用需具有“文档”权限
- 代开发自建应用需具有“文档”权限

**返回示例**
```json
{
  "errcode": 0,
  "errmsg": "ok",
  "view": {
    "view_id": "vFYZUS",
    "view_title": "XXX",
    "view_type": "VIEW_TYPE_GRID"
  }
}
```
**参数说明**
| 参数|类型| 说明|
|:--|
| errcode |int32| 错误码|
| errmsg |string| 错误码说明 |
| view |object([View](#view))|添加视图响应|

## 参数详细说明

### View
**示例**
```json
{
  "view_id": "vabcde",
  "view_title": "默认视图",
  "view_type": "VIEW_TYPE_GRID"
}
```
视图信息：
|参数名 |类型 |描述 |
|:--|
|view_id |string |视图 ID |
|view_title |string |视图标题 |
|view_type|string|视图类型。见[ViewType](#viewtype) |

### ViewType
视图类型：
|枚举类型|描述|
|:--|
|VEW_UNKNOWN|未知类型视图，传递该值不合法|
|VIEW_TYPE_GRID|表格视图|
|VIEW_TYPE_KANBAN|看板视图|
|VIEW_TYPE_GALLERY|画册视图|
|VIEW_TYPE_GANTT|甘特视图|
|VIEW_TYPE_CALENDAR|日历视图|

### GanttViewProperty
甘特设置
|参数名 |类型 |是否必须 |描述 |
|:--|
|start_date_field_id |string |是 |时间条起点字段ID，只允许日期类型(`FIELD_TYPE_DATE_TIME`)的字段ID |
|end_date_field_id |string |是 |时间条终点字段ID，只允许日期类型(`FIELD_TYPE_DATE_TIME`)的字段ID |

### CalendarViewProperty
日历设置
|参数名 |类型 |是否必须 |描述 |
|:--|
|start_date_field_id |string |是 |时间条起点字段ID，只允许日期类型(`FIELD_TYPE_DATE_TIME`)的字段ID |
|end_date_field_id |string |是 |时间条终点字段ID，只允许日期类型(`FIELD_TYPE_DATE_TIME`)的字段ID |
