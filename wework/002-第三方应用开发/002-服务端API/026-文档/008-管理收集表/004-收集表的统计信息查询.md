---
title: "收集表的统计信息查询"
doc_id: 44612
category_id: 97826
source_url: https://developer.work.weixin.qq.com/document/path/44612
---
该接口用于获取收集表的统计信息、已回答成员列表和未回答成员列表

**请求方式**：POST（**HTTPS**）
**请求地址**: https://qyapi.weixin.qq.com/cgi-bin/wedoc/get_form_statistic?access_token=ACCESS_TOKEN 

**请求包体**

```json
// 仅获取统计结果
{
 "repeated_id":"REPEATED_ID1",
 "req_type":1
}
// 获取已提交的列表
{
 "repeated_id":"REPEATED_ID2",
 "req_type":2,
 "start_time":1667395287,
 "end_time":1668418369,
 "limit":20,
 "cursor":1
}
// 获取未提交的列表
{
 "repeated_id":"REPEATED_ID3",
 "req_type":3,
 "limit":20,
 "cursor":1
}
```

**参数说明**

| 参数 | 类型 | 是否必须 | 说明 |
| -------------------- | ------ | -------- | ------------------------------------------ |
| repeated_id | string | 是 | 操作的收集表的repeated_id,来源于get_form_info的返回 |
| req_type | uint32 | 是 | 请求类型 1:只获取统计结果 2:获取已提交列表 3:获取未提交列表 |
| start_time | uint64 | 否 | 拉取已提交列表时必填，其余type不填。筛选开始时间，以当天的00:00:00开始筛选 |
| end_time | uint64 | 否 | 拉取已提交列表时必填，其余type不填。筛选结束时间，以当天的23:59:59结束筛选 |
| limit | uint64 | 否 | 分页拉取时批次大小，最大10000 |
| cursor | uint64 | 否 | 分页拉取的游标，首次不传 |

**权限说明**
- 自建应用需配置到“[可调用应用](#43883)”列表中的应用secret所获取的accesstoken来调用（[accesstoken如何获取？](#10013/第三步：获取access_token)）
- 第三方应用需具有“文档”权限
- 代开发自建应用需具有“文档”权限
- 只能操作该应用创建的文档

**返回示例**

```json
// req_type = 1 仅获取统计信息
{
 "errcode":0,
 "errmsg":"ok",
 "fill_cnt":1,
 "fill_user_cnt":1,
 "unfill_user_cnt":90
}
// req_type = 2,获取已提交列表
{
 "errcode":0,
 "errmsg":"ok",
 "fill_cnt":1,
 "fill_user_cnt":1,
 "unfill_user_cnt":90,
 "submit_users":[
 {
 "userid":"USERID1",
 "submit_time":1668418200,
 "answer_id":1,
 "user_name":"USER_NAME1"
 },
 {
 "tmp_external_userid":"TMP_EXTERNAL_USERID1",
 "submit_time":1668418200,
 "answer_id":2,
 "user_name":"USER_NAME2"
 }
 ],
 "has_more":false,
 "cursor":1
}
// req_type = 3,获取未提交列表，仅当限制提交范围时有结果
{
 "errcode":0,
 "errmsg":"ok",
 "fill_cnt":1,
 "fill_user_cnt":1,
 "unfill_user_cnt":90,
 "unfill_users":[
 {
 "userid":"USERID1",
 "user_name":"USER_NAME1"
 }
 ],
 "has_more":false,
 "cursor":1
} 
```

**参数说明**

| 参数 | 类型 | 说明 |
| ------- | ------ | ---------- |
| errcode | int32 | 错误码 |
| errmsg | string | 错误码说明 |
| fill_cnt | uint64 | 已填写次数 |
| fill_user_cnt | uint64 | 已填写人数 |
| unfill_user_cnt | uint64 | 未填写人数 |
| submit_users | object[] | 已填写人列表 |
| tmp_external_userid | string | 外部用户临时id，匿名填写不返回，同一个用户在不同的收集表中返回的该id不一致。<br>可进一步通过[tmp_external_userid的转换](#46252)接口转换成external_userid，方便识别外部填写人的身份。 |
| userid | string | 企业内成员的id，匿名填写不返回 |
| submit_time | uint64 | 提交时间 |
| answer_id | uint64 | 答案id |
| user_name | string | 名字，匿名填写不返回 |
| userid | string | 企业内成员的id，匿名填写不返回 |
| unfill_users | object[] | 未填写人列表|
| user_name | string | 名字 |
| userid | string | 企业内成员的id |
| has_more | bool | 是否还有更多 |
| cursor | uint64 | 上次分页拉取返回的cursor |
