---
title: "接入指引"
doc_id: 14933
category_id: 90578
source_url: https://developer.work.weixin.qq.com/document/path/90578
---
最后更新：2023/08/04

## 概要
企业微信对应用安装提供了用户自主授权安装的机制，但是当用户没有企业微信时，用户需要先注册企业微信再安装第三方应用，对于用户流程比较繁琐。
基于这种情况，企业微信提供推广二维码功能，服务商只需要先配置好对应的推广二维码（即一系列应用及企业初始化设置），下载生成的二维码，用户扫码就能注册企业微信并默认安装预置的第三方应用。企业微信也提供了注册按钮，可以利用推广二维码生成的参数拼装出注册链接，用户点击该注册链接即可在注册完企业微信并默认安装预置的第三方应用。

## 配置流程

### 1. 上线应用

注册推广包需要配置已上线的普通应用，所以请先将需要接入到注册流程的应用上线。

### 2. 创建推广二维码
设置入口：服务商管理后台 > 应用推广 > 推广二维码
根据不同的企业需求，可以将不同应用及设置生成一个推广二维码，添加分为两步。

**步骤1：配置应用**

首先需要选择预装的第三方应用和企业微信基础应用，即用户注册完企业微信后显示的应用。
这里支持选择：

* 服务商应用（网页应用和小程序）
* 企业微信基础应用

注：服务商应用只支持最多选择15个，不支持选择其它类型应用（如通讯录应用）。

然后设置工作台的显示方式。

**步骤2：配置功能开关**

* 通讯录迁移接口：开启后，企业初始化配置时会锁定用户的通讯录，并回调服务商一个通讯录临时读写权限凭证，服务商可以对用户的通讯录进行初始化迁移。
* 全员群开关：开启后，企业初始化配置时会开启全员群。
* 自动创建部门群开关：开启后，企业初始化配置时会开启部门群开关。

**配置开放接口的通用回调参数**
>如果希望监控用户通过二维码成功注册企业微信的数据，可以设置通用开发参数
> 设置入口：服务商管理后台 > 开放接口 > 通用开放参数
>配置好【系统事件接收URL】，【Token】，【EncodingAESKey】。企业微信注册成功后将根据这3个参数进行回调。

## 使用推广二维码
### 1. 用户扫码注册
推广二维码可以放在任何的网页和H5图文中，用户通过微信或企业微信都可以扫描二维码，没有企业微信的用户会被引导下载、安装、注册企业微信，注册成功后，预置的应用默认安装在工作台；有企业微信的用户会被引导到应用添加流程。
### 2 用户扫码注册后的流程
#### 2.1 注册企业微信完成后的回调
用户在注册页面提交资料完成企业微信的注册流程。

* 企业微信端：注册成功之后回调一个“[注册完成事件](#11729/注册完成回调事件)”给服务商，同时判断通讯录迁移接口是否开启，若开启，则锁定用户通讯录。
* 服务商侧：接收到回调事件可以做自己的账户体系初始化等操作。

#### 2.2 初始化企业微信并安装应用

* 企业微信端：会根据推广二维码中的配置，初始化企业，并安装服务商的应用，应用的可见范围初始化为通讯录根目录。应用安装完成会回调“[授权成功通知](#10982/授权成功通知)”
* 服务商侧：若开启了通讯录迁移接口，可以使用通讯录管理接口对用户的通讯录做初始化。

**迁移通讯录步骤如下：**
1. 收到“注册完成回调事件”或者主动“查询注册状态”成功即可调用通讯录相关接口同步通讯录到企业微信。调用通讯录接口凭证（access_token）可以通过“[注册完成回调事件](#11729/注册完成回调事件)”或者“[查询注册状态](#11729/查询注册状态)”接口获取。
2. 通讯录迁移完成之后服务商需要调用“[设置通讯录同步完成](#11729/设置通讯录同步完成)”接口解除通讯录锁定状态。

### 3 Web页面放置推广二维码的交互建议

1. 注册链接的打开使用浏览器新标签页的方式，让用户在一个新的页面进行注册。
2. 然后在原页面弹层等待用户（类似PC端网银支付的流程）。
3. 当用户注册完成之后，企业微信端会回调通知服务商，用户已经注册完成，并且带上这个用户的标识和信息。
4. 服务商接收到注册完成通知之后进行页面的刷新即可较为流畅地进入到服务商自身的后台。
5. 用户也可以在新页面选择同时进入企业微信管理后台

### 4 注册按钮
除了提供二维码的注册方式之外，企业微信还提供注册按钮的推广方式。
#### 4.1 注册按钮注册流程
- ![注册定制化流程](https://p.qpic.cn/pic_wework/4208501329/1513d71ead1267566de73a66e8754add7b6ce7fe215993e1/0)
#### 4.2 注册按钮链接的生成和嵌入
调用“[获取注册码接口](#14934)”得到register_code，并构造以下链接嵌入到自己的网站中：
```
https://open.work.weixin.qq.com/3rdservice/wework/register?register_code=REGISTER_CODE
```
