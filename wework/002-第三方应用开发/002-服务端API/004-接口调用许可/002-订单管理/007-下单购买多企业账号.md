---
title: "下单购买多企业账号"
doc_id: 47529
category_id: 98892
source_url: https://developer.work.weixin.qq.com/document/path/47529
---
[TOC]

可以下单为多个企业购买新的账号，可以同时购买基础账号与互通账号。下单之后，需要到服务商管理端发起支付，支付完成之后，订单才能生效。也可以通过接口[使用余额支付订单](#50103)。

多企业下单分为两个步骤：
1. 传入企业新购信息列表创建一个任务，创建之后，追加参数jobid可以往同一个任务继续追加待购买的企业新购信息列表；
2. 根据步骤1得到的jobid提交订单。

>测试企业不支持多企业下单方式

## 创建多企业新购任务
在同一个订单里，首次创建任务无须指定jobid，后续指定同一个jobid，表示往同一个订单任务追加新购的企业。

**请求方式：** POST（**HTTPS**）
**请求地址：** https://qyapi.weixin.qq.com/cgi-bin/license/create_new_order_job?provider_access_token=ACCESS_TOKEN

**请求包体：**

```
{
  "buy_list": [{
    "corpid" : "CORPID",
    "account_count": {
      "base_count": 100,
      "external_contact_count": 100
    },
    "account_duration": {
      "months": 2,
      "days": 20
    },
    "auto_active_status": 1
  }],
  "jobid": "JOBID"
}
```

**参数说明：** 

| 参数 | 是否必须 | 说明 |
| ------- | ---- | ---- |
| provider_access_token | 是 |应用服务商的接口调用凭证，获取方法参见[服务商的凭证](#15143 ) |
|buy_list|是|企业新购信息列表，详见**BuyInfo**。每次最多传10个，每个jobid最多关联100000个**BuyInfo**|
|jobid|否|多企业新购任务id：<br>**不传：**默认创建一个新任务。<br>**有传：**必须为第一次调用后返回的jobid，可以通过该接口将该任务关联多个新企业的购买账号信息|

**BuyInfo 说明**

|参数 |是否必须 |说明 |
|:--|
|corpid |是 |企业id |
|account_count|是|账号个数详情，基础账号跟互通账号不能同时为0|
|account_count.base_count|否|基础账号个数，最多1000000个。(若企业为服务商测试企业，最多购买1000个)|
|account_count.external_contact_count|否|互通账号个数，最多1000000个。(若企业为服务商测试企业，最多购买1000个)|
|account_duration|是|账号购买时长。总购买时长为(months*31+days)天，最少购买1个月(31天)，最多购买60个月(1860天)|
|account_duration.months|否|购买的月数，每个月按照31天计算|
|account_duration.days|否|购买的天数|
|auto_active_status|否|是否开启自动激活，不填**默认开启**。<br>0：关闭 ，1：开启|

**返回结果：**
```
{
  "errcode": 0,
  "errmsg": "ok",
  "jobid": "BUYJOBID",
  "invalid_list":[
    {
      "corpid":"CORPID",
      "errcode": 1,
      "errmsg": "xxx"
    }
  ]
}
```

**参数说明：** 

| 参数 | 说明 |
| ------- | ---- |
| errcode |错误码 |
|errmsg|错误码说明|
|jobid|多企业新购任务id，当请求包中未指定jobid时，会生成一个新的jobid返回|
|invalid_list|不合法的新购信息列表，详见**InvalidInfo**|

**InvalidInfo 说明**
|参数 |说明 |
|:--|
|corpid |不合法的企业 ID |
|errcode|新购信息不合法相关错误码|
|errmsg|新购信息不合法相关错误描述|

## 提交多企业新购订单
创建多企业新购任务之后，需要调用该接口，以提交多企业新购订单任务。注意，提交之后，需要到服务商管理端发起支付，支付完成之后，订单才能生效。

**请求方式：** POST（**HTTPS**）
**请求地址：** https://qyapi.weixin.qq.com/cgi-bin/license/submit_new_order_job?provider_access_token=ACCESS_TOKEN

**请求包体：**

```
{
  "jobid" : "BUYJOBID",
  "buyer_userid":"xxxx"
}
```

**参数说明：** 

| 参数 | 是否必须 | 说明 |
| ------- | ---- | ---- |
| provider_access_token | 是 |应用服务商的接口调用凭证，获取方法参见[服务商的凭证](#15143 ) |
|jobid|是|多企业新购任务id|
|buyer_userid|是|下单人，服务商企业内成员的明文userid。该userid必须登录过企业微信，并且企业微信已绑定微信，且必须为服务商企业内具有“购买接口许可”权限的管理员。|

**返回结果：**
```
{
  "errcode": 0,
  "errmsg": "ok"
}
```

**参数说明：** 

| 参数 | 说明 |
| ------- | ---- |
| errcode |错误码 |
|errmsg|错误码说明|

## 获取多企业新购订单提交结果
提交多企业新购订单之后，用于获取该订单的创建结果。该结果仅在提交多企业新购订单后7天内可获取。

**请求方式：** POST（**HTTPS**）
**请求地址：** https://qyapi.weixin.qq.com/cgi-bin/license/new_order_job_result?provider_access_token=ACCESS_TOKEN

**请求包体：**

```
{
  "jobid" : "BUYJOBID"
}
```

**参数说明：** 

| 参数 | 是否必须 | 说明 |
| ------- | ---- | ---- |
| provider_access_token | 是 |应用服务商的接口调用凭证，获取方法参见[服务商的凭证](#15143 ) |
|jobid|是|多企业新购任务id|

**返回结果：**
```
{
  "errcode": 0,
  "errmsg": "ok",
  "status": 1,
  "order_id": "xxxx",
  "fail_list": [{
    "corpid": "CORPID",
    "errcode": 700400,
    "errmsg": "xxx"
  }]
}
```

**参数说明：** 

| 参数 | 说明 |
| ------- | ---- |
| errcode |错误码 |
|errmsg|错误码说明|
|status|订单创建结果。<br> 1：创建完成 <br>2：创建中，稍后再试<br>3：创建失败 |
|order_id|订单号。创建完成后返回|
|fail_list|下单失败的企业及原因。详见**FailInfo**|

**FailInfo 说明**

| 参数 | 说明 |
| ------- | ---- |
|corpid |下单失败的企业 ID |
|errcode|下单失败相关错误码|
|errmsg|下单失败相关错误描述|
