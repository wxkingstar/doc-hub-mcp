---
title: "获取「群聊数据统计」数据"
doc_id: 19418
category_id: 93476
source_url: https://developer.work.weixin.qq.com/document/path/93476
---
最后更新：2023/12/01

获取**指定日期**的统计数据。注意，**企业微信仅存储180天的数据。**

[TOC]

## 按群主聚合的方式
**请求方式：**POST（**HTTPS**）
**请求地址：**https://qyapi.weixin.qq.com/cgi-bin/externalcontact/groupchat/statistic?access_token=ACCESS_TOKEN

```
{
  "day_begin_time": 1600272000,
  "day_end_time": 1600444800,
  "owner_filter": {
    "userid_list": ["zhangsan"]
  },
  "order_by": 2,
  "order_asc": 0,
  "offset" : 0,
  "limit" : 1000
}
```

**参数说明：**

| 参数 | 必须 | 说明 |
| :----------- | :--- | :----------------- |
| access_token | 是 | 调用接口凭证 |
| day_begin_time | 是 | 起始日期的时间戳，填当天的0时0分0秒（否则系统自动处理为当天的0分0秒）。取值范围：昨天至前180天。|
| day_end_time | 否 | 结束日期的时间戳，填当天的0时0分0秒（否则系统自动处理为当天的0分0秒）。取值范围：昨天至前180天。</br>**如果不填，默认同 day_begin_time（即默认取一天的数据）**|
| owner_filter | 是 | 群主过滤。</BR>如果不填，表示获取应用可见范围内全部群主的数据（但是不建议这么用，如果可见范围人数超过1000人，为了防止数据包过大，会报错 81017）|
| owner_filter.userid_list | 是 | 群主ID列表。最多100个|
| order_by | 否 | 排序方式。</br>1 - 新增群的数量</br>2 - 群总数</br>3 - 新增群人数</br>4 - 群总人数</br></br>默认为1|
| order_asc | 否 | 是否升序。0-否；1-是。默认降序 |
|offset| 否 | 分页，偏移量, 默认为0 |
|limit| 否 | 分页，预期请求的数据量，默认为500，取值范围 1 ~ 1000 |

> 此接口查询的时间范围为 [day_begin_time, day_end_time]，前后均为闭区间（即包含day_end_time当天的数据），支持的最大查询跨度为30天；
> 用户最多可获取最近180天内的数据（超过180天企业微信将不再存储）；
> 当传入的时间不为0点时，会向下取整，如传入1554296400(Wed Apr 3 21:00:00 CST 2019)会被自动转换为1554220800（Wed Apr 3 00:00:00 CST 2019）;

**权限说明**:
- 企业需要使用配置到“[可调用应用](#13473/开始开发)”列表中的自建应用secret所获取的accesstoken来调用（[accesstoken如何获取？](#10013/第三步：获取access_token)）。
- 第三方应用使用，需具有“企业客户权限->客户群->获取客户群的数据统计”权限。
- 对于第三方/自建应用，群主必须在应用的可见范围。

**返回结果：**

```
{
  "errcode": 0,
  "errmsg": "ok",
  "total": 2,
  "next_offset": 2,
  "items": [{
      "owner": "zhangsan",
      "data": {
        "new_chat_cnt": 2,
        "chat_total": 2,
        "chat_has_msg": 0,
        "new_member_cnt": 0,
        "member_total": 6,
        "member_has_msg": 0,
        "msg_total": 0,
        "migrate_trainee_chat_cnt": 3
      }
    },
    {
      "owner": "lisi",
      "data": {
        "new_chat_cnt": 1,
        "chat_total": 3,
        "chat_has_msg": 2,
        "new_member_cnt": 0,
        "member_total": 6,
        "member_has_msg": 0,
        "msg_total": 0,
        "migrate_trainee_chat_cnt": 3
      }
    }
  ]
}
```
**参数说明：**

| 参数 | 说明 |
| :------- | :---------- |
| errcode | 返回码 |
| errmsg | 对返回码的文本描述内容 |
| total | 命中过滤条件的记录总个数 |
| next_offset | 当前分页的下一个offset。当next_offset和total相等时，说明已经取完所有 |
| items | 记录列表。表示某个群主所拥有的客户群的统计数据 |
| items.owner | 群主ID |
| items.data | 详情 |
| items.data.new_chat_cnt | 新增客户群数量 |
| items.data.chat_total | 截至当天客户群总数量 |
| items.data.chat_has_msg | 截至当天有发过消息的客户群数量 |
| items.data.new_member_cnt | 客户群新增群人数。 |
| items.data.member_total | 截至当天客户群总人数 |
| items.data.member_has_msg | 截至当天有发过消息的群成员数 |
| items.data.msg_total | 截至当天客户群消息总数 |
| items.data.migrate_trainee_chat_cnt | 截至当天新增迁移群数(仅教培行业返回) |

## 按自然日聚合的方式

**请求方式：**POST（**HTTPS**）
**请求地址：**https://qyapi.weixin.qq.com/cgi-bin/externalcontact/groupchat/statistic_group_by_day?access_token=ACCESS_TOKEN

```
{
  "day_begin_time": 1600272000,
  "day_end_time": 1600358400,
  "owner_filter": {
    "userid_list": ["zhangsan"]
  }
}
```

**参数说明：**

| 参数 | 必须 | 说明 |
| :----------- | :--- | :----------------- |
| access_token | 是 | 调用接口凭证 |
| day_begin_time | 是 | 起始日期的时间戳，填当天的0时0分0秒（否则系统自动处理为当天的0分0秒）。取值范围：昨天至前180天。|
| day_end_time | 否 | 结束日期的时间戳，填当天的0时0分0秒（否则系统自动处理为当天的0分0秒）。取值范围：昨天至前180天。</br>**如果不填，默认同 day_begin_time（即默认取一天的数据）**|
| owner_filter | 是 | 群主过滤。</BR>如果不填，表示获取应用可见范围内全部群主的数据（但是不建议这么用，如果可见范围人数超过1000人，为了防止数据包过大，会报错 81017）|
| owner_filter.userid_list | 是 | 群主ID列表。最多100个|

> 此接口查询的时间范围为 [day_begin_time, day_end_time]，前后均为闭区间（即包含day_end_time当天的数据），支持的最大查询跨度为30天；
> 用户最多可获取最近180天内的数据（超过180天企业微信将不再存储）；
> 当传入的时间不为0点时，会向下取整，如传入1554296400(Wed Apr 3 21:00:00 CST 2019)会被自动转换为1554220800（Wed Apr 3 00:00:00 CST 2019）;

**权限说明**:
- 企业需要使用[“客户联系”secret](#13473/开始开发)或配置到“[可调用应用](#13473/开始开发)”列表中的自建应用secret所获取的accesstoken来调用（[accesstoken如何获取？](#10013/第三步：获取access_token)）。
- 第三方应用使用，需具有“企业客户权限->客户群->获取客户群的数据统计”权限。
- 对于第三方/自建应用，群主必须在应用的可见范围。

**返回结果：**

```
{
  "errcode": 0,
  "errmsg": "ok",
  "items": [{
      "stat_time": 1600272000,
      "data": {
        "new_chat_cnt": 2,
        "chat_total": 2,
        "chat_has_msg": 0,
        "new_member_cnt": 0,
        "member_total": 6,
        "member_has_msg": 0,
        "msg_total": 0,
        "migrate_trainee_chat_cnt": 3
      }
    },
    {
      "stat_time": 1600358400,
      "data": {
        "new_chat_cnt": 2,
        "chat_total": 2,
        "chat_has_msg": 0,
        "new_member_cnt": 0,
        "member_total": 6,
        "member_has_msg": 0,
        "msg_total": 0,
        "migrate_trainee_chat_cnt": 3
      }
    }
  ]
}
```
**参数说明：**

| 参数 | 说明 |
| :------- | :---------- |
| errcode | 返回码 |
| errmsg | 对返回码的文本描述内容 |
| items | 记录列表。表示某个自然日客户群的统计数据 |
| items.stat_time | 数据日期，为当日0点的时间戳 |
| items.data | 详情 |
| items.data.new_chat_cnt | 新增客户群数量 |
| items.data.chat_total | 截至当天客户群总数量 |
| items.data.chat_has_msg | 截至当天有发过消息的客户群数量 |
| items.data.new_member_cnt | 客户群新增群人数。 |
| items.data.member_total | 截至当天客户群总人数 |
| items.data.member_has_msg | 截至当天有发过消息的群成员数 |
| items.data.msg_total | 截至当天客户群消息总数 |
| items.data.migrate_trainee_chat_cnt | 截至当天新增迁移群数(仅教培行业返回) |
