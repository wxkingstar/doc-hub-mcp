---
title: "创建收集表"
doc_id: 43942
category_id: 97466
source_url: https://developer.work.weixin.qq.com/document/path/97466
---
最后更新：2025/08/18

[TOC]
该接口用于创建收集表。

**请求方式**：POST（**HTTPS**）
**请求地址**: https://qyapi.weixin.qq.com/cgi-bin/wedoc/create_form?access_token=ACCESS_TOKEN

**请求包体**

```json
{
 "spaceid": "SPACEID",
 "fatherid": "FATHERID",
 "form_info": {
 "form_title": "FORM_TITLE",
 "form_desc": "FORM_DESC",
 "form_header": "FORM_HEADER",
 "form_question": {
 "items": [
 {
 "question_id": 1,
 "title": "TITLE",
 "pos": 1,
 "status": 1,
 "reply_type": 1,
 "must_reply": false,
 "note": "NOTE",
 "option_item": [
 {
 "key": 1,
 "value": "VALUE",
 "status": 1
 }
 ],
 "placeholder": "PLACEHOLDER",
 "question_extend_setting": {}
 }
 ]
 },
 "form_setting": {
 "fill_out_auth": 0,
 "fill_in_range": {
 "userids": [
 "USER_1",
 "USER_2",
 "USER_3"
 ],
 "departmentids": [
 10001,
 10002,
 10003
 ]
 },
 "setting_manager_range": {
 "userids": [
 "USER_4",
 "USER_5",
 "USER_6"
 ]
 },
 "timed_repeat_info": {
 "enable": false,
 "week_flag": 0,
 "remind_time": 0,
 "repeat_type": 0,
 "skip_holiday": false,
 "day_of_month": 1,
 "fork_finish_type": 0
 },
 "allow_multi_fill": false,
 "timed_finish": 0,
 "can_anonymous": false,
 "can_notify_submit": false
 }
 }
}
```

**参数说明**

| 参数 | 类型 | 是否必须 | 说明 |
|------------|------|--------|----------------------------|
| spaceid | string | 否 | 空间spaceid |
| fatherid | string | 否 | 父目录fileid, 在根目录时为空间spaceid |
| form_info | obj | 是 | 收集表信息 |
| form_title | string | 是| 收集表标题 |
| form_desc | string | 否|收集表描述|
| form_header | string | 否 | 收集表表头背景图链接 |
| form_question | object | 是 | 收集表的问题列表 |
| items| object[]| 是 |问题数组。不超过200个。|
| question_id | uint32 | 是|问题id，从1开始。如果是家校范围收集表，id从2开始。|
| title| string| 是| 问题描述|
| pos| uint32| 是| 问题序号，从1开始。|
| status| uint32| 是| 问题状态。1：正常；2：被删除|
| reply_type| uint32| 是| 问题类型。1：文本；2：单选；3：多选；5：位置；9：图片；10：文件；11：日期；14：时间；15：下拉列表；16：体温；17：签名；18：部门；19：成员 22：时长|
| must_reply| bool| 是| 是否必答|
| note| string| 否| 问题备注|
| placeholder| string| 否| 编辑提示|
| question_extend_setting| object| 否| 问题的额外设置。不同问题类型有相应的设置，详见[question_extend_setting字段描述](#43942/question_extend_setting)|
| option_item| object[]| 是| 单选/多选/下拉列表题的选项列表|
| key| uint32| 是| 选项key（1，2，3...）|
| value| string| 是| 选项内容|
| status| uint32| 是| 选项状态。1：正常；2：被删除|
| form_setting | object | 否 |收集表设置 |
| fill_out_auth| uint32| 否| 填写权限。0：所有人；1：企业内指定人/部门；4:家校所有范围。默认为0，所有人可填写。|
| fill_in_range| object| 否| 指定的可填写的人/部门。当`timed_repeat_info.enable`为`true`时必填|
| userids| string[]| 否| 企业成员userid列表|
| departmentids| uint64[]| 否| 部门id列表|
| setting_manager_range| object| 否| 收集表管理员|
| timed_repeat_info| object| 否| 定时重复设置项|
| timed_repeat_info.enable| bool| 否| 是否开启定时重复|
| timed_repeat_info.remind_time| uint32| 否| 提醒时间，为第一次提醒的时间戳。重复提醒的时间根据timed_repeat_info的相关字段计算。<br>如remind_time设置为当天10:00的时间戳，同时repeated_type设置了每天重复，那么每天的10:00都会触发提醒。|
| timed_repeat_info.repeat_type| uint32| 否| 重复类型。0：每周；1：每天；2：每月|
| timed_repeat_info.week_flag| uint32| 否| 每周几重复，按bit组合，只能repeat_type = 0 时填写。<br>bit 0: 周一； bit 1: 周二；bit 2: 周三；bit 3: 周四； bit 4: 周五；bit 5: 周六 bit 6: 周日。如`1`表示周一，`2`表示周二，`4`表示周三，`96`表示周六和周日|
| timed_repeat_info.skip_holiday| bool| 否| 自动跳过节假日，只能repeat_type = 1 时填写。|
| timed_repeat_info.day_of_month| uint32| 否| 每月的第几天（1 - 31），只能repeat_type = 2时填写|
| timed_repeat_info.fork_finish_type| uint32 | 否 | 是否允许补填。0：允许；1：仅当天；2：最后五天内；3：一个月内；4：下一次生成前 |
| allow_multi_fill| bool | 否| 是否允许每人提交多份。默认false|
| timed_finish| uint32| 否| 定时关闭。定时重复与定时结束互斥，若都填，优先定时重复|
| can_anonymous| bool| 否| 是否支持匿名填写。默认false|
| can_notify_submit| bool| 否| 是否有回复时提醒。默认false|

**权限说明**
- 自建应用需配置到“[可调用应用](#43883)”列表中的应用secret所获取的accesstoken来调用（[accesstoken如何获取？](#10013/第三步：获取access_token)）
- 第三方应用需具有“文档”权限
- 代开发自建应用需具有“文档”权限

**返回示例**

```json
{
 "errcode": 0,
 "errmsg": "ok",
 "formid": "FORMID"
}
```
**参数说明**

| 参数 | 类型 | 说明 |
|----------------|--------|-----------------------------|
| errcode | int32 | 错误码 |
| errmsg | string | 错误码说明 |
| formid | string | 收集表id |

 <!-- 瞄点目标，直接用标题居然不行 -->
## question_extend_setting字段描述
### 文本
| 参数 | 类型 | 是否必须 | 说明 |
|------------|------|--------|----------------------------|
| question_extend_setting.text_setting | object | 否 | 文本题的题目设置，不填时将使用默认设置 |
| question_extend_setting.text_setting.validation_type | uint32 | 否 | 校验类型。0: 字符个数 1: 数字 2: 电子邮箱 3: 网址 4: 身份证 5: 手机号（大陆地区） 6: 固定电话。<br>默认值为0。 |
| question_extend_setting.text_setting.validation_detail | uint32 | 否 | 校验详情。1: 字符数不超过 2: 字符数不小于 3: 字符数等于 4: 数字没有限制 5: 数字大于 6: 数字大于等于 7: 数字小于 8: 数字小于等于 9: 数字在范围之间 10: 数字不在范围之间 11: 数字为整数。 |
| question_extend_setting.text_setting.char_len | uint32 | 否 | 字符长度 |
| question_extend_setting.text_setting.number_min | double | 否 | 数字的区间左端 |
| question_extend_setting.text_setting.number_max | double | 否 | 数字的区间右端 |

使用限制：
| validation_type | 适用的validation_detail以及字段 | 
|------|--------|
| 0| 1: 字符数不超过 2: 字符数不小于 3: 字符数等于。要求`char_len`必须有值且大于0，最大4000 | 
| 1| 4: 数字没有限制 5: 数字大于(`number_min`) 6: 数字大于等于(`number_min`) 7: 数字小于(`number_max`) 8: 数字小于等于(`number_max`) 9: 数字在范围之间(`number_min`、`number_max`) 10: 数字不在范围之间(`number_min`、`number_max`) 11: 数字为整数 |

### 单选
| 参数 | 类型 | 是否必须 | 说明 |
|------------|------|--------|----------------------------|
| question_extend_setting.radio_setting | object | 否 | 单选校验设置。不填则不会校验 |
| question_extend_setting.radio_setting.add_other_option | bool | 否 | 是否增加“其他”选项 |

### 多选
| 参数 | 类型 | 是否必须 | 说明 |
|------------|------|--------|----------------------------|
| question_extend_setting.checkbox_setting | object | 否 | 多选校验设置。不填则不会校验 |
| question_extend_setting.checkbox_setting.add_other_option | bool | 否 | 是否增加“其他”选项 |
| question_extend_setting.checkbox_setting.type | uint32 | 否 | 多选类型。0: 不限制可选数量 1: 至少选择 2: 最多选择 3: 固定选择。结合`number`使用。默认为0 |
| question_extend_setting.checkbox_setting.number | uint32 | 否 | 多选题可勾选的数量的限制，`type`为`1`、`2`、`3`需指定并且大于0的值。不能超过选项`option_item`个数 |

> 如 { ... "checkbox_setting": {"type": 1, "number": 2} ...}，表示至少勾选2个选项。

### 位置
| 参数 | 类型 | 是否必须 | 说明 |
|------------|------|--------|----------------------------|
| question_extend_setting.location_setting | object | 否 | 地址题的题目设置，不填时将使用默认设置 |
| question_extend_setting.location_setting.location_type | uint32 | 否 | 位置类型。0: 省/市/区/街道+详细地址 1: 省/市 2: 省/市/区 3: 省/市/区/街道 4: 自动定位 |
| question_extend_setting.location_setting.distance_type | uint32 | 否 | 允许定位范围。0: 当前位置 1: 附近100米 2: 附近200米 3: 附近300米，`location_type`为`4`适用|

### 图片
| 参数 | 类型 | 是否必须 | 说明 |
|------------|------|--------|----------------------------|
| question_extend_setting.image_setting | object | 否 | 图片题的题目设置，不填时将使用默认设置 |
| question_extend_setting.image_setting.camera_only | bool | 否 | 是否仅限手机拍照。默认为 false |
| question_extend_setting.image_setting.upload_image_limit | object | 否 | 数量和大小限制信息 |
| question_extend_setting.image_setting.upload_image_limit.count_limit_type | uint32 | 否 | 数量限制类型。0: 等于`count`数量 1: 小于等于`count`数量 |
| question_extend_setting.image_setting.upload_image_limit.count | uint32 | 否 | 限制的数量。默认9张，取值范围: [1, 9] |
| question_extend_setting.image_setting.upload_image_limit.max_size | uint64 | 否 | 单个文件大小限制MB。不填该字段表示无限制，可填写的最大值为3000 |

### 文件
| 参数 | 类型 | 是否必须 | 说明 |
|------------|------|--------|----------------------------|
| question_extend_setting.file_setting | object | 否 | 文件题的题目设置，不填时将使用默认设置 |
| question_extend_setting.file_setting.upload_file_limit | object | 否 | 数量和大小限制信息 |
| question_extend_setting.file_setting.upload_file_limit.count_limit_type | uint32 | 否 | 数量限制类型。0: 等于`count`数量 1: 小于等于`count`数量 |
| question_extend_setting.file_setting.upload_file_limit.count | uint32 | 否 | 限制的数量。默认9个，取值范围: [1, 9] |
| question_extend_setting.file_setting.upload_file_limit.max_size | uint64 | 否 | 单个文件大小限制MB。不填该字段表示无限制，可填写的最大值为3000 |

### 日期
| 参数 | 类型 | 是否必须 | 说明 |
|------------|------|--------|----------------------------|
| question_extend_setting.date_setting | object | 否 | 日期题的题目设置，不填时将使用默认设置 |
| question_extend_setting.date_setting.date_format_type | uint32 | 否 | 日期格式。0: 年/月/日/时/分 1: 年/月/日 2: 年/月 |

### 时间
| 参数 | 类型 | 是否必须 | 说明 |
|------------|------|--------|----------------------------|
| question_extend_setting.time_setting | object | 否 | 时间题的题目设置，不填时将使用默认设置 |
| question_extend_setting.time_setting.time_format_type | uint32 | 否 | 时间格式。0: 时分 1: 时分秒 |

### 时长
| 参数 | 类型 | 是否必须 | 说明 |
|------------|------|--------|----------------------------|
| question_extend_setting.duration_setting | object | 否 | 时长题的题目设置，不填时将使用默认设置 |
| question_extend_setting.duration_setting.time_scale | uint32 | 否 | 时间刻度。1: 按天 2: 按小时。默认为1 |
| question_extend_setting.duration_setting.date_type | uint32 | 否 | 日期类型。1: 自然日 2: 工作日（跳过双休和法定节假日）。默认为1 |
| question_extend_setting.duration_setting.day_range | uint32 | 否 | 单位换算，多少小时/天，`time_scale`为`2`适用。取值范围：[1, 24] ，默认为24 |

### 体温
| 参数 | 类型 | 是否必须 | 说明 |
|------------|------|--------|----------------------------|
| question_extend_setting.temperature_setting | object | 否 | 体温题的题目设置，不填时将使用默认设置 |
| question_extend_setting.temperature_setting.unit_type | uint32 | 否 | 温度单位。0: 摄氏度 1: 华氏度 。默认为0 |

### 部门
| 参数 | 类型 | 是否必须 | 说明 |
|------------|------|--------|----------------------------|
| question_extend_setting.department_setting | object | 否 | 部门题的题目设置，不填时将使用默认设置 |
| question_extend_setting.department_setting.allow_multiple_selection | bool | 否 | 是否允许多选，默认不允许 |

### 成员
| 参数 | 类型 | 是否必须 | 说明 |
|------------|------|--------|----------------------------|
| question_extend_setting.member_setting | object | 否 | 成员题的题目设置，不填时将使用默认设置 |
| question_extend_setting.member_setting.allow_multiple_selection | bool | 否 | 是否允许多选，默认不允许 |
