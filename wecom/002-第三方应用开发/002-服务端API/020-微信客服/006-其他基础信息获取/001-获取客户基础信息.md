---
title: "获取客户基础信息"
doc_id: 31072
category_id: 95149
source_url: https://developer.work.weixin.qq.com/document/path/95149
---
最后更新：2025/11/18

**请求方式**: POST(**HTTPS**)

**请求地址**: https://qyapi.weixin.qq.com/cgi-bin/kf/customer/batchget?access_token=ACCESS_TOKEN

**请求实例**:
```json
{
  "external_userid_list": [
    "wmxxxxxxxxxxxxxxxxxxxxxx",
    "zhangsan"
  ],
  "need_enter_session_context": 0
}
```

**参数说明：**

 | 参数 | 是否必须 | 说明 |
 |----|---- | ----- |
 | access_token | 是 | 调用接口凭证 |
 | external_userid_list| 是 | external_userid列表<br/>可填充个数：1 ~ 100。超过100个需分批调用。|
 | need_enter_session_context| 否 | 是否需要返回客户48小时内最后一次进入会话的上下文信息。<br/>0-不返回 1-返回。默认不返回|

 
**权限说明**:
调用的应用需要满足如下的权限
| 应用类型 | 权限要求 |
| -------- | ---- | 
|自建应用|配置到「 [微信客服- 可调用接口的应用](#31106/如何开启API)」中 |
|第三方应用|具有!!#ff0000 “微信客服->获取基础信息”!!权限|
|代开发自建应用|具有!!#ff0000 “微信客服->获取基础信息”!!权限|
<br>
::: warning 注意
从2023年12月1日0点起，不再支持通过系统应用secret调用接口，存量企业暂不受影响 [查看详情](https://developer.work.weixin.qq.com/document/51165)。
external_userid 需为最近 48 小时内有触发[用户进入会话事件](#31078/用户进入会话事件)或向该客服账号发过消息的客户，否则在 `invalid_external_userid` 返回。
「营销获客」应用只能获取到该应用带来的客户，也就是「营销获客」应用管理的微信客服账号的客户
:::

**返回结果**:

```json
{
 "errcode": 0,
 "errmsg": "ok",
 "customer_list": [
    {
      "external_userid": "wmxxxxxxxxxxxxxxxxxxxxxx",
      "nickname": "张三",
      "avatar": "http://xxxxx",
      "gender": 1,
      "unionid": "oxasdaosaosdasdasdasd",
      "enter_session_context": {
        "scene": "123",
        "scene_param": "abc",
        "wechat_channels": {
          "nickname": "进入会话的视频号名称",
          "scene": 1
        }
      }
    }
  ],
  "invalid_external_userid": [
    "zhangsan"
  ]
}
```

**参数说明**:

|参数|类型|说明|
|:-----------|:-------------|:----------|
|errcode|int|返回码|
|errmsg|string|错误码描述|
|customer_list| array| 返回结果 |
|customer_list.external_userid|string|微信客户的external_userid|
|customer_list.nickname|string|微信昵称|
|customer_list.avatar|string|微信头像。**第三方应用和代开发应用均不可获取**|
|customer_list.gender|int|性别。**第三方应用和代开发应用均不可获取**，统一返回`0`|
|customer_list.unionid|string|unionid，需要绑定微信开发者账号才能获取到，查看[绑定方法](#如何获取微信客户的unionid)。第三方不可获取|
|customer_list.enter_session_context|obj|48小时内最后一次进入会话的上下文信息。</br>请求的need_enter_session_context参数设置为1才返回 |
|customer_list.enter_session_context.scene|string|进入会话的场景值，[获取客服账号链接](#31144)开发者自定义的场景值|
|customer_list.enter_session_context.scene_param|string|进入会话的自定义参数，[获取客服账号链接](#31144)返回的url，开发者按规范拼接的scene_param参数|
|customer_list.enter_session_context.wechat_channels|obj|进入会话的视频号信息，从视频号进入会话才有值|
|customer_list.enter_session_context.wechat_channels.nickname|string|视频号名称，视频号场景值为1、2、3时返回此项|
|customer_list.enter_session_context.wechat_channels.shop_nickname|string|视频号小店名称，视频号场景值为4、5时返回此项|
|customer_list.enter_session_context.wechat_channels.scene|uint32|视频号场景值。1：视频号主页，2：视频号直播间商品列表页，3：视频号商品橱窗页，4：视频号小店商品详情页，5：视频号小店订单页|

###如何获取微信客户的Unionid
企业内部开发和第三方应用开发，获取Unionid的方式不同。
####**企业内部开发**
1. 在企业微信管理后台“应用管理-微信客服-通过API管理微信客服”处，点击“绑定”去到微信公众平台进行授权，支持绑定公众号和小程序（需要同时绑定微信开放平台）；绑定的公众号或小程序主体需与企业微信主体一致，暂且支持绑定一个

2. 绑定完成后，当客户进入客服会话或发起咨询时，即可通过此接口获取微信客户所对应的微信Unionid
- ![enter image description here](https://wework.qpic.cn/wwpic/681914_gApmU1tWS6STFMl_1669801811/0)

####**第三方应用开发**
1. 企业授权第三方应用管理指定的客服账号的会话消息时，当微信客户进入该客服会话或发起咨询时，第三方可获取该客户的external_userid
2. 第三方需自行通过其他已有的方式获取客户的Unionid
3. 再通过[Unionid与external_userid关联接口](#39850) ，将获取到的Unionid和external_userid实现关联识别。
