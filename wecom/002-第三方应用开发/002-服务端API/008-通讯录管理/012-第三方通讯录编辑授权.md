---
title: "第三方通讯录编辑授权"
doc_id: 40392
category_id: 96078
source_url: https://developer.work.weixin.qq.com/document/path/96078
---
最后更新：2023/04/13

[TOC]

# 接入指引
企业在人事管理场景中，存在将已有的通讯录数据写入到企业微信的需求。**企业微信禁止服务商通过客户企业的“企业管理后台 - 管理工具 - 通讯录同步”的secret功能直接获取企业通讯录数据。**

因此为满足人事类应用服务商为企业提供通讯录写入服务的需求，企业微信面向第三方服务商提供授权能力**“通讯录编辑授权”**：经企业授权后，第三方服务商可通过接口编辑企业通讯录信息，包括对成员和部门进行新增、修改、删除操作。

## 通讯录编辑权限

经客户企业授权后，服务商可获得如下权限：
1. 可读取全公司范围内的成员open_userid和部门ID

2. 可**新增和修改**全公司范围内员工的以下信息：
账号、姓名、别名、性别、头像、手机号、座机、邮箱、企业邮箱、地址、职务、部门、主部门、部门负责人、直属上级、自定义属性、视频号名称、对外身份和对外职务

3. 可执行以下操作：
新增成员、删除成员、新增部门、删除部门

## 开通条件
第三方服务商开通“通讯录编辑授权”需同时满足以下三个条件：
1. 服务商需完成认证
2. 服务商需上线应用分类为“人力资源”的第三方应用或模板分类为“人力资源”的代开发模板
3. 服务商历史未开通“第三方通讯录应用”

## 配置指引

###1.配置参数
符合开通条件的服务商可在「服务商助手 - 工具 - 通用配置 - 通讯录编辑授权」配置参数，配置完成并勾选《服务商开通授权承诺》后可开通。不满足开通条件的服务商，服务商助手将不会展示开通入口。

服务商需要配置的参数如下：

|参数|说明|
|:----|:----|
|指令回调URL|系统将会将企业通讯录的授权事件以及tiket参数推送到此URL|
|Token|用于生成签名校验回调请求的合法性|
|EncodingAESKey|回调消息加解密参数，是AES密钥的Base64编码，用于解密回调消息内容对应的密文|
|权限用途|权限用途将在授权时展示给企业客户，请按照实际情况填写|
- ![](https://wework.qpic.cn/wwpic/931221_wY4G8DgLQ-GbLLO_1659706719/0)

###2. 提交审核
配置参数后，需提交企业微信审核。审核通过后，服务商可点击“发布”并生成授权二维码用于企业授权。若需要修改参数，可在编辑保存后重新提交审核。
- ![](https://wework.qpic.cn/wwpic/145328_rKWZ12WlQdOLXed_1659706763/0)

###3. 企业授权
客户企业扫码授权服务商通讯录编辑权限时，需同时满足以下条件：
1. 当前企业未开启“企业管理后台 - 管理工具 - 通讯录同步”的api接口同步
2. 当前企业未授权其他服务商通讯录编辑权限或第三方通讯录应用
3. 当前企业已安装该服务商分类为“人力资源”的第三方应用或代开发应用

仅支持：企业超级管理员通过企业微信客户端扫码授权。
- ![](https://wework.qpic.cn/wwpic/698784_h8anTGs2TpayjrA_1659708264/0)

# 接口说明
该授权仅用于需要将通讯录数据同步到企业微信的场景，接口能力仅支持**写入成员和部门信息**以及**读取成员和部门ID**，具体可调用的API以及可接收到的变更回调通知在下文中列举，其他未列举的接口均不能调用。

## 接口调用凭证
企业同意并完成“**通讯录编辑授权**”后，服务商通过永久授权码[换取企业凭证](#14944)后调用接口，以及通过“通讯录编辑授权”中的回调配置接收通讯录变更通知（注意不是使用“人力资源”应用）。
- ![enter image description here](https://wework.qpic.cn/wwpic/870017_G3jdY4HvQP-c1id_1660119943/0)

## 允许调用的接口
### ID查询接口
支持服务商通过ID查询接口获得成员和部门ID列表，可用于实现增量写的比对功能。
- [获取成员ID列表](#40412)
> 可用于获取企业所有成员的open_userid。
- [获取部门ID列表](#36259)
> 可用于获取企业所有部门ID

### ID转换接口
- [userid转换](#42271)
> 可用于将userid转换为open_userid

### 成员管理接口
- [创建成员](#10018)
- [更新成员](#10020)
- [删除成员](#10030)

### 部门管理接口
- [批量删除成员](#10060)
- [创建部门](#10077)
- [更新部门](#10020)
- [删除部门](#10079)

### 异步导入接口
- [增量更新成员](#15014)
- [全量覆盖成员](#15015)
- [全量覆盖部门](#15016)
- [获取异步任务结果](#15017)

## 允许接收的回调通知
### 成员变更事件
- [新增成员事件](#14948/新增成员事件)
> 成员属性仅回调UserId/OpenUserId/Department三个字段
- [更新成员事件](#14948/更新成员事件) （仅在成员转移部门时回调）
> 仅在成员转移部门时回调，且成员属性仅回调UserId/OpenUserId/Department三个字段
- [删除成员事件](#14948/删除成员事件)

### 部门变更事件
- [新增部门事件](#14949/新增部门事件)
> 部门属性仅回调Id/ParentId两个字段
- [更新部门事件](#14949/更新部门事件)
> 仅在变更父部门时回调，且部门属性仅回调Id/ParentId两个字段
- [删除部门事件](#14949/删除部门事件)
