---
title: "wx.qy.getCurExternalContact"
doc_id: 16065
category_id: 93592
source_url: https://developer.work.weixin.qq.com/document/path/93592
---
最后更新：2025/11/17

### wx.qy.getCurExternalContact(Object object)

>**调用前提：**
> 必须先调用过wx.qy.login，且session_key未过期，开发者可调用checkSession 检查当前登录态
> 当前成员必须在应用的可见范围。
> 需要从特定入口进入页面才可调用，否则会报错：without context of external contact，可先通过调用[wx.qy.getContext](#21951)来判断进入小程序的入口，允许调用的入口说明参见[“不同入口所需的权限说明”](#不同入口所需的权限说明)。
> 从不同的入口进入的页面，应用需要满足相应用的权限，否则会报“no permission”错误，所需的权限参见[“不同入口所需的权限说明”](#不同入口所需的权限说明)
> 「营销获客」类应用仅可获取该应用带来的客户/微信客服

获取当前外部联系人userid

#### 参数

##### Object object

| 参数名 | 类型 | 必填 | 说明 |
| ---------- | -------- | ---- | ---------------------------------------- |
| success | Function | 否 | 接口调用成功的回调函数 |
| fail | Function | 否 | 接口调用失败的回调函数 |
| complete | Function | 否 | 接口调用结束的回调函数（调用成功、失败都会执行） |

###### object.success 回调函数
**参数**

**Object res**

| 参数 | 类型 | 说明 |
| ------- | ----- | -------------------- |
| userId | String | 返回此次选择的外部联系人userId |

#### 示例代码：

```js

wx.qy.getCurExternalContact ({
 success: function(res) {
 var userId = res.userId //返回当前外部联系人userId
 }
})

```

#### 不同入口所需的权限说明
| 入口 | [getContext](#21951)的entry值 | 自建应用 |第三方应用 | 用户 | 支持的最低版本 |
| ------- | ----- | -------------------- | ------------ |------------ |----- |
| 联系人详情页 | contact_profile | 需有[客户联系功能权限](#13473/配置可使用客户联系接口的应用) | 需有“企业客户权限->客户基础信息”权限 | [配置了客户联系功能](#13473/配置可使用客户联系功能的成员) | 2.5.8 |
| 外部单聊工具栏 | single_chat_tools | 需有[客户联系功能权限](#13473/配置可使用客户联系接口的应用) | 需有“企业客户权限->客户基础信息”权限 |[配置了客户联系功能](#13473/配置可使用客户联系功能的成员) |2.8.10 |
