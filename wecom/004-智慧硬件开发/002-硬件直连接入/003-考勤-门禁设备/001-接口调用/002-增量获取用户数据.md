---
title: "增量获取用户数据"
doc_id: 15357
category_id: 93984
source_url: https://developer.work.weixin.qq.com/document/path/93984
---
最后更新：2022/09/16

设备收到成员增量同步的指令后主动调用该接口。

**请求包体：**

```
{
 "cmd":"get_userinfo_by_ids",
 "headers":
  {
    "req_id":"xxxxx"
  },
  "body":
  {
    //老版本用
    "userids":
    [
      "x1","x2","x3"
    ],
    //支持学生探温复学版本用
    "user_item": [
      { "userid":"zhangsan" , "user_type":0 }, 
      { "userid":"lisi" , "user_type":2 }
    ],
    "is_req_fp_info":1,
    "is_req_fa_info":1,
    "is_req_public_key":1
  }
}
```

**参数说明：**
 
| 参数名 | 是否必须 | 类型 | 描述 |
| ------- | ---- | ------------- | ---------------- |
| req_id | 是 | string | 请求的id，自行保证不会重复即可 |
| userids | 老版本是 | array(string) | Userid列表，最多200人 |
|user_item|新版本是 |Object |userid、user_type数据结构，成员的类型： 0：企业员工 1：访客 2：学生 不填默认为0|
| is_req_fp_info | 否 | Uint32 | 默认1, 0:不返回fp数据列表, 1:才返回 |
| is_req_fa_info | 否 | Uint32 | 默认1, 0:不返回fa数据列表, 1:才返回 |
| is_req_public_key | 否 | Uint32 | 默认0, 0:不返回, 1:才返回 |
**返回结果：** 

```
{
  "headers": 
  {
     "req_id" : "xxxx"
  },
  "body": 
  {
    "userinfo":
    [
    {
      "userid":"x1",
      "openvid":123456,
      "user_type":0,
      "fp_ver":1,
      "fa_ver":1,
      "public_key": "AmOVOOcprQJXEi94HPv9S",
      "pass_rule_list": [
        {
          "id":0, 
          "rule":"9:00-10:00 * * 1-5 *",
          "effect_time":1542874137
        },
        {
          "id":1, 
          "rule":"9:300-10:00 * * 6 *",
          "effect_time":1542874137
        }
      ],
      "name":"张三",
      "fp_alogrithm":"aaa",
      "fp":[
        {
          "id":0,
          "data":"xxxx"
        },
        {
          "id":1,
          "data":"xxxx"
        }
      ],
      "fa_list":[
        {
          "id":0,
          "data":"xxxx"
        },
        {
          "id":1,
          "data":"xxxx"
        }
      ]
    },
    {
      "userid":"x2",
      "openvid":1234567,
      "user_type":0,
      "fp_ver":1,
      "fa_ver":1,
      "public_key": "AmOVOOcprQJXEi94HPv9S",
      "pass_rule_list": [
        {
          "id":0, 
          "rule":"9:00-10:00 * * 1-5 *",
          "effect_time":1542874137
        },
        {
          "id":1, 
          "rule":"9:300-10:00 * * 6 *",
          "effect_time":1542874137
        }
      ],
      "name":"李四",
      "fp_alogrithm":"aaa",
      "fp":[
        {
          "id":0,
          "data":"xxxx"
        },
        {
          "id":1,
          "data":"xxxx"
        }
      ]
    },
    {
      "userid":"x3",
      "openvid":12345678,
      "name":"王五",
      "user_type":0,
      "fp_ver":1,
      "fa_ver":1,
      "public_key": "AmOVOOcprQJXEi94HPv9S",
      "pass_rule_list": [
        {
          "id":0, 
          "rule":"9:00-10:00 * * 1-5 *",
          "effect_time":1542874137
        },
        {
          "id":1, 
          "rule":"9:300-10:00 * * 6 *",
          "effect_time":1542874137
        }
      ],
      "fp_alogrithm":"aaa",
      "fp":[
        {
          "id":0,
          "data":"xxxx"
        },
        {
          "id":1,
          "data":"xxxx"
        }
      ]
    }
    ]
   },
   "errcode": 0,
   "errmsg": "ok"
}
```

**参数说明：** 

| 参数名 | 描述 |
| -------------- | ------------------------------------ |
| req_id | 透传请求的req_id |
| errcode | 错误码 |
| errmsg | 错误码描述 |
| userid | 成员id(字符串)，长度为1-64个字节 |
| openvid | 成员id(uint64) ， 可用于二维码签名校验。注意：成员一定要用userid作为主键，openvid仅用于部分接口的签名计算，大部分接口不支持openvid作为参数|
| user_type | 成员的类型： 0：企业员工 1：访客 2：学生, 不填默认为0 |
| fp_ver | 指纹版本号 |
| fa_ver | 人脸版本号 |
| public_key | 离线二维码签名校验的公钥 |
| pass_rule_list | 放行规则列表，id为编号，rule为具体规则，其解析语法请参考附录[门禁放行规则语法说明](#15400) |
| effect_time | 规则生效时间 |
| fp | 成员指纹信息(base64), id,data数据同[上传用户数据](#15355) |
| fa_list | 成员脸部识别信息(base64),id,data数据同[上传用户数据](#15355) |
| name | 成员姓名 |

>注：成员没有放行规则或者放行规则为空时，建议默认行为是员工通行，访客不可通行。
