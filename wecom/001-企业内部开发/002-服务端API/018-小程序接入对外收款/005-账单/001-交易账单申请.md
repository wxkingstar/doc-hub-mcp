---
title: "交易账单申请"
doc_id: 45445
category_id: 98115
source_url: https://developer.work.weixin.qq.com/document/path/98115
---
最后更新：2024/12/09

按天提供交易账单文件，服务商可以通过该接口获取账单文件的下载地址。文件内包含交易相关的金额、时间、营销等信息，供商户核对订单、退款、银行到账等情况。

**请求方式:** POST(HTTPS)
**请求URL**: https://qyapi.weixin.qq.com/cgi-bin/miniapppay/get_bill?access_token=ACCESS_TOKEN

**请求包体**

``` 
{
  "bill_date":"xx",
  "mchid":"xx",
  "bill_type":"xx",
  "tar_type":"xx"
}
```
**参数说明**:
|参数名 |变量 |类型[长度限制] |必填 |描述 |
|:--|
|账单日期 |bill_date |string[10,10] |是 |query 格式yyyy-MM-dd<br>仅支持三个月内的账单下载申请。<br>示例值：2019-06-11 |
|商户号 |mchid |string[8,32] |是 | 用于下载某个商户下的交易或退款数据。<br>示例值：1900000001 |
|账单类型 |bill_type |string[1,32] |否 |query 不填则默认是ALL<br>枚举值：<br>ALL：返回当日所有订单信息（不含充值退款订单）<br>SUCCESS：返回当日成功支付的订单（不含充值退款订单）<br>REFUND：返回当日退款订单（不含充值退款订单）<br>示例值：ALL |
|压缩类型 |tar_type |string[1,32] |否 |query 不填则默认是数据流<br>枚举值：<br>GZIP：返回格式为.gzip的压缩包账单<br>示例值：GZIP |

**返回结果：**

``` 
{
    "download_url": "xxx",
    "hash_type": "xxx",
    "hash_value": "xxx",
    "auth": "xxx"
}
```
**参数说明**

|参数名 |变量 |类型[长度限制] |必填 |描述 |
|:--|
|哈希类型 |hash_type |string[1,32] |是 |枚举值：<br>SHA1：SHA1值<br>示例值：SHA1 |
|哈希值 |hash_value |string[1,1024] |是 |原始账单（gzip需要解压缩）的摘要值，用于校验文件的完整性。<br>示例值：79bb0f45fc4c42234a918000b2668d689e2bde04 |
|账单下载地址 |download_url |string[1,2048] |是 |供下一步请求账单文件的下载地址，该地址30s内有效。<br>示例值：https://api.mch.weixin.qq.com/v3/billdownload/file?token=xxx |
|校验头|auth |string[1,2048] |否 | https请求校验头，用于作为https校验的Authorization<br>如:auth取值为"Authorization: xxx" 则可通过<br> curl download_url -H 'Authorzation: xxx'的方法下载到账单文件数据流

**示例文件**
交易账单文件内包含：明细数据表头、明细数据内容、汇总数据表头、汇总数据四个部分，每个字段使用英文逗号 , 间隔，明细数据内容每个字段前会增加1个字符 ` 用于避免获取的内容被excel展示为科学计数法的格式、丢失数据细节

[交易账单示例文件](https://pay.weixin.qq.com/wiki/doc/apiv3/download/ALL.xlsx)
