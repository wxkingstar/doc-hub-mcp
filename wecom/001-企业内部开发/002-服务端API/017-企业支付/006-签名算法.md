---
title: "签名算法"
doc_id: 11652
category_id: 90281
source_url: https://developer.work.weixin.qq.com/document/path/90281
---
最后更新：2025/08/21

##微信支付签名算法
第一步，设所有发送或者接收到的数据为集合M，将集合M内非空参数值的参数按照参数名ASCII码从小到大排序（字典序），使用URL键值对的格式（即key1=value1&key2=value2…）拼接成字符串stringA。
特别注意以下重要规则：
- 参数名ASCII码从小到大排序（字典序）；
- 如果参数的值为空不参与签名；
- 参数名区分大小写；
- 验证调用返回或微信主动通知签名时，传送的sign参数不参与签名，将生成的签名与该sign值作校验。
- 微信接口可能增加字段，验证签名时必须支持增加的扩展字段

第二步，在stringA最后拼接上key得到stringSignTemp字符串，并对stringSignTemp进行MD5运算，再将得到的字符串所有字符转换为大写，得到sign值signValue。
附：key为商户平台API密钥里面设置的key，key设置之后不能查看，建议设置后另外保存一份，以免遗忘。另外，再建议将key顺便保存到 商户平台->产品中心->企业微信收款->API密钥管理 里面，这样后续企业微信收款才能正常使用。

签名字段:
除sign字段外所有字段都参与签名（包括企业微信签名字段workwx_sign一起参与签名）.

##企业微信签名算法
第一步: 设所有发送或者接收到的数据为集合M，将集合M内非空参数值的参数按照参数名ASCII码从小到大排序（字典序），使用URL键值对的格式（即key1=value1&key2=value2…）拼接成字符串stringA。

注意:
1. 参数名ASCII码从小到大排序（字典序）
2. 如果参数的值为空不参与签名
3. 参数名区分大小写
4. 传送的sign参数不参与签名，将生成的签名与该sign值作校验

第二步: 在stringA最后拼接上企业微信应用secret，得到stringSignTemp字符串，并对stringSignTemp进行MD5运算，再将得到的字符串所有字符转换为大写，得到sign值signValue。

企业微信签名字段说明：
发红包api固定如下几个字段参与签名：
act_name
mch_billno
mch_id
nonce_str
re_openid
total_amount
wxappid

付款api固定如下几个字段参与签名：
amount
appid
desc
mch_id
nonce_str
openid
partner_trade_no
ww_msg_type

示例:请求内容:
act_name XXX
mch_billno 11111234567890
mch_id 10000098
nonce_str qFKEgfig76DF9912fewmkp
re_openid oxTWIuGaIt6gTKsQRLau2M0yL16E
total_amount 100
wxappid wx123456789

第一步: 对参数按照key=value的格式，并按照参数名ASCII字典序排序如下
stringA=”act_name=XXX&mch_billno=11111234567890&mch_id=10000098&nonce_str=qFKEgfig76DF9912fewmkp&re_openid=oxTWIuGaIt6gTKsQRLau2M0yL16E&total_amount=100&wxappid=wx123456789
第二步：拼接企业微信应用secret：
stringSignTemp="stringA&secret=192006250b4c09247ec02edce69f6a2d"
sign=MD5(stringSignTemp).toUpperCase()
注：`企业微信应用secret`是指调用接口所传agentid对应的自建应用secret，历史上已经使用系统应用”企业支付“secret的，可继续使用。
