---
title: "编辑表格内容"
doc_id: 60079
category_id: 101168
source_url: https://developer.work.weixin.qq.com/document/path/101168
---
最后更新：2025/11/04

[TOC]
## 编辑表格内容
该接口可以对一个在线表格批量执行多个更新操作。

**注意：**
1. 批量更新请求中的各个操作会逐个按顺序执行，直到全部执行完成则请求返回，或者其中一个操作报错则不再继续执行后续的操作。
2. 每一个更新操作在执行之前都会做请求校验（包括权限校验、参数校验等等），如果校验未通过则该更新操作会报错并返回，不再执行后续操作。
3. 单次批量更新请求的操作数量 <= 5。

**请求方式**：POST（**HTTPS**）
**请求地址**: https://qyapi.weixin.qq.com/cgi-bin/wedoc/spreadsheet/batch_update?access_token=ACCESS_TOKEN 

**请求包体**

```json
{
  "docid": "DOCID",
  "requests": [
    {
      "add_sheet_request": {}
    },
    {
      "update_range_request": {}
    },
    {
      "delete_dimension_request": {}
    },
    {
      "delete_sheet_request": {}
    }
  ]
}
```

**参数说明**

| 参数 | 类型 | 是否必须 | 说明 |
|------------|--------|------|----------------------------|
| docid | string | 是 | 文档的docid|
| requests | object[] | 是 | 更新操作列表，详见 [UpdateRequest](#UpdateRequest) |

**权限说明**
- 自建应用需配置到“[可调用应用](#43883)”列表中的应用secret所获取的accesstoken来调用（[accesstoken如何获取？](#10013/第三步：获取access_token)）
- 第三方应用需具有“文档”权限
- 代开发自建应用需具有“文档”权限

**返回示例**

```json
{
  "errcode": 0,
  "errmsg": "ok",
  "data": {
    "responses": [
      {
        "add_sheet_response": {}
      },
      {
        "update_range_response": {}
      },
      {
        "delete_dimension_response": {}
      },
      {
        "delete_sheet_response": {}
      }
    ]
  }
}
```

**参数说明**

| 参数 |类型| 说明 |
|---------|-------|-------|
| errcode |int32| 错误码 |
| errmsg |string| 错误码说明 |
| data.responses| object\[\]| 结果列表，详见[UpdateResponse](#UpdateResponse)|

## 参数详细说明
由于请求参数比较复杂，在本节分Object分别说明

### UpdateRequest 

更新请求，在一个UpdateRequest的Object中只能填一个操作

**示例**
```
{
  "add_sheet_request": {}
}
```

```
{
  "update_range_request": {}
}
```

**字段说明**
|字段 |类型 |说明 |
|:--|
|add_sheet_request |object([AddSheetRequest](#AddSheetRequest)) |新增工作表 |
|delete_sheet_request |object([DeleteSheetRequest](#DeleteSheetRequest) |删除工作表 |
|update_range_request |object([UpdateRangeRequest](#updaterangerequest)) |更新范围内单元格内容 |
|delete_dimension_request |object([DeleteDimensionRequest](#DeleteDimensionRequest)) |删除表格连续的行或列|

### AddSheetRequest
新增工作表，新增需满足以下限制：
1. 范围列数 `<=200` 
2. 范围内的总单元格数量 `<=10000`

**示例**
```
{
      "title": "sheet_name",
      "row_count": 10,
      "column_count": 10
}
```
**字段说明**
|字段 |类型 |说明 |
|:--|
|title |string |工作表名称 |
|row_count |uint32 |新增工作表的初始行数 |
|column_count |uint32 |新增工作表的初始列数 |

### DeleteSheetRequest
删除工作表

**示例**
```
{
      "sheet_id": "AAAAA"
}
```

**字段说明**
|字段 |类型 |说明 |
|:--|
|sheet_id |string |工作表唯一标识|

### UpdateRangeRequest
更新范围内单元格内容请求，单次更新的范围大小需满足以下限制：

1. 范围行数 `<=1000` 
2. 范围列数 `<=200` 
3. 范围内的总单元格数量 `<=10000`

**示例**
```
{
      "sheet_id": "AAAAA",
      "grid_data": {}
}
```

**字段说明**
|字段 |类型 |说明 |
|:--|
|sheet_id| string |工作表唯一标识 |
|grid_data |object([GridData](#44380/GridData)) |写入指定区域的数据 |

### DeleteDimensionRequest
删除表格连续的行（或列）的请求，注意：

1. 该操作会导致表格缩表
2. 删除的范围遵循 `左闭右开` ———— `[start_index,end_index)` ，如果 `end_index <= start_index` 则该请求报错。

**示例**
```
{
      "sheet_id": "AAAAA",
      "dimension": "ROW"
}
```

**字段说明**
|字段 |类型 |说明 |
|:--|
|sheet_id |string |工作表唯一标识 |
|dimension |string |声明删除的维度为行或者列。详见 [Dimension](#44380/Dimension) |
|start_index |uint32 |删除行列的起始序号（从1开始） |
|end_index |uint32 |删除行列的终止序号（从1开始） |

### UpdateResponse
更新操作([UpdateRequest](#UpdateRequest)])对应的响应结构体类型

**示例**
```
{
 "add_sheet_response": {
 },
 "update_range_response": {
 },
 "delete_dimension_response": {
 },
 "delete_sheet_response": {
 }
}
```
**字段说明**
|字段 |类型 |说明 |
|:--|
|add_sheet_response |object([AddSheetResponse](#AddSheetResponse)) |新增工作表响应结构体 |
|delete_sheet_response |object([DeleteSheetResponse](#DeleteSheetResponse) |删除工作表响应结构体 |
|update_range_response |object([UpdateRangeResponse](#UpdateRangeResponse)) |更新范围内单元格内容响应结构体 |
|delete_dimension_response |object([DeleteDimensionResponse](#DeleteDimensionResponse)) |删除表格连续的行或列响应结构体|

### AddSheetResponse
新增子表操作的请求响应体结构
**示例**
```
{
  "properties": {
  }
}
```

|参数名 |数据类型 |描述 |
|:--|
|properties |object([Properties](#44543/Properties)) |新增子表的属性 |

### DeleteSheetResponse
删除工作表请求的相应结构体

**示例**
```
{
  "sheet_id": "AABBCC"
}
```

|参数名 |数据类型 |描述 |
|:--|
|sheet_id|string |被删除的工作表的唯一标识 |

### UpdateRangeResponse
编辑区域内单元格内容请求响应体结构

**示例**
```
{
  "updated_cells": 10
}
```

|参数名 |数据类型 |描述 |
|:--|
|updated_cells |uint32 |数据更新的成功的单元格数量 |

### DeleteDimensionResponse
删除表格连续的行（或列），请求响应体结构
**示例**
```
{
  "deleted": 10
}
```

|参数名 |数据类型 |描述 |
|:--|
|deleted |integer |被删除的行数（或列数） |
