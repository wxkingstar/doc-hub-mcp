---
title: "wx.qy.shareToExternalContact"
doc_id: 16853
category_id: 93571
source_url: https://developer.work.weixin.qq.com/document/path/93571
---
最后更新：2025/07/11

### wx.qy.shareToExternalContact(Object object)
该接口支持在小程序环境中，具有客户联系权限的企业成员将文本内容和附件传递到群发助手、发送给客户。
为了防止滥用，每次群发最多可选20000个客户，同一个成员每日向一个客户最多可群发一条消息，可在企业微信-群发助手-设置群发规则中调整为每周接收七条或每月可接收条数为当月天数。
>**调用说明：**
> 文本最多支持传入4000个字
> 附件最多支持传入9个，类型支持图片(“image”)，视频(“video”)，图文(“link”)，小程序(“miniprogram”)和文件(“file”)
> 支持传入文本和多附件的能力，仅在企业微信3.1.6及以后版本支持（mac端暂不支持）（[查看旧版本接口调用方式](#29620)）。微信客户端和微信开发者工具都不支持该接口。
> 必须先调用过wx.qy.login，且session_key未过期，开发者可调用checkSession 检查当前登录态
> 当前成员必须在应用的可见范围
> 仅[配置了客户联系功能](#13473/配置可使用客户联系功能的成员)的用户可调用
> 应用需有[客户联系功能权限](#13473/配置可使用客户联系接口的应用)（第三方应用需具有“企业客户权限->客户基础信息”权限），否则会报“no permission”错误

#### 参数

##### Object object

| 参数名 | 类型 | 必填 | 说明 |
| ---------- | -------- | ---- | ---------------------------------------- |
| externalUserIds|Array |否|指定的客户列表，从4.1.10版本开始支持（mac端不支持）|
|text|Object |否|文本消息|
|text::content|string|否|消息文本内容|
| attachments|Array |是|附件，最多支持添加9个附件|
|msgtype |string|是|附件类型，可选image、link、miniprogram或者video|
|image|Object |否|图片消息附件|
|image::mediaid|string|否|图片的素材id，可通过[素材管理](#10112)接口获得|
|image::imgUrl|string|否|图片的链接，**仅可使用[上传图片](#13219)接口得到的链接**，跟图片mediaid填其中一个即可|
|link|Object|否|图文消息附件|
|link::title|string|否|图文消息标题，最多64个**字节**|
|link::desc|string|否|图文消息摘要，最多512个**字节**|
|link::url|string|否|图文消息|
|link::imgUrl|string|否|图文消息封面图片URL|
|miniprogram|Object|否|小程序消息附件|
|miniprogram::appid|string|是|当前小程序appid，必须是关联到企业的小程序应用 |
|miniprogram::title|string|是|小程序消息标题，最多64个**字节**|
|miniprogram::imgUrl|string|是|小程序消息封面的URL|
|miniprogram::page|string|否|小程序打开后的路径，注意要以.html作为后缀，否则在微信端打开会提示找不到页面|
|video|Object|否|视频消息附件|
|video::mediaid|string|是|视频的素材id，可通过[素材管理](#10112)接口获得|
|file|Object|否|文件消息附件|
|file::mediaid|string|是|文件的素材id，可通过[素材管理](#10112)接口获得|
| success | Function | 否 | 群发成功的回调函数 |
| fail | Function | 否 | 群发失败的回调函数 |
| complete | Function | 否 | 调用结束的回调函数（群发成功、失败都会执行） |
> * text和attachments不能同时为空（注：若text和attachments同时为空，接口将用老的方式[wx.qy.shareToExternalContact](#29620)进行兼容。）
* attachments中每个附件信息必须与msgtype一致，例如，msgtype指定为image，则需要填写image::imgUrl或者image::mediaid，否则会报错。mediaid和imgUrl只需填写一个，两者同时填写时使用media_id且imgUrl失效，二者不可同时为空

#### 示例代码：

```js
wx.qy.shareToExternalContact({
   externalUserIds: ["wmEAlECwAAHrbAAAOK5u3Bf13xlYDAAA","wmEAlECwAAHiBBBDOK5u3Af13xlYDBBB"],//客户列表，从4.1.10版本开始支持（mac端不支持）
   text: {
      content:"",  // 文本内容
   },
 attachments: [
   {
    msgtype: "image", // 消息类型，必填
         image: {
            mediaid: "", // 图片的素材id
            imgUrl: "", // 图片的imgUrl,跟图片mediaid填其中一个即可
         },
      },
      {
         msgtype: "link", // 消息类型，必填
         link: {
            title: "", // H5消息标题
           imgUrl: "", // H5消息封面图片URL
           desc: "", // H5消息摘要
           url: "", // H5消息页面url 必填
         },
      },
      {
         msgtype: "miniprogram", // 消息类型，必填
         miniprogram: {
           appid: "", // 小程序的appid
           title: "", // 小程序消息的title
           imgUrl : "", //小程序消息的封面图。
           page: "", //小程序消息打开后的路径，注意要以.html作为后缀，否则在微信端打开会提示找不到页面
         },
      },
      {
         msgtype: "video", // 消息类型，必填
         video:{
            mediaid:"", // 视频的素材id
         },
      },
      {
         msgtype: "file", // 消息类型，必填，从3.1.12版本开始支持
         file:{
            mediaid:"", // 文件的素材id，必填
         },
      },
 }],
 success: function(res) {
 //todo:
 }
});

```
