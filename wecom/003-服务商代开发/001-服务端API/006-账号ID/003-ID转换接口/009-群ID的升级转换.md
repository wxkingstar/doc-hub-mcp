---
title: "群ID的升级转换"
doc_id: 52106
category_id: 99601
source_url: https://developer.work.weixin.qq.com/document/path/99601
---
最后更新：2024/07/18

[TOC]
## 概述
目前同一个服务商的代开发应用与第三方应用获取的群ID不一样，服务商无法在代开发应用与第三方应用之间打通数据。针对这种情况，代开发应用可以将群ID进行升级，升级后，代开发应用获取的群ID，将与第三方应用获取的群ID一致。
考虑到服务商代开发应用线上服务的平滑稳定性，代开发应用可以将未来7天内某个时间点作为真正升级生效的时间点。在设置了升级时间之后，在真正生效前，代开发应用可以使用新旧两种群ID作为输入参数（输出参数仍然返回旧ID），也可以使用群ID转换接口对存量的数据进行更新。在真正生效后，则代开发应用只能使用新的群ID.

##对已授权企业升级群ID
###申请群ID的升级
设置代开发应用群ID完成升级的时间。在调用该接口后，用户可以使用新旧两种群ID调用相关接口。在到达设置的完成升级的时间点后，用户必须使用升级后的群ID调用接口，企业微信会返回升级后的群ID。

**请求方式：**POST（**HTTPS**）
**请求地址**：https://qyapi.weixin.qq.com/cgi-bin/idconvert/apply_to_upgrade_chatid?access_token=ACCESS_TOKEN

**请求参数：**
```
{
 "upgrade_time": 1234567
}
```

**参数说明：**

| 参数|必须|类型|说明|
| :-|
| access_token | 是 |string| 代开发应用的接口凭证，服务商可通过“[获取企业access_token](#10975/获取企业access_token)”获得此调用凭证 |
|upgrade_time|是|int|完成升级的时间戳。不得设置早于当前时间或7天之后的时间|

**权限说明：**
>仅代开发应用可调用
>应用需具有「客户联系 -> 基础客户信息」权限

**返回结果：**

```
{
 "errcode": 0,
 "errmsg": "ok"
}
```
**参数说明：**

| 参数|类型|说明|
| :-|
| errcode | int|返回码 |
| errmsg | string|对返回码的文本描述内容 |

### 群ID转换接口
用户可以将升级前企业主体的群ID转换成升级后服务商主体的群ID。如果传入升级后的群ID则原样返回。在到达指定的升级时间后，无法调用该接口。
**请求方式：**POST（**HTTPS**）
**请求地址**：https://qyapi.weixin.qq.com/cgi-bin/idconvert/chatid?access_token=ACCESS_TOKEN

**请求参数：**
```
{
 "chat_id_list": ["xxxxxx", "yyyyyy", "zzzzzzz"]
}
```

**参数说明：**

| 参数|必须|类型|说明|
| :-|
| access_token | 是 |string| 代开发应用的接口凭证，服务商可通过“[获取企业access_token](#10975/获取企业access_token)”获得此调用凭证|
|chat_id_list|是|string|需要转换的群ID列表，最多输入100个|

**权限说明：**
>仅代开发应用可调用
>需要调用申请群ID的升级接口后才可调用该接口进行群ID转换
>应用需具有「客户联系 -> 基础客户信息」权限
>群主需在应用的可见范围中

**返回结果：**

```
{
 "errcode": 0,
 "errmsg": "ok",
    "items": [
      {
        "chat_id": "xxxxxx",
        "new_chat_id": "XXXXXX"
      },
      {
        "chat_id": "yyyyyy",
        "new_chat_id": "yyyyyy"
      }
    ],
    "invalid_chat_id_list": ["zzzzzz"]
}
```
**参数说明：**

| 参数|类型|说明|
| :-|
| errcode | int|返回码 |
| errmsg | string|对返回码的文本描述内容 |
|items|object[]|转换结果|
|items.chat_id|string|升级前的群ID|
|items.new_chat_id|string|升级后的群ID|
|invalid_chat_id_list|string|无法转换的群ID，包含不合法的群ID以及群主不在应用可见范围内的群ID|

##对所有新授权企业升级群ID
对代开发应用模板进行群ID升级。调用该接口后，该模板的所有新增授权企业都会升级为服务商主体的群ID，无需逐个企业调用**“申请群ID的升级”**接口来升级群ID。

::: warning 注意
不同于“申请群ID的升级”接口，该接口使用的是代开发模板的接口调用凭证（即suite_access_token）。
此接口不会影响该模板下已经授权的企业，只会对调用该接口后授权的企业升级。
:::

**请求方式：**GET（**HTTPS**）
**请求地址**：https://qyapi.weixin.qq.com/cgi-bin/idconvert/upgrade_chatid_for_new_corp?suite_access_token=SUITE_ACCESS_TOKEN

**参数说明：**

| 参数|必须|类型|说明|
| :-|
| suite_access_token | 是 |string| 代开发模板的接口凭证，服务商可通过“[获取代开发应用模板凭证](#42541/获取代开发应用模板凭证)”获得此调用凭证 |

**返回结果：**

```
{
 "errcode": 0,
 "errmsg": "ok"
}
```
**参数说明：**

| 参数|类型|说明|
| :-|
| errcode | int|返回码 |
| errmsg | string|对返回码的文本描述内容 |
