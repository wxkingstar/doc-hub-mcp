---
title: "编辑文档内容"
doc_id: 44293
category_id: 98034
source_url: https://developer.work.weixin.qq.com/document/path/98034
---
最后更新：2025/07/17

[TOC]
## 编辑文档内容
该接口可以对一个在线文档批量执行多个更新操作。

**注意：**
1. 批量更新请求，若其中有一个操作报错则全部更新操作不生效。
2. 单次批量更新操作数量 <= 30。

**请求方式**：POST（**HTTPS**）
**请求地址**: https://qyapi.weixin.qq.com/cgi-bin/wedoc/document/batch_update?access_token=ACCESS_TOKEN 

**请求包体**

```json
{
  "docid": "DOCID",
  "verison": 10,
  "requests": [
    {
      "insert_text": {
        "text": "text content",
        "location": {
          "index": 10
        }
      }
    },
    {
      "insert_table": {
        "rows": 2,
        "cols": 2,
        "location": {
          "index": 10
        }
      }
    }
  ]
}
```

**参数说明**

| 参数 | 类型 | 是否必须 | 说明 |
|------------|--------|------|----------------------------|
| docid | string | 是 | 文档的docid|
|version| uint32| 否| 操作的文档版本, 该参数可以通过获取文档内容接口获得。操作后文档版本将更新一版。要更新的文档版本与最新文档版本相差不能超过100个。|
| requests | object[] | 是 | 更新操作列表，详见 [UpdateRequest](#UpdateRequest) |

**权限说明**
- 自建应用需配置到“[可调用应用](#43883)”列表中的应用secret所获取的accesstoken来调用（[accesstoken如何获取？](#10013/第三步：获取access_token)）
- 第三方应用需具有“文档”权限
- 代开发自建应用需具有“文档”权限

**返回示例**

```json
{
  "errcode": 0,
  "errmsg": "ok"
}
```

**参数说明**

| 参数 |类型| 说明 |
|---------|-------|-------|
| errcode |int32| 错误码 |
| errmsg |string| 错误码说明 |

## 参数详细说明
由于请求参数比较复杂，在本节分Object分别说明

### UpdateRequest
更新文档的操作，每个UpdateRequest的Object中能同时填一个字段，填入多个的只会有一个生效
**示例**
```
{
  "replace_text": {
  },
  "delete_content": {
  }
}
```

**字段说明**
| 字段| 类型| 说明|
|-|-|-|
|replace_text| object([ReplaceText](#ReplaceText))| 替换指定位置文本内容|
|insert_text| object([InsertText](#InsertText))|在指定位置插入文本内容|
|delete_content| object([DeleteContent](#DeleteContent))|删除指定位置内容|
|insert_image|object([InsertImage](#InsertImage)|在指定位置插入图片|
|insert_page_break|object([InsertPageBreak](#InsertPageBreak))|在指定位置插入分页符|
|insert_table|object([InsertTable](#InsertTable))|在指定位置插入表格|
|insert_paragraph|object([InsertParagraph](#InsertParagraph))|在指定位置插入段落|
|update_text_property|object([UpdateTextProperty](#UpdateTextProperty))|更新指定位置文本属性|
<!--
|insert_comment|object([InsertComment](#InsertComment))|在指定位置插入批注|
|delete_comment|object([DeleteComment](#DeleteComment))|删除指定批注|
-->

### Range
表示从start_index开始的一段范围
**示例**
```
{
  "start_index": 10,
  "length": 5
}
```
**字段说明**
| 字段| 类型|说明|
|-|-|-|
|start_index| uint32| 起始位置，从0开始|
|length| uint32|长度|

### Location
标准文档中的一个位置
**示例**
```
{
  "index": 10
}
```
**字段说明**
| 字段| 类型|说明|
|-|-|-|
|index| uint32| 位置|

### ReplaceText
**示例**
```
{
  "text": "hello world",
  "ranges": [
      {
        "start_index": 10,
        "length": 5
      }
  ]
}
```
**字段说明**
| 字段| 类型|说明|
|-|-|-|
|text| string| 要替换的文本|
|ranges| object\[\]([Range](#Range))| 要替换的文档范围，可同时替换多个位置的文本, rangs个数不超过10。|

### InsertText
插入文本
**示例**
```
{
  "text": "hello world",
  "location": {
    "index": 10
  }
}
```
**字段说明**
| 字段| 类型|说明|
|-|-|-|
|text| string| 要插入的文本|
|location| object([Location](#Location))| 插入的位置|

### DeleteContent
删除指定位置内容
**示例**
```
{
  "range": {
    "start_index": 10,
    "length": 5
  }
}
```
**字段说明**
| 字段| 类型|说明|
|-|-|-|
|range| object([Range](#Range))| 要删除的范围|

### InsertImage 
插入图片
**示例**
```
{
  "image_id": "https://https://wework.qpic.cn/wwpic/xxxxxx",
  "location": {
    "index": 10
  }
}
```
**字段说明**
| 字段| 类型|说明|
|-|-|-|
|image_id| string| 图片url，通过[上传图片接口](#53863)获得|
|location| object([Location](#Location))| 插入的位置|
|width|uint32|图片的宽，单位是像素（px）|
|height|uint32|图片的高， 单位是像素（px）|

### InsertPageBreak
插入分页符
**示例**
```
{
  "location": {
    "index": 10
  }
}
```
**字段说明**
| 字段| 类型|说明|
|-|-|-|
|location| object([Location](#Location))| 插入的位置|

### InsertTable
在指定位置插入表格，表格大小限制：
 - 行数`<=100`
 - 列数`<=60`
 - 单元格总数`<=1000`

**示例**
```
{
  "rows": 3,
  "cols": 3,
  "location": {
    "index": 10
  }
}
```
**字段说明**
| 字段| 类型|说明|
|-|-|-|
|rows| uint32| 表格行数|
|cols| uint32| 表格列数|
|location| object([Location](#Location))| 插入的位置|

<!--
【deleteme】### InsertNumbering 
!TODO
在指定位置插入段落编号
**示例**
```
{
  "location": {
    "index": 10
  }
}
```
**字段说明**
| 字段| 类型|说明|
|-|-|-|
|location| object([Location](#Location))| 插入的位置|
-->

### InsertParagraph
在指定位置插入段落
**示例**
```
{
  "location": {
    "index": 10
  }
}
```
**字段说明**
| 字段| 类型|说明|
|-|-|-|
|location| object([Location](#Location))| 插入的位置|

### TextProperty
文本属性
**示例**
```
{
  "bold": true,
  "color": "000000",
  "background_color": "0000FF"
}
```
**字段说明**
| 字段| 类型|说明|
|-|-|-|
|blod| bool| 是否加粗|
|color| string|文字颜色，十六进制RRGGBB格式|
|background_color|string|文字的背景颜色，十六进制RRGGBB 格式|

### UpdateTextProperty
更新指定范围的文本属性
**示例**
```
{
  "text_property": {
  },
  "ranges": [
  ]
}
```
**字段说明**
| 字段| 类型|说明|
|-|-|-|
|text_property| object([TextProperty](#TextProperty))| 文本属性|
|ranges| object\[\]([Range](#Range))| 更新文本属性的范围，ranges个数不超过10|

<!--
【deleteme】### InsertComment
在指定位置插入批注
**示例**
```
{
  "text": "hello world",
  "range": {
    "start_index": 10,
    "length": 5
  }
}
```
**字段说明**
| 字段| 类型|说明|
|-|-|-|
|text| string| 评论内容|
|range| object([Range](#Range))| 插入批注的文档范围|

【deleteme】### DeleteComment
删除指定批注
**示例**
```
{
  "id": "ID",
  "ref_id": "REF_ID"
}
```
**字段说明**
| 字段| 类型|说明|
|-|-|-|
|id| string| 批注ID|
|ref_id| string| 批注组ID|
-->
