---
title: "获取未观看直播统计"
doc_id: 21653
category_id: 97130
source_url: https://developer.work.weixin.qq.com/document/path/97130
---
最后更新：2024/07/19

通过该接口可以获取未观看直播的学生统计，学生的家长必须是已经关注「学校通知」才会纳入统计范围。

**请求方式：**POST（**HTTPS**）
**请求地址：**https://qyapi.weixin.qq.com/cgi-bin/school/living/get_unwatch_stat?access_token=ACCESS_TOKEN

**请求包体：**

```json
{
  "livingid": "livingid1",
  "next_key": "NEXT_KEY"
}

```

**参数说明：**

| 参数 | 必须 | 说明 |
| :----------- | :--- | :----------------- |
| access_token | 是 | 调用接口凭证|
| livingid | 是 | 直播id |
| next_key | 否 | 上一次调用时返回的next_key，初次调用可以填"0"|

**权限说明：**
| 应用类型 | 权限要求 |
| -------- | ---- | 
|自建应用|配置到「!!#ff0000 上课直播 - 可调用接口的应用!!」和「!!#ff0000 家长可以使用的应用!!」中 |
|代开发应用|具有「直播」和「家校沟通」权限| 
|第三方应用|具有「直播」和「家校沟通」权限|
- 自建应用必须通知配置到「上课直播」和家长可以使用的应用中
- 只能获取本应用创建的直播

*注：* 从2023年12月1日0点起，不再支持通过系统应用secret调用接口，存量企业暂不受影响 [查看详情](https://developer.work.weixin.qq.com/document/51165)

**返回结果：**

```
{
 "errcode": 0,
 "errmsg": "ok",
 "ending":1,
 "next_key": "NEXT_KEY",
 "stat_info":{
    "students":[
      {
        "student_userid": "zhansan_child",
        "parent_userid": "zhangsan",
        "partyids":[
          10,11
        ]
      },
      {
        "student_userid": "lisi_child",
        "parent_userid": "lisi",
        "partyids":[
          5
        ]
      }
    ]
 }
}
```
**参数说明：**

| 参数 | 说明 |
| :------- | :---------- |
| errcode | 返回码 |
| errmsg | 对返回码的文本描述内容 |
|ending|是否结束。0：表示还有更多数据，需要继续拉取，1：表示已经拉取完所有数据。注意只能根据该字段判断是否已经拉完数据|
|next_key|当前数据最后一个key值，如果下次调用带上该值则从该key值往后拉，用于实现分页拉取|
| stat_info| 统计信息列表 |
| stat_info.students| 未观看直播的学生列表 |
| stat_info.students.student_userid| 学生的userid |
| stat_info.students.parent_userid| 家长的userid|
| stat_info.students.partyids| 学生所在的班级id列表|
