---
title: "常见问题"
source_url: https://open.feishu.cn/document/uYjL24iN/uYDO3YjL2gzN24iN3cjN/faq
---
最后更新于 2025-05-29

# 常见问题

## Q1：鉴权为何返回 Code 9 ？

A：应用需要申请对应权限 —— 查看、评论、编辑和管理云文档所有文件，参考[开始使用](https://open.feishu.cn/document/uYjL24iN/uYDO3YjL2gzN24iN3cjN/introduction)权限部分。

## Q2：如何将文档授权给应用？

- 方法一：在云空间文档中添加应用（仅文档所有者能操作）

![image.png](https://sf3-cn.feishucdn.com/obj/open-platform-opendoc/106c99e8a209986db3ae5a3ce67ebebf_8MJk61jWtZ.png?height=1782&lazyload=true&width=838)
![image.png](https://sf3-cn.feishucdn.com/obj/open-platform-opendoc/600520692dddb9646c7221f96b3e719d_HeOTSv6GZ1.png?height=876&lazyload=true&width=1206)
![image.png](https://sf3-cn.feishucdn.com/obj/open-platform-opendoc/20db409157cbc0cfdfe6c51c8a0bcd3e_0Jlbz2xxs5.png?height=978&lazyload=true&width=1188)
- [方法二：通过接口以应用身份创建文档](https://open.feishu.cn/document/ukTMukTMukTM/ugDM2YjL4AjN24COwYjN)

## Q3：应用权限太大了，不想应用能修改文档怎么办？

A：文档给应用授权【只读】即可。

## Q4：我现在用的旧版云文档组件，如何升级新版云文档组件？

A：[迁移指南：在新版文档中运行小组件](https://bytedance.feishu.cn/docx/doxcnAzAfDTKcLKvyKppf7pB74w)

## Q5：开放能力使用 docx url 会报错

问题表现：项目使用了 docx url 但是会报错，报错如下图。

![image.png](https://sf3-cn.feishucdn.com/obj/open-platform-opendoc/76f9890a917bf8eda25ff2fbffa242c5_2JHNCceBh8.png?height=1604&lazyload=true&width=2998)
A：使用了旧的 sdk 版本 1.1.1，只有 >= 1.1.2 版本的才支持 docx

```
<script src="https://lf1-cdn-tos.bytegoofy.com/goofy/locl/lark/external_js_sdk/h5-js-sdk-1.1.2.js"></script>
```

## Q6：加载慢，有方法加快吗？

时机 | 用户扫码授权 | 应用身份授权
--- | --- | ---
页面访问第一篇文档（预计优化200~400ms） | 1.  用户第一次授权后将 refresh_token 存在服务端；  
1. 用户第二次访问时，接入方可在「模板服务」中提前通过用户 refresh_token 进行用户身份授权，将生成的签名信息放在模板中；  
1. 模板到达客户端时，利用模板中签名信息调用 WebComponent.config 接口进行鉴权； | 1.  接入方可在「模板服务」中提前进行应用身份授权，将生成的签名信息放在模板中；  
1. 模板到达客户端时，利用模板中签名信息调用 WebComponent.config 接口进行鉴权；
页面访问第二篇文档（预计优化3~5s） | - 调用 [切换文档](https://open.feishu.cn/document/uYjL24iN/uYDO3YjL2gzN24iN3cjN/replace-url)快速访问新文档 | 

## Q7：我的文档打开后图片/文件/一些内容加载不出来？

A：目前云文档组件的高度必须设置一个固定值`webComponent.render('DocsComponent', { height: 'XXXpx' }, container)`，否则文档本身的一些功能或者优化（比如按需加载、虚拟滚动）就无法生效，导致类似图片无法加载等问题。如果遇到图片/文件加载不出来，请先检查配置是否设置固定高度。

## Q8：我自己拿到一个 url，但是没办法打开云文档

例如用户拿到文档的 token，自己拼了一个`https://bytedance.feishu.cn/docx/``${token}`
A：自己的拼的 url 可能是个错误的 url，因为涉及到不同域（SG 和非 SG、US和非 US）、不同租户（bytedance 和非 bytedance）等，所以正确的 url 需要通过如下两种方式：
1. 通过 openAPI 获取文档的正确域名 「[获取文档元数据 - 服务端文档 - 开发文档 - 飞书开放平台](https://open.feishu.cn/document/uAjLw4CM/ukTMukTMukTM/reference/drive-v1/meta/batch_query)」
1. 在自己明确知道 token 对应域名的时候，可以拼接正确的域名来访问

## Q9：大屏下云文档左右空白太多了
A：目前内容的宽度由文档内部决定，外部无法控制，后续会有宽屏模式提供（仅支持 doc2.0）

## Q10：如何自定义目录？

1. 先通过配置隐藏目录（[功能配置](https://open.feishu.cn/document/uYjL24iN/uYDO3YjL2gzN24iN3cjN/feature-config)）
1. 通过事件监听获取目录数据（[文档目录变化](https://open.feishu.cn/document/uYjL24iN/uYDO3YjL2gzN24iN3cjN/event-listener/document-directory-change)）
1. 通过调用跳转锚点接口（[锚点跳转](https://open.feishu.cn/document/uYjL24iN/uYDO3YjL2gzN24iN3cjN/invoke-api/anchor-jump)）

## Q11：我想直接使用 iframe 嵌云文档，会有什么问题吗？

**现象一：** 用户扫码也无法登录，无法访问文档（包括匿名文档）
**原因：** 浏览器第三方安全限制，导致了 iframe 内 cookie 无法使用；
**临时解决：** 关闭浏览器对第三方 cookie 的限制
| **Chrome** | ![](https://sf3-cn.feishucdn.com/obj/open-platform-opendoc/0fd05670b54963d302fed01278d07bbd_XcbKR4KNDj.png?height=270&lazyload=true&width=1318) |
| ---------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Safari** | ![](https://sf3-cn.feishucdn.com/obj/open-platform-opendoc/9c9405eda01087b7053ac1a433fd7acd_lNjf3azuSm.png?height=580&lazyload=true&width=1516) |
**现象二：** 用飞书移动端访问页面，iframe 内提示升级

## Q12：接入 Docx 时容器不断抖动，控制台发现死循环

A：docx 不支持高度撑开，如果容器设置为 auto，Docx 是不可用的。需要给容器设置一个高度。
![](https://sf3-cn.feishucdn.com/obj/open-platform-opendoc/e434d73c4f468cbc034f852bb8c0c323_gPKT2A3rHl.png?height=422&lazyload=true&width=1046)

## Q13：如何找飞书开放平台的 oncall？

A：<https://applink.feishu.cn/client/helpdesk/open?id=6774278103180001550>

## Q14: 私有化部署如何接入？

A: 当前云文档组件私有化部署只支持web场景，不支持小程序场景。私有化部署接入时需要配置一下当前环境的私有化域名，[相关文档](https://open.feishu.cn/document%2FuYjL24iN%2FuYDO3YjL2gzN24iN3cjN%2Fquick-start-ka)
![](https://sf3-cn.feishucdn.com/obj/open-platform-opendoc/58208cdb6196883935dd6107931d3eca_pWOUhCyYtx.png?height=764&lazyload=true&width=1222)

## Q15：引入网页云文档组件@人时只能看到自己，无法@其他同事？
A：文档在 opendoc 场景下的所有接口请求都需要使用 jssdk-session 的方式进行鉴权，这个问题的原因是 docx 文档的 mention 面板搜索接口没有使用这种方式进行鉴权，不支持搜索，需要推 mention 面板完成 opendoc 场景的兼容改造。

## Q16: 云文档sdk的qps限制?
A: 单个用户的 qps 限制也是 100次/分钟

## Q17：云文档下拉至底部页面展示不完整？

A：排查插件。已知导致问题插件[沙拉查词]/[Starling In-Context]/[C360]

## Q18: 云文档组件的分享的按钮配置了，却无法显示？

用户的设置：
A：header被隐藏，导致分享按钮不展示。需要设置header的属性enable值true。

## Q19：如何隐藏文档底部的 footer

![](https://sf3-cn.feishucdn.com/obj/open-platform-opendoc/e7a6112ddd1e3ed8d1a978a2bc8b6c78_nLGIOIKblZ.jpeg?height=498&lazyload=true&width=2318)
A：有个隐藏的配置，官方文档中没有注明，可能仅供内部使用
  `bear-web: src/common/opendoc/components/footer/OpendocFooter.tsx`
```
FOOTER {
  enable: false,
},
```
![](https://sf3-cn.feishucdn.com/obj/open-platform-opendoc/100c0810d9613d5d85ffe63e2d7959ef_9Jm5afjCIN.png?height=204&lazyload=true&width=1108)

## Q20：用户不能编辑文档
需要确认是不是以用户身份(user_access_token)鉴权，如果是以应用身份登录则不能编辑文档符合预期
![](https://sf3-cn.feishucdn.com/obj/open-platform-opendoc/34434c758178e9e9d5881b0c36264da1_vIvywj4u0B.png?height=802&lazyload=true&width=2456)

## Q21：图片在宿主环境打开

1. 前端做法
    1. ```js
        this.component.config.setFeatureConfig({
            IMAGE: {
                viewer: 'outer'
            }
        })
        ```
    1. 配置图片在宿主打开
        1. ![](https://sf3-cn.feishucdn.com/obj/open-platform-opendoc/2f81ff9137b231c388e5402bcbe8cadc_Nt4NqH4pFI.jpeg?height=155&lazyload=true&width=1232)
    1. 监听图片打开事件 `this.component.event.onImageView`，通过返回值中blob转url
1. 后端做法
    1. 拿到返回值后，将图片url转宿主的后端，后端中转请求图片，请求中带上Jssdk-Session

## Q22: 加载wiki(知识库)文档

目前不支持直接加载wiki文档，对wiki文档，可以通过wiki接口拿到对应文档类型的token，使用对应文档的token 和类型 组 url 来使用云文档组件 wiki接口：[获取知识空间节点信息](https://open.feishu.cn/document/ukTMukTMukTM/uUDN04SN0QjL1QDN/wiki-v2/space/get_node)

## Q23: 应用身份的日志查询

应用身份：可以理解为以组织内一个机器人身份访问文档。
背景： 应用身份下，用户每次访问云文档组件，userid都会变化，不能依赖用户后续提供的userid来查询日志。
目前可以通过：
1. 埋点的custom.app_form和custom.app_id查询，header.custom.app_form = opendoc && header.custom.app_id = 应用接入的appid
1. 发生问题时，把 `User.id` 在控制台中打印出来，以当次会话的userid来查询日志

## Q24: 云文档组件调用replaceUrl后文档被重定向到登录页

解决方案：先确认replaceUrl的链接是不是feishu.cn域名，如果是，则在调用replaceUrl前，将[feishu.cn](http://feishu.cn)替换为[larkoffice.com](http://larkoffice.com)。

## Q25:应用身份访问时，100次/分钟的上限问题
结论：
1. 目前解决方案是多申请几个应用身份，访问时随机分配来解决上限问题。
1. 100次/分钟的阈值非必要不调整

## Q26: asymmetic encryption err 渲染失败

![](https://sf3-cn.feishucdn.com/obj/open-platform-opendoc/db0cdb0589ecc1390783570d86db5930_LlGEOtWjX8.png?height=230&lazyload=true&width=1532)
1. 确认初始化 timestamp 传入的值是否使用了本地时间，如果本地时间与服务端时间差值超过三分钟，会报错。建议由后台返回 signature 的时间，使用该时间
1. 前端会传入appId，后端也要用appId拿签名，如果不一致也有可能报这个错误
1. 拿了boe身份去访问online的文档
